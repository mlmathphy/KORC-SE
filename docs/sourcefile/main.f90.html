<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Kinetic Orbit Runaway electrons Code (KORC)">
    
    <meta name="author" content="Matt Beidler" >
    <link rel="icon" href="../favicon.png">

    <title>main.f90 &ndash; KORC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">KORC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>README</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>main.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.4% of total for source files.">376 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/main.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">main.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#progs-0">Programs</a></h3></div>
  <div id="progs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/main.html">main</a>
      
    </div>
  </div>
</div>

















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/main.f90.html#src">main.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~main.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemainf90EfferentGraph" width="641pt" height="821pt"
 viewBox="0.00 0.00 641.00 821.21" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~main.f90~~EfferentGraph" class="graph" transform="scale(.4464 .4464) rotate(0) translate(4 1835.716)">
<title>sourcefile~~main.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1835.716 1432,-1835.716 1432,4 -4,4"/>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~main.f90</title>
<polygon fill="none" stroke="#000000" points="1428,-496.718 1374,-496.718 1374,-472.718 1428,-472.718 1428,-496.718"/>
<text text-anchor="middle" x="1401" y="-482.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">main.f90</text>
</g>
<!-- sourcefile~korc_units.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~korc_units.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/korc_units.f90.html" xlink:title="korc_units.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="539.5,-1644.718 461.5,-1644.718 461.5,-1620.718 539.5,-1620.718 539.5,-1644.718"/>
<text text-anchor="middle" x="500.5" y="-1630.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_units.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_units.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_units.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-1710.718C867.5621,-1706.6829 648.5678,-1663.1826 549.8305,-1642.9537"/>
<polygon fill="#000000" stroke="#000000" points="550.3109,-1639.4794 539.8112,-1640.8963 548.9028,-1646.3363 550.3109,-1639.4794"/>
</g>
<!-- sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~korc_profiles.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/korc_profiles.f90.html" xlink:title="korc_profiles.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="826,-1275.718 736,-1275.718 736,-1251.718 826,-1251.718 826,-1275.718"/>
<text text-anchor="middle" x="781" y="-1261.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_profiles.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1135.5,-1284.718C1050.4093,-1282.8527 1024.348,-1256.6449 944,-1284.718"/>
</g>
<!-- sourcefile~korc_fio_interface.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~korc_fio_interface.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/korc_fio_interface.f90.html" xlink:title="korc_fio_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="557,-1450.718 444,-1450.718 444,-1426.718 557,-1426.718 557,-1450.718"/>
<text text-anchor="middle" x="500.5" y="-1436.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_fio_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_fio_interface.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_fio_interface.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1291.5,-1284.718C1187.7278,-1438.9112 1294.4528,-1576.3946 1135.5,-1672.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1135.5,-1672.718C1083.3086,-1704.3453 674.8531,-1510.8981 618,-1488.718 590.7118,-1478.0721 560.2924,-1465.0965 537.2427,-1455.0318"/>
<polygon fill="#000000" stroke="#000000" points="538.4099,-1451.722 527.8461,-1450.9119 535.599,-1458.1329 538.4099,-1451.722"/>
</g>
<!-- sourcefile~korc_interp.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~korc_interp.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/korc_interp.f90.html" xlink:title="korc_interp.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="700,-1332.718 618,-1332.718 618,-1308.718 700,-1308.718 700,-1332.718"/>
<text text-anchor="middle" x="659" y="-1318.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_interp.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-1322.718C862.3398,-1326.5474 767.3769,-1324.6009 710.2943,-1322.7389"/>
<polygon fill="#000000" stroke="#000000" points="710.2009,-1319.2338 700.0883,-1322.3936 709.9642,-1326.2298 710.2009,-1319.2338"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1135.5,-1284.718C1048.7502,-1282.8163 1030.6625,-1318.3876 944,-1322.718"/>
</g>
<!-- sourcefile~korc_ppusher.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~korc_ppusher.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/korc_ppusher.f90.html" xlink:title="korc_ppusher.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1182.5,-1336.718 1088.5,-1336.718 1088.5,-1312.718 1182.5,-1312.718 1182.5,-1336.718"/>
<text text-anchor="middle" x="1135.5" y="-1322.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_ppusher.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_ppusher.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_ppusher.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1291.5,-1284.718C1268.3316,-1313.7208 1227.2361,-1323.3995 1193.0395,-1325.997"/>
<polygon fill="#000000" stroke="#000000" points="1192.4596,-1322.5243 1182.6757,-1326.5893 1192.8591,-1329.5129 1192.4596,-1322.5243"/>
</g>
<!-- sourcefile~korc_initialize.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~korc_initialize.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/korc_initialize.f90.html" xlink:title="korc_initialize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1338,-496.718 1245,-496.718 1245,-472.718 1338,-472.718 1338,-496.718"/>
<text text-anchor="middle" x="1291.5" y="-482.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_initialize.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_initialize.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_initialize.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1373.9326,-484.718C1366.1101,-484.718 1357.2644,-484.718 1348.3445,-484.718"/>
<polygon fill="#000000" stroke="#000000" points="1348.2927,-481.2181 1338.2927,-484.718 1348.2927,-488.2181 1348.2927,-481.2181"/>
</g>
<!-- sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~korc_hpc.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/korc_hpc.f90.html" xlink:title="korc_hpc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="204,-762.718 131,-762.718 131,-738.718 204,-738.718 204,-762.718"/>
<text text-anchor="middle" x="167.5" y="-748.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_hpc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1135.5,-1284.718C1079.8047,-1283.4971 1078.5955,-1242.0803 1026,-1223.718 903.5286,-1180.9604 865.1965,-1179.0684 736,-1190.718 701.3573,-1193.8417 693.6429,-1201.5965 659,-1204.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-1284.718C281.1164,-1259.0853 273.1541,-1246.7995 254,-1205.718 217.005,-1126.3714 180.3602,-852.7974 170.2375,-772.8331"/>
<polygon fill="#000000" stroke="#000000" points="173.7058,-772.3615 168.9879,-762.8751 166.7603,-773.2331 173.7058,-772.3615"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-1204.718C503.7205,-1212.0831 446.7103,-1372.6276 318.5,-1284.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1291.5,-1284.718C1252.7889,-1342.2381 1204.8331,-1284.899 1135.5,-1284.718"/>
</g>
<!-- sourcefile~korc_finalize.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~korc_finalize.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/korc_finalize.f90.html" xlink:title="korc_finalize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="988,-1256.718 900,-1256.718 900,-1232.718 988,-1232.718 988,-1256.718"/>
<text text-anchor="middle" x="944" y="-1242.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_finalize.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_finalize.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_finalize.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1135.5,-1284.718C1085.4714,-1283.6213 1029.5981,-1270.5379 991.1784,-1259.6283"/>
<polygon fill="#000000" stroke="#000000" points="991.8926,-1256.1912 981.3134,-1256.7657 989.9419,-1262.9139 991.8926,-1256.1912"/>
</g>
<!-- sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~korc_types.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/korc_types.f90.html" xlink:title="korc_types.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="81,-722.718 0,-722.718 0,-698.718 81,-698.718 81,-722.718"/>
<text text-anchor="middle" x="40.5" y="-708.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_types.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-1710.718C871.5636,-1711.7954 848.6202,-1684.7235 781,-1710.718"/>
</g>
<!-- sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~korc_hdf5.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/korc_hdf5.f90.html" xlink:title="korc_HDF5.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-420.718 277,-420.718 277,-396.718 360,-396.718 360,-420.718"/>
<text text-anchor="middle" x="318.5" y="-406.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_HDF5.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1398.8558,-472.4408C1386.6714,-407.0558 1320.0469,-102.718 1135.5,-102.718 1135.5,-102.718 1135.5,-102.718 944,-102.718 845.4245,-102.718 821.7317,-131.064 736,-179.718 677.444,-212.9495 667.7897,-229.3956 618,-274.718 601.033,-290.1627 601.2429,-299.2228 582,-311.718 515.0292,-355.2048 425.8795,-382.7546 370.3531,-396.9578"/>
<polygon fill="#000000" stroke="#000000" points="369.2383,-393.6289 360.3894,-399.4554 370.9403,-400.4188 369.2383,-393.6289"/>
</g>
<!-- sourcefile~korc_collisions.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~korc_collisions.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/korc_collisions.f90.html" xlink:title="korc_collisions.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="993,-1374.718 895,-1374.718 895,-1350.718 993,-1350.718 993,-1374.718"/>
<text text-anchor="middle" x="944" y="-1360.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_collisions.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_collisions.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_collisions.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1135.5,-1284.718C1101.7676,-1283.9785 1091.6511,-1287.6173 1062,-1303.718 1042.9256,-1314.0755 1044.7874,-1325.8486 1026,-1336.718 1018.7528,-1340.9109 1010.7472,-1344.5142 1002.6629,-1347.5852"/>
<polygon fill="#000000" stroke="#000000" points="1001.4323,-1344.308 993.1773,-1350.9491 1003.772,-1350.9054 1001.4323,-1344.308"/>
</g>
<!-- sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~korc_input.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/korc_input.f90.html" xlink:title="korc_input.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="357.5,-1104.718 279.5,-1104.718 279.5,-1080.718 357.5,-1080.718 357.5,-1104.718"/>
<text text-anchor="middle" x="318.5" y="-1090.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_input.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1135.5,-1672.718C1062.977,-1720.3578 1030.7026,-1714.1518 944,-1710.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-1710.718C879.3933,-1708.1593 458.4647,-1510.9343 419,-1459.718 366.8074,-1391.9837 405.6378,-1353.1773 383,-1270.718 367.2177,-1213.2301 341.4228,-1147.8541 327.7247,-1114.6229"/>
<polygon fill="#000000" stroke="#000000" points="330.8007,-1112.9044 323.7303,-1105.0139 324.3369,-1115.5913 330.8007,-1112.9044"/>
</g>
<!-- sourcefile~korc_fields.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~korc_fields.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/korc_fields.f90.html" xlink:title="korc_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="821,-1066.718 741,-1066.718 741,-1042.718 821,-1042.718 821,-1066.718"/>
<text text-anchor="middle" x="781" y="-1052.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1400.0912,-496.8088C1392.8346,-592.0858 1343.2309,-1219.9598 1291.5,-1284.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1291.5,-1284.718C1270.9379,-1310.4583 1056.0688,-1166.1801 1026,-1152.718 955.7847,-1121.2821 872.2633,-1088.9185 823.1071,-1070.3715"/>
<polygon fill="#000000" stroke="#000000" points="824.0444,-1066.9847 813.4524,-1066.7398 821.5798,-1073.5365 824.0444,-1066.9847"/>
</g>
<!-- sourcefile~korc_units.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~korc_units.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465.5997,-1644.7258C428.1868,-1655.6563 367.5534,-1667.7116 318.5,-1650.718"/>
</g>
<!-- sourcefile~korc_units.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~korc_units.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M487.1634,-1620.703C468.4824,-1603.0113 435.0191,-1567.9956 419,-1530.718 372.9419,-1423.5372 411.0261,-1383.9595 383,-1270.718 368.678,-1212.849 342.2743,-1147.6319 328.097,-1114.5258"/>
<polygon fill="#000000" stroke="#000000" points="331.1389,-1112.7422 323.9544,-1104.9554 324.7148,-1115.5229 331.1389,-1112.7422"/>
</g>
<!-- sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~korc_constants.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/korc_constants.f90.html" xlink:title="korc_constants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="218,-110.718 117,-110.718 117,-86.718 218,-86.718 218,-110.718"/>
<text text-anchor="middle" x="167.5" y="-96.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_constants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_units.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~korc_units.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M481.3659,-1620.6052C432.0545,-1588.0924 301.2073,-1493.2811 254,-1374.718 198.1872,-1234.5418 228.3494,-847.2415 218,-696.718 202.5374,-471.8263 177.1399,-199.9284 169.6453,-121.1159"/>
<polygon fill="#000000" stroke="#000000" points="173.1064,-120.54 168.6728,-110.9175 166.138,-121.2046 173.1064,-120.54"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M755.1269,-1275.8062C737.3346,-1284.1191 713.494,-1295.2577 694.0069,-1304.3623"/>
<polygon fill="#000000" stroke="#000000" points="692.4142,-1301.2432 684.8358,-1308.6472 695.3773,-1307.5852 692.4142,-1301.2432"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M770.3783,-1275.9211C755.7036,-1292.2903 727.8695,-1321.6212 700,-1341.718 666.6218,-1365.7872 646.5781,-1355.1085 618,-1384.718 592.3226,-1411.3222 613.2946,-1440.0264 582,-1459.718 520.6842,-1498.3 486.0988,-1487.0302 419,-1459.718 324.1009,-1421.0899 301.051,-1389.7355 254,-1298.718 205.0658,-1204.0576 176.1004,-863.633 169.1421,-773.011"/>
<polygon fill="#000000" stroke="#000000" points="172.6301,-772.7192 168.3865,-763.0114 165.6501,-773.2468 172.6301,-772.7192"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M776.95,-1275.917C767.365,-1303.2725 740.9749,-1370.425 700,-1412.718 670.6158,-1443.0474 642.2889,-1426.173 618,-1460.718 567.8125,-1532.0976 649.1191,-1597.9609 582,-1653.718 491.9112,-1728.5565 429.1661,-1689.0561 318.5,-1650.718"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M768.5822,-1251.5039C753.0903,-1236.5114 725.524,-1210.629 700,-1190.718 678.9457,-1174.2938 511.9393,-1080.8465 500.5,-1056.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.5,-1056.718C470.7357,-994.106 441.2109,-989.3903 419,-923.718 368.9001,-775.5845 419.802,-725.702 383,-573.718 370.0586,-520.2728 343.7334,-460.9997 329.031,-430.1072"/>
<polygon fill="#000000" stroke="#000000" points="332.0234,-428.2547 324.5266,-420.7681 325.7184,-431.2957 332.0234,-428.2547"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M735.7509,-1251.9312C666.2734,-1233.2051 529.7378,-1193.9069 419,-1146.718 393.9887,-1136.0599 366.9059,-1121.3068 347.1635,-1109.914"/>
<polygon fill="#000000" stroke="#000000" points="348.7742,-1106.8016 338.3733,-1104.7836 345.2457,-1112.8472 348.7742,-1106.8016"/>
</g>
<!-- sourcefile~korc_coords.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~korc_coords.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/korc_coords.f90.html" xlink:title="korc_coords.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="544,-914.718 457,-914.718 457,-890.718 544,-890.718 544,-914.718"/>
<text text-anchor="middle" x="500.5" y="-900.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_coords.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_coords.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_coords.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M765.0654,-1251.5685C755.3022,-1243.3153 743.3157,-1231.5893 736,-1218.718 703.8278,-1162.1145 739.1296,-1128.7554 700,-1076.718 674.6203,-1042.9662 650.9702,-1055.105 618,-1028.718 577.2972,-996.1424 537.5517,-949.5172 516.3279,-923.0741"/>
<polygon fill="#000000" stroke="#000000" points="518.8231,-920.5878 509.8656,-914.9296 513.3395,-924.9388 518.8231,-920.5878"/>
</g>
<!-- sourcefile~korc_fio_interface.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~korc_fio_interface.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M493.8864,-1450.8275C467.5385,-1498.2934 369.0337,-1668.2244 318.5,-1650.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-1650.718C195.126,-1607.9776 273.3,-1475.2312 167.5,-1398.718"/>
</g>
<!-- sourcefile~korc_fio_interface.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~korc_fio_interface.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M496.1547,-1426.6859C482.1117,-1387.2057 437.7738,-1257.7749 419,-1146.718 376.4679,-895.1189 438.1112,-822.8643 383,-573.718 371.1234,-520.0262 344.3757,-460.8509 329.3216,-430.0399"/>
<polygon fill="#000000" stroke="#000000" points="332.2816,-428.1309 324.7029,-420.7272 326.0105,-431.2411 332.2816,-428.1309"/>
</g>
<!-- sourcefile~korc_fio_interface.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~korc_fio_interface.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M477.7205,-1426.5219C459.166,-1415.424 433.7142,-1397.3394 419,-1374.718 383.4997,-1320.1402 404.7131,-1294.0984 383,-1232.718 367.5798,-1189.127 343.5932,-1140.6038 329.6279,-1113.663"/>
<polygon fill="#000000" stroke="#000000" points="332.7082,-1112.0005 324.9706,-1104.763 326.506,-1115.246 332.7082,-1112.0005"/>
</g>
<!-- sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_fio_interface.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_fio_interface.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M635.3263,-1332.8866C629.2068,-1336.7562 622.9542,-1341.4266 618,-1346.718 595.1633,-1371.1092 607.767,-1391.4459 582,-1412.718 577.3776,-1416.5341 572.1869,-1419.7932 566.7222,-1422.576"/>
<polygon fill="#000000" stroke="#000000" points="564.9909,-1419.5175 557.3185,-1426.824 567.8727,-1425.8968 564.9909,-1419.5175"/>
</g>
<!-- sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M617.7585,-1326.9655C549.9631,-1335.0528 413.0656,-1342.0083 318.5,-1284.718"/>
</g>
<!-- sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M623.501,-1332.7529C523.3044,-1365.7468 240.8342,-1451.7523 167.5,-1398.718"/>
</g>
<!-- sourcefile~korc_rnd_numbers.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~korc_rnd_numbers.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/korc_rnd_numbers.f90.html" xlink:title="korc_rnd_numbers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="559.5,-458.718 441.5,-458.718 441.5,-434.718 559.5,-434.718 559.5,-458.718"/>
<text text-anchor="middle" x="500.5" y="-444.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_rnd_numbers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_rnd_numbers.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_rnd_numbers.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M656.1277,-1308.6262C648.495,-1275.9647 627.6344,-1183.1394 618,-1104.718 609.4234,-1034.9068 625.0932,-528.307 582,-472.718 578.3275,-467.9807 573.7874,-464.0908 568.7444,-460.899"/>
<polygon fill="#000000" stroke="#000000" points="570.3186,-457.772 559.8471,-456.1599 567.0278,-463.9502 570.3186,-457.772"/>
</g>
<!-- sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_coords.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_coords.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M656.822,-1308.7004C649.4591,-1269.3902 623.6064,-1141.4856 582,-1042.718 563.1503,-997.9716 532.6581,-949.9057 514.7997,-923.3485"/>
<polygon fill="#000000" stroke="#000000" points="517.567,-921.1938 509.0496,-914.8926 511.7785,-925.13 517.567,-921.1938"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1099.7525,-1312.6809C1052.6031,-1297.5914 972.2959,-1274.8316 944,-1284.718"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1088.2536,-1322.7198C1049.4781,-1321.4416 993.1535,-1320.413 944,-1322.718"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-1539.718C732.1665,-1649.8912 637.2932,-1750.4631 419,-1653.718 319.1814,-1609.4796 299.3088,-1571.0553 254,-1471.718 194.9406,-1342.2332 172.7741,-880.3498 168.3629,-773.0835"/>
<polygon fill="#000000" stroke="#000000" points="171.8486,-772.6554 167.9505,-762.8038 164.8543,-772.936 171.8486,-772.6554"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1132.3173,-1336.7384C1122.1907,-1373.1252 1087.7,-1483.8599 1026,-1553.718 940.3866,-1650.6514 903.0712,-1668.0057 781,-1710.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-1710.718C590.8213,-1795.7245 499.7442,-1889.4048 318.5,-1786.718"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_collisions.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_collisions.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1088.1629,-1334.1113C1062.4166,-1339.2202 1030.3329,-1345.5867 1002.9732,-1351.0158"/>
<polygon fill="#000000" stroke="#000000" points="1002.255,-1347.5899 993.1275,-1352.9695 1003.6175,-1354.4561 1002.255,-1347.5899"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1088.1744,-1314.126C1078.7384,-1310.4052 1069.4528,-1305.4097 1062,-1298.718 1034.4881,-1274.0157 1050.0236,-1251.8246 1026,-1223.718 1009.1947,-1204.0565 868.809,-1111.772 808.4312,-1072.4907"/>
<polygon fill="#000000" stroke="#000000" points="810.085,-1069.3914 799.7928,-1066.8772 806.2708,-1075.2609 810.085,-1069.3914"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1129.1451,-1336.8049C1108.4764,-1374.7128 1038.9746,-1491.5965 944,-1539.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-1539.718C839.4204,-1592.7062 510.12,-1561.4865 419,-1487.718 378.033,-1454.5521 407.3491,-1421.4662 383,-1374.718 339.3493,-1290.9123 287.4011,-1294.1101 254,-1205.718 213.9176,-1099.6448 226.7712,-809.7719 218,-696.718 200.5632,-471.9708 176.5286,-199.9731 169.5033,-121.1263"/>
<polygon fill="#000000" stroke="#000000" points="172.9679,-120.5727 168.593,-110.9233 165.9956,-121.1948 172.9679,-120.5727"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.5,-1132.718C390.7656,-1127.0539 337.551,-1185.0829 254,-1113.718 201.2781,-1068.6857 176.2477,-845.1819 169.4599,-773.1392"/>
<polygon fill="#000000" stroke="#000000" points="172.9223,-772.5673 168.5257,-762.9278 165.9514,-773.2051 172.9223,-772.5673"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1288.6666,-472.6562C1280.9268,-442.0657 1256.7455,-360.4366 1209,-311.718 1116.7629,-217.6009 1074.0969,-199.7069 944,-178.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M167.5,-58.718C145.2753,-67.7248 131.8088,-58.8564 117,-77.718 78.4162,-126.8614 48.3872,-581.6679 41.8339,-688.3831"/>
<polygon fill="#000000" stroke="#000000" points="38.3246,-688.4316 41.2118,-698.6254 45.3118,-688.856 38.3246,-688.4316"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-178.718C884.2306,-156.2184 884.1032,-123.2254 826,-96.718 618.5025,-2.0552 542.5154,22.0997 318.5,-20.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-20.718C251.075,-36.3067 231.6369,-32.7258 167.5,-58.718"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.5,-406.718C457.8074,-418.6782 407.2414,-418.1289 370.257,-415.1897"/>
<polygon fill="#000000" stroke="#000000" points="370.4716,-411.6952 360.2035,-414.3058 369.8585,-418.6683 370.4716,-411.6952"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-178.718C726.852,-134.3563 713.9166,-346.9301 500.5,-406.718"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.5,-1132.718C453.6713,-1130.7449 401.5554,-1118.1939 365.135,-1107.6697"/>
<polygon fill="#000000" stroke="#000000" points="365.878,-1104.2397 355.2962,-1104.7655 363.8963,-1110.9534 365.878,-1104.2397"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1290.528,-497.1416C1285.2462,-562.2654 1258.3994,-864.2123 1209,-941.718 1131.5231,-1063.2762 1088.1494,-1128.718 944,-1128.718 944,-1128.718 944,-1128.718 781,-1128.718 656.3207,-1128.718 625.0688,-1137.9667 500.5,-1132.718"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-1052.718C906.4404,-1048.5087 863.7097,-1049.2353 831.4245,-1050.8936"/>
<polygon fill="#000000" stroke="#000000" points="831.1174,-1047.4053 821.3291,-1051.4597 831.5094,-1054.3943 831.1174,-1047.4053"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~korc_velocity_distribution.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/korc_velocity_distribution.f90.html" xlink:title="korc_velocity_distribution.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1209,-344.718 1062,-344.718 1062,-320.718 1209,-320.718 1209,-344.718"/>
<text text-anchor="middle" x="1135.5" y="-330.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_velocity_distribution.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_velocity_distribution.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_velocity_distribution.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1286.6717,-472.4132C1276.2556,-447.4104 1249.3107,-390.3629 1209,-358.718 1204.2939,-355.0236 1199.0216,-351.8298 1193.519,-349.0739"/>
<polygon fill="#000000" stroke="#000000" points="1194.656,-345.7477 1184.1003,-344.8383 1191.785,-352.1319 1194.656,-345.7477"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_rnd_numbers.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_rnd_numbers.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1266.2655,-472.6326C1219.9556,-451.199 1117.7226,-407.3178 1026,-391.718 954.143,-379.4969 930.7392,-367.4751 862,-391.718 842.6241,-398.5515 843.1401,-409.3892 826,-420.718 807.0905,-433.2164 802.6475,-437.9976 781,-444.718"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-20.718C269.1027,-30.1597 262.69,-49.6521 218,-72.718 212.1919,-75.7157 206.0061,-78.9041 200.0275,-81.9834"/>
<polygon fill="#000000" stroke="#000000" points="198.1758,-79.0001 190.8873,-86.6895 201.3802,-85.2236 198.1758,-79.0001"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~korc_spatial_distribution.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/korc_spatial_distribution.f90.html" xlink:title="korc_spatial_distribution.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1207,-664.718 1064,-664.718 1064,-640.718 1207,-640.718 1207,-664.718"/>
<text text-anchor="middle" x="1135.5" y="-650.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_spatial_distribution.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_spatial_distribution.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_spatial_distribution.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1280.2809,-496.8002C1253.7633,-525.3575 1186.9921,-597.265 1154.2251,-632.5525"/>
<polygon fill="#000000" stroke="#000000" points="1151.2781,-630.5825 1147.0384,-640.2921 1156.4077,-635.3457 1151.2781,-630.5825"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_coords.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_coords.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-1052.718C842.0648,-1041.294 818.865,-1013.1719 736,-952.718 717.2055,-939.0066 719.5771,-927.2866 700,-914.718 683.7966,-904.3154 678.2484,-900.2022 659,-900.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1290.236,-496.9061C1280.7457,-581.7218 1213.4484,-1079.7196 944,-1052.718"/>
</g>
<!-- sourcefile~korc_hpc.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~korc_hpc.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M130.7663,-739.1484C117.6795,-735.0265 102.7362,-730.32 88.825,-725.9385"/>
<polygon fill="#000000" stroke="#000000" points="89.5088,-722.4844 78.9192,-722.8185 87.4058,-729.1611 89.5088,-722.4844"/>
</g>
<!-- sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M899.8899,-1249.8597C880.2818,-1252.1453 856.9874,-1254.8606 836.2363,-1257.2794"/>
<polygon fill="#000000" stroke="#000000" points="835.8086,-1253.8055 826.2811,-1258.4398 836.6191,-1260.7584 835.8086,-1253.8055"/>
</g>
<!-- sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M915.3623,-1232.7015C883.2043,-1220.3907 829.2011,-1203.24 781,-1204.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-1204.718C726.8033,-1206.3799 713.0034,-1199.8519 659,-1204.718"/>
</g>
<!-- sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-1204.718C709.54,-1206.9092 224.5055,-1441.8656 167.5,-1398.718"/>
</g>
<!-- sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M899.8433,-1237.6476C886.5353,-1233.7988 872.6505,-1227.8639 862,-1218.718 817.4604,-1180.4704 795.0073,-1111.9348 785.9689,-1076.8044"/>
<polygon fill="#000000" stroke="#000000" points="789.358,-1075.9287 783.585,-1067.0449 782.5579,-1077.5898 789.358,-1075.9287"/>
</g>
<!-- sourcefile~korc_hdf5.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~korc_hdf5.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M313.0502,-420.928C301.1166,-448.0032 272.283,-515.3066 254,-573.718 233.3912,-639.5601 260.5553,-670.4138 218,-724.718 215.5385,-727.8591 212.5932,-730.6568 209.3787,-733.1413"/>
<polygon fill="#000000" stroke="#000000" points="207.382,-730.2653 200.9557,-738.6887 211.2323,-736.1114 207.382,-730.2653"/>
</g>
<!-- sourcefile~korc_hdf5.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~korc_hdf5.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M301.3908,-396.6694C286.2428,-384.9861 264.896,-365.8196 254,-343.718 195.4675,-224.9899 291.3082,-11.8783 167.5,-58.718"/>
</g>
<!-- sourcefile~korc_hdf5.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~korc_hdf5.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M302.9752,-396.5589C288.5213,-384.5165 267.268,-364.8588 254,-343.718 207.1368,-269.0478 181.4129,-165.5969 171.8645,-120.8286"/>
<polygon fill="#000000" stroke="#000000" points="175.2358,-119.848 169.7824,-110.7644 168.3809,-121.2662 175.2358,-119.848"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M924.013,-1350.5787C895.3397,-1333.1636 842.3804,-1300.9981 809.5763,-1281.0742"/>
<polygon fill="#000000" stroke="#000000" points="811.2592,-1278.0014 800.8953,-1275.8016 807.6254,-1283.9843 811.2592,-1278.0014"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_fio_interface.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_fio_interface.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-1474.718C622.1387,-1471.0037 581.3976,-1461.6305 550.4516,-1453.3797"/>
<polygon fill="#000000" stroke="#000000" points="551.3335,-1449.9925 540.7657,-1450.7489 549.4987,-1456.7477 551.3335,-1449.9925"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M927.5162,-1374.835C899.2813,-1394.6742 839.0768,-1433.0499 781,-1444.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-1444.718C752.6127,-1450.4213 698.3045,-1378.0123 672.8324,-1341.3072"/>
<polygon fill="#000000" stroke="#000000" points="675.5516,-1339.0836 667.0111,-1332.8139 669.7777,-1343.0411 675.5516,-1339.0836"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-1786.718C155.8361,-1698.5056 311.985,-1514.3254 167.5,-1398.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M933.7054,-1374.8442C893.4117,-1421.6266 740.7878,-1592.5419 582,-1688.718 555.2817,-1704.901 345.9593,-1801.6091 318.5,-1786.718"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-1444.718C724.1868,-1456.1323 703.357,-1436.0072 659,-1398.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-1398.718C560.207,-1315.6667 648.385,-1229.4005 582,-1118.718 558.5905,-1079.6878 520.04,-1097.8221 500.5,-1056.718"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-1444.718C726.2564,-1455.7165 714.5562,-1480.3161 659,-1474.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-1474.718C641.226,-1472.927 430.3829,-1274.4858 419,-1260.718 379.3551,-1212.7668 345.0186,-1147.4873 328.6711,-1114.1819"/>
<polygon fill="#000000" stroke="#000000" points="331.6978,-1112.4017 324.1892,-1104.9269 325.3976,-1115.4526 331.6978,-1112.4017"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M931.3671,-1350.5994C913.8213,-1333.2003 881.9838,-1299.5014 862,-1265.718 842.1274,-1232.1225 804.2209,-1123.3057 788.3136,-1076.4767"/>
<polygon fill="#000000" stroke="#000000" points="791.6192,-1075.3257 785.0992,-1066.9746 784.9883,-1077.5689 791.6192,-1075.3257"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-1444.718C758.7774,-1449.1827 755.9078,-1457.8803 736,-1468.718 719.9244,-1477.4694 717.7182,-1484.1268 700,-1488.718 625.6111,-1507.9941 422.5009,-1463.0698 419,-1459.718 357.2341,-1400.5828 419.2685,-1348.1557 383,-1270.718 344.6954,-1188.9329 288.0352,-1197.37 254,-1113.718 252.7846,-1110.7307 181.8724,-269.3545 169.3719,-120.9468"/>
<polygon fill="#000000" stroke="#000000" points="172.8432,-120.4568 168.5162,-110.7858 165.8679,-121.0443 172.8432,-120.4568"/>
</g>
<!-- sourcefile~korc_random.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~korc_random.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/korc_random.f90.html" xlink:title="korc_random.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="364,-606.718 273,-606.718 273,-582.718 364,-582.718 364,-606.718"/>
<text text-anchor="middle" x="318.5" y="-592.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_random.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_random.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_random.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-1398.718C634.7432,-1379.0855 633.5299,-1368.7855 618,-1341.718 598.3947,-1307.5474 607.057,-1291.1178 582,-1260.718 525.7715,-1192.5002 462.9383,-1223.43 419,-1146.718 369.1396,-1059.6666 414.7332,-791.8863 383,-696.718 372.6083,-665.5531 350.7495,-634.3 335.369,-614.758"/>
<polygon fill="#000000" stroke="#000000" points="338.0263,-612.4776 329.0246,-606.8901 332.5771,-616.8716 338.0263,-612.4776"/>
</g>
<!-- sourcefile~korc_input.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~korc_input.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M313.1258,-1080.5461C290.8343,-1030.0579 205.4787,-836.7359 176.892,-771.9899"/>
<polygon fill="#000000" stroke="#000000" points="180.0507,-770.4785 172.8098,-762.7441 173.6471,-773.3058 180.0507,-770.4785"/>
</g>
<!-- sourcefile~korc_input.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~korc_input.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.3325,-1104.7195C298.9083,-1165.8507 222.104,-1438.2069 167.5,-1398.718"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M775.4409,-1066.8387C756.3474,-1108.4687 693.2809,-1245.9745 668.8184,-1299.3108"/>
<polygon fill="#000000" stroke="#000000" points="665.5794,-1297.9774 664.5918,-1308.5261 671.9421,-1300.8957 665.5794,-1297.9774"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-1014.718C622.2004,-998.2238 619.022,-982.7069 582,-966.718 513.2176,-937.0126 490.158,-947.1695 419,-923.718 373.3412,-908.6703 363.475,-900.7007 318.5,-883.718"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M756.3876,-1066.8883C732.178,-1077.671 693.881,-1091.5881 659,-1090.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-1090.718C478.8581,-1086.2246 396.7851,-961.7921 254,-1071.718 134.8799,-1163.4249 288.9319,-1487.341 167.5,-1398.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M167.5,-1398.718C57.9437,-1315.7947 42.8393,-842.0867 40.8081,-733.0826"/>
<polygon fill="#000000" stroke="#000000" points="44.3049,-732.8536 40.638,-722.9136 37.3059,-732.9708 44.3049,-732.8536"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M773.967,-1042.4883C749.6662,-999.8525 667.9976,-853.367 618,-724.718 597.2122,-671.2288 607.0444,-652.3515 582,-600.718 554.8188,-544.6792 550.6432,-523.6615 500.5,-486.718"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-1090.718C555.3466,-1088.8646 433.919,-1090.489 367.7103,-1091.6962"/>
<polygon fill="#000000" stroke="#000000" points="367.5023,-1088.1993 357.5695,-1091.8857 367.6332,-1095.1981 367.5023,-1088.1993"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_coords.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_coords.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M740.9248,-1043.8818C716.7286,-1036.7775 685.544,-1026.6155 659,-1014.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-1014.718C612.1836,-993.7341 625.0627,-956.6053 582,-928.718 573.4919,-923.2082 563.7276,-918.7882 553.9816,-915.2686"/>
<polygon fill="#000000" stroke="#000000" points="554.8826,-911.8798 544.289,-912.0421 552.6717,-918.5214 554.8826,-911.8798"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-292.718C813.8711,-276.8482 789.8599,-360.9027 659,-368.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-368.718C570.8223,-387.2253 319.5778,-325.9331 254,-387.718 199.1826,-439.3649 260.5807,-662.5953 218,-724.718 215.959,-727.6958 213.4689,-730.3536 210.7001,-732.722"/>
<polygon fill="#000000" stroke="#000000" points="208.448,-730.0277 202.2998,-738.6561 212.4868,-735.745 208.448,-730.0277"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1086.202,-320.6641C1047.7016,-311.678 992.7384,-299.7838 944,-292.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-292.718C864.1367,-281.14 889.1054,-205.0161 826,-154.718 776.5644,-115.3154 760.5427,-106.9121 700,-88.718 565.636,-48.3395 284.2177,-12.4134 167.5,-58.718"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-368.718C622.8441,-370.8774 535.3776,-396.9472 500.5,-406.718"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1132.8906,-344.8502C1120.1541,-403.554 1063.6082,-658.2131 1026,-729.718 973.2861,-829.9435 917.8994,-826.2337 862,-924.718 837.8553,-967.2565 857.1373,-990.9958 826,-1028.718 823.4871,-1031.7623 820.5188,-1034.5255 817.3242,-1037.0146"/>
<polygon fill="#000000" stroke="#000000" points="815.3494,-1034.1249 809.0474,-1042.6417 819.2851,-1039.9138 815.3494,-1034.1249"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_rnd_numbers.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_rnd_numbers.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-444.718C629.8957,-440.478 597.4674,-440.1268 569.5631,-441.1564"/>
<polygon fill="#000000" stroke="#000000" points="569.3404,-437.6627 559.5018,-441.5936 569.6443,-444.6561 569.3404,-437.6627"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-292.718C906.8074,-288.6906 889.6325,-286.5 862,-311.718 824.3158,-346.1094 858.8636,-381.6944 826,-420.718 811.3992,-438.0556 802.6475,-437.9976 781,-444.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-444.718C729.2158,-460.7943 712.6558,-452.5348 659,-444.718"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-292.718C833.7045,-280.7745 828.1924,-216.4295 736,-154.718 701.6834,-131.7473 698.6962,-114.0977 659,-102.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-102.718C507.3183,-67.7644 322.2516,-80.592 228.3888,-90.8549"/>
<polygon fill="#000000" stroke="#000000" points="227.7711,-87.4022 218.2238,-91.9957 228.5518,-94.3585 227.7711,-87.4022"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~korc_experimental_pdf.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/korc_experimental_pdf.f90.html" xlink:title="korc_experimental_pdf.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1012,-424.718 876,-424.718 876,-400.718 1012,-400.718 1012,-424.718"/>
<text text-anchor="middle" x="944" y="-410.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_experimental_pdf.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1106.4153,-344.8683C1073.1824,-358.7515 1018.6791,-381.5205 982.0845,-396.808"/>
<polygon fill="#000000" stroke="#000000" points="980.609,-393.6312 972.731,-400.7155 983.3074,-400.0903 980.609,-393.6312"/>
</g>
<!-- sourcefile~korc_energy_pdfs.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~korc_energy_pdfs.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/korc_energy_pdfs.f90.html" xlink:title="korc_energy_pdfs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="557,-302.718 444,-302.718 444,-278.718 557,-278.718 557,-302.718"/>
<text text-anchor="middle" x="500.5" y="-288.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_energy_pdfs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_energy_pdfs.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_energy_pdfs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-292.718C810.8368,-278.9591 653.9825,-282.9668 567.0407,-286.9547"/>
<polygon fill="#000000" stroke="#000000" points="566.8717,-283.4587 557.0482,-287.4272 567.2024,-290.4508 566.8717,-283.4587"/>
</g>
<!-- sourcefile~korc_hammersley_generator.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~korc_hammersley_generator.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/korc_hammersley_generator.f90.html" xlink:title="korc_hammersley_generator.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1026,-344.718 862,-344.718 862,-320.718 1026,-320.718 1026,-344.718"/>
<text text-anchor="middle" x="944" y="-330.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_hammersley_generator.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hammersley_generator.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hammersley_generator.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1061.735,-332.718C1053.329,-332.718 1044.6839,-332.718 1036.0785,-332.718"/>
<polygon fill="#000000" stroke="#000000" points="1036.0114,-329.2181 1026.0113,-332.718 1036.0113,-336.2181 1036.0114,-329.2181"/>
</g>
<!-- sourcefile~korc_avalanche.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~korc_avalanche.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/korc_avalanche.f90.html" xlink:title="korc_avalanche.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="996,-720.718 892,-720.718 892,-696.718 996,-696.718 996,-720.718"/>
<text text-anchor="middle" x="944" y="-706.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_avalanche.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1132.28,-344.7244C1121.2986,-384.5291 1082.8227,-515.054 1026,-610.718 1008.3548,-640.4246 981.828,-670.2589 963.7581,-689.0696"/>
<polygon fill="#000000" stroke="#000000" points="961.0609,-686.8223 956.5822,-696.4239 966.071,-691.7109 961.0609,-686.8223"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~korc_simple_equilibrium_pdf.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/korc_simple_equilibrium_pdf.f90.html" xlink:title="korc_simple_equilibrium_pdf.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="582,-184.718 419,-184.718 419,-160.718 582,-160.718 582,-184.718"/>
<text text-anchor="middle" x="500.5" y="-170.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_simple_equilibrium_pdf.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_simple_equilibrium_pdf.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_simple_equilibrium_pdf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-102.718C606.9295,-87.7909 549.6905,-128.4972 520.3171,-153.9574"/>
<polygon fill="#000000" stroke="#000000" points="517.9235,-151.4024 512.7986,-160.6753 522.5876,-156.6223 517.9235,-151.4024"/>
</g>
<!-- sourcefile~korc_rnd_numbers.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~korc_rnd_numbers.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M490.0668,-434.5564C469.8644,-411.1277 423.7982,-358.2885 383,-315.718 355.2733,-286.7869 348.1347,-279.6913 318.5,-252.718"/>
</g>
<!-- sourcefile~korc_rnd_numbers.f90&#45;&gt;sourcefile~korc_random.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~korc_rnd_numbers.f90&#45;&gt;sourcefile~korc_random.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M485.6062,-458.8295C453.7986,-484.695 379.0602,-545.4713 341.254,-576.2148"/>
<polygon fill="#000000" stroke="#000000" points="338.8947,-573.6221 333.3444,-582.6468 343.3111,-579.0531 338.8947,-573.6221"/>
</g>
<!-- sourcefile~korc_constants.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~korc_constants.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M164.9631,-110.9429C149.2933,-186.4543 65.6714,-589.4196 45.0827,-688.6343"/>
<polygon fill="#000000" stroke="#000000" points="41.5956,-688.2131 42.9907,-698.7157 48.4496,-689.6355 41.5956,-688.2131"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-1284.718C903.8447,-1298.748 855.1814,-1289.3162 821.5363,-1278.9902"/>
<polygon fill="#000000" stroke="#000000" points="822.1947,-1275.5248 811.603,-1275.7818 820.0431,-1282.186 822.1947,-1275.5248"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1135.0899,-664.9633C1132.2138,-743.3701 1112.5749,-1174.6182 1026,-1265.718 1000.2292,-1292.8358 979.3164,-1272.3787 944,-1284.718"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1130.7686,-664.762C1113.0824,-708.2642 1046.5689,-858.8969 944,-938.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-938.718C739.1911,-929.6551 738.6846,-904.9834 700,-886.718 650.1777,-863.1938 634.6528,-864.9457 582,-848.718 545.9148,-837.5965 536.2306,-812.5052 500.5,-824.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-938.718C886.8281,-983.2103 852.867,-947.8462 781,-938.718"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1123.0041,-665.008C1103.9321,-682.8876 1065.584,-715.4867 1026,-729.718 923.2245,-766.668 890.2158,-748.718 781,-748.718 781,-748.718 781,-748.718 659,-748.718 551.8013,-748.718 525.44,-737.4489 419,-724.718 374.2212,-719.3622 363.537,-713.0625 318.5,-710.718"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.5,-486.718C469.6518,-465.9395 453.5411,-481.512 419,-467.718 391.9519,-456.9164 363.5449,-439.6068 343.8598,-426.5238"/>
<polygon fill="#000000" stroke="#000000" points="345.7101,-423.5499 335.4653,-420.8487 341.7895,-429.349 345.7101,-423.5499"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-596.718C849.4653,-581.5976 822.0262,-582.729 736,-540.718 697.501,-521.917 699.8838,-495.531 659,-482.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-482.718C590.0304,-468.2691 558.9451,-526.0849 500.5,-486.718"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-938.718C608.0453,-912.4058 412.8384,-1029.003 344.0912,-1074.8691"/>
<polygon fill="#000000" stroke="#000000" points="341.936,-1072.1013 335.6096,-1080.6 345.855,-1077.9014 341.936,-1072.1013"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-938.718C891.9473,-979.2265 880.8893,-992.1449 826,-1028.718 821.6074,-1031.6448 816.8725,-1034.5917 812.1812,-1037.3966"/>
<polygon fill="#000000" stroke="#000000" points="810.1859,-1034.5086 803.3145,-1042.573 813.7151,-1040.5538 810.1859,-1034.5086"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_rnd_numbers.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_rnd_numbers.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1104.5909,-640.709C1067.2278,-626.8928 1002.1199,-605.0417 944,-596.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-596.718C842.4627,-582.1763 823.199,-550.7329 736,-496.718 700.8945,-474.9721 699.8637,-450.6712 659,-444.718"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-482.718C624.6019,-475.5117 616.9134,-496.6915 582,-500.718 510.0326,-509.0179 489.9543,-515.336 419,-500.718 340.8078,-484.6089 306.0404,-490.2599 254,-429.718 213.0999,-382.1363 180.7925,-187.6413 170.7527,-121.1377"/>
<polygon fill="#000000" stroke="#000000" points="174.1683,-120.311 169.2364,-110.934 167.2444,-121.3399 174.1683,-120.311"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_random.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_random.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944,-596.718C887.2191,-588.9413 882.0811,-636.9091 826,-648.718 734.4039,-668.0053 501.5911,-614.6607 500.5,-614.718"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125.7402,-640.4864C1094.7506,-601.6483 998.3704,-480.8585 959.9979,-432.7676"/>
<polygon fill="#000000" stroke="#000000" points="962.713,-430.5587 953.7401,-424.925 957.2414,-434.9246 962.713,-430.5587"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hammersley_generator.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hammersley_generator.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1132.9125,-640.5918C1124.0031,-601.1016 1091.4794,-474.0007 1026,-391.718 1012.4549,-374.697 992.7865,-360.3197 976.1077,-350.0199"/>
<polygon fill="#000000" stroke="#000000" points="977.5911,-346.83 967.2072,-344.7264 974.0129,-352.8463 977.5911,-346.83"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1094.4184,-664.7314C1065.3622,-673.2283 1026.2053,-684.6789 995.127,-693.767"/>
<polygon fill="#000000" stroke="#000000" points="993.9592,-690.4619 985.3436,-696.628 995.924,-697.1805 993.9592,-690.4619"/>
</g>
<!-- sourcefile~korc_coords.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~korc_coords.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-748.718C308.1529,-734.8523 184.7381,-709.2448 167.5,-710.718"/>
</g>
<!-- sourcefile~korc_coords.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~korc_coords.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-748.718C286.8698,-706.3315 272.8497,-698.1323 254,-648.718 215.9242,-548.9024 179.111,-211.4002 169.7679,-121.0963"/>
<polygon fill="#000000" stroke="#000000" points="173.2246,-120.4944 168.7219,-110.904 166.2612,-121.2091 173.2246,-120.4944"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M480.9741,-890.5977C444.6393,-867.1887 366.0285,-812.4094 318.5,-748.718"/>
</g>
<!-- sourcefile~korc_random.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~korc_random.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M306.4989,-606.7766C277.035,-635.8904 201.0964,-707.8467 167.5,-710.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M167.5,-710.718C142.431,-712.8605 114.4767,-713.0929 91.1905,-712.6925"/>
<polygon fill="#000000" stroke="#000000" points="91.2568,-709.1932 81.1838,-712.4772 91.1062,-716.1916 91.2568,-709.1932"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M936.2315,-424.9101C919.3848,-452.0323 879.5948,-519.9285 862,-582.718 817.4192,-741.8109 900.4558,-805.2246 826,-952.718 801.7488,-1000.7584 762.5096,-986.886 736,-1033.718 694.7367,-1106.6141 723.7273,-1138.3843 700,-1218.718 691.5828,-1247.216 678.2386,-1278.7786 669.0739,-1299.1369"/>
<polygon fill="#000000" stroke="#000000" points="665.8016,-1297.8771 664.8305,-1308.4273 672.1688,-1300.7853 665.8016,-1297.8771"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M928.392,-424.7674C906.1976,-441.6818 863.9888,-473.0452 826,-496.718 721.3581,-561.9258 695.9876,-581.7201 582,-628.718 452.743,-682.0116 291.9872,-722.3716 214.1125,-740.3818"/>
<polygon fill="#000000" stroke="#000000" points="213.0986,-737.0234 204.1349,-742.6716 214.6644,-743.8461 213.0986,-737.0234"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M922.2353,-400.5252C904.5099,-389.8346 879.6228,-373.0134 862,-353.718 840.7703,-330.4734 846.3126,-316.7682 826,-292.718 809.1094,-272.7195 804.406,-266.4395 781,-254.718"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-406.718C658.1172,-385.7038 620.9601,-374.6067 500.5,-406.718"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.5,-862.718C474.7764,-889.5817 447.9753,-858.3987 419,-881.718 357.4993,-931.2138 331.4305,-1027.3526 322.4602,-1070.646"/>
<polygon fill="#000000" stroke="#000000" points="318.9813,-1070.1987 320.4942,-1080.685 325.8509,-1071.544 318.9813,-1070.1987"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-634.718C727.673,-690.9651 669.5611,-638.8478 618,-696.718 574.6881,-745.3296 627.1529,-791.8114 582,-838.718 555.8129,-865.9221 526.6155,-835.4451 500.5,-862.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M936.4164,-425.019C914.6308,-459.8796 849.053,-561.537 781,-634.718"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M936.1546,-424.8889C919.1545,-451.9688 879.0778,-519.7859 862,-582.718 835.9587,-678.6808 879.1299,-944.669 826,-1028.718 824.2162,-1031.5399 822.008,-1034.0892 819.5354,-1036.3858"/>
<polygon fill="#000000" stroke="#000000" points="817.3054,-1033.6849 811.484,-1042.5372 821.5551,-1039.2473 817.3054,-1033.6849"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_rnd_numbers.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_rnd_numbers.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-482.718C725.3725,-494.1574 715.1983,-452.9052 659,-444.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M923.5386,-424.7517C893.5001,-441.648 835.1489,-471.5827 781,-482.718"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M875.6179,-415.0918C846.2386,-414.8564 811.6756,-412.8941 781,-406.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-406.718C754.6838,-401.4196 607.597,-277.8057 582,-269.718 573.3119,-266.9729 261.7571,-271.4978 254,-266.718 201.3804,-234.295 179.3613,-158.6034 171.4018,-120.8909"/>
<polygon fill="#000000" stroke="#000000" points="174.8032,-120.0482 169.4397,-110.9112 167.9346,-121.3986 174.8032,-120.0482"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_coords.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_coords.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-634.718C683.9371,-734.565 697.2648,-798.5858 582,-876.718 573.5174,-882.468 563.6866,-887.0072 553.8508,-890.5705"/>
<polygon fill="#000000" stroke="#000000" points="552.4524,-887.3468 544.063,-893.8174 554.6564,-893.9908 552.4524,-887.3468"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_random.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_random.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-482.718C705.0806,-498.3303 687.7792,-510.9784 618,-544.718 563.2745,-571.1789 561.1779,-611.0766 500.5,-614.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.5,-614.718C458.0291,-616.9471 410.2396,-611.3834 374.2913,-605.5635"/>
<polygon fill="#000000" stroke="#000000" points="374.4494,-602.0412 364.0084,-603.8398 373.2921,-608.9449 374.4494,-602.0412"/>
</g>
<!-- sourcefile~special_fun_modules.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~special_fun_modules.f90</title>
<g id="a_sourcefile~~main.f90~~EfferentGraph_node26"><a xlink:href=".././sourcefile/special_fun_modules.f90.html" xlink:title="special_fun_modules.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="383,-224.718 254,-224.718 254,-200.718 383,-200.718 383,-224.718"/>
<text text-anchor="middle" x="318.5" y="-210.318" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">special_fun_modules.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~special_fun_modules.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~special_fun_modules.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M925.3607,-400.5898C873.4848,-367.5328 722.0219,-275.7242 582,-236.718 519.8503,-219.4048 446.5835,-213.8648 393.1043,-212.3909"/>
<polygon fill="#000000" stroke="#000000" points="393.0984,-208.8899 383.0191,-212.1546 392.9343,-215.888 393.0984,-208.8899"/>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-329.718C290.0213,-341.3024 272.582,-330.2243 254,-354.718 154.1408,-486.3467 310.7672,-587.9985 218,-724.718 215.973,-727.7053 213.493,-730.37 210.7311,-732.7431"/>
<polygon fill="#000000" stroke="#000000" points="208.4795,-730.0488 202.3425,-738.6853 212.5258,-735.7609 208.4795,-730.0488"/>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-252.718C296.3994,-232.6022 274.4918,-255.4706 254,-233.718 205.2088,-181.9249 264.8584,-131.2661 218,-77.718 202.208,-59.6715 189.929,-50.2326 167.5,-58.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M443.6921,-293.1491C403.9514,-291.7698 352.1583,-283.3536 318.5,-252.718"/>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M450.7701,-302.8127C439.9179,-306.4702 428.767,-311.0602 419,-316.718 401.2692,-326.989 361.5082,-365.4942 337.656,-389.314"/>
<polygon fill="#000000" stroke="#000000" points="335.0976,-386.9229 330.5188,-396.4772 340.0564,-391.8636 335.0976,-386.9229"/>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M490.4872,-302.7757C472.4586,-325.2783 434.9334,-375.9139 419,-425.718 354.8935,-626.1003 424.3401,-691.4325 383,-897.718 369.9906,-962.6343 341.9231,-1035.9618 327.4835,-1071.3515"/>
<polygon fill="#000000" stroke="#000000" points="324.214,-1070.0992 323.6334,-1080.6781 330.6844,-1072.7702 324.214,-1070.0992"/>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M443.6317,-297.6673C406.9537,-303.4077 358.7597,-313.3414 318.5,-329.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-329.718C224.733,-367.8599 182.8885,-185.7051 171.13,-120.8969"/>
<polygon fill="#000000" stroke="#000000" points="174.5516,-120.1436 169.3871,-110.8928 167.6554,-121.3451 174.5516,-120.1436"/>
</g>
<!-- sourcefile~korc_hammersley_generator.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~korc_hammersley_generator.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-254.718C691.9527,-210.1242 675.5799,-185.7888 582,-151.718 570.9119,-147.681 178.5367,-54.5426 167.5,-58.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M898.4987,-320.634C886.3918,-316.7907 873.4913,-312.1122 862,-306.718 823.2744,-288.5397 817.145,-277.6017 781,-254.718"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M938.1069,-721.0387C922.8423,-753.5193 881.8284,-844.5031 862,-924.718 830.41,-1052.5141 883.6888,-1100.3889 826,-1218.718 821.2067,-1228.5499 813.3909,-1237.5072 805.6072,-1244.7961"/>
<polygon fill="#000000" stroke="#000000" points="803.1677,-1242.2799 797.9473,-1251.4993 807.7776,-1247.5477 803.1677,-1242.2799"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.5,-824.718C464.7694,-836.9308 454.9516,-837.1719 419,-848.718 373.9676,-863.1805 362.7023,-900.5478 318.5,-883.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-710.718C573.5166,-725.6216 582.609,-796.653 500.5,-824.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-883.718C258.5172,-860.8798 206.8564,-802.3188 182.4676,-771.0734"/>
<polygon fill="#000000" stroke="#000000" points="185.1801,-768.8585 176.3277,-763.0373 179.6178,-773.1084 185.1801,-768.8585"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-710.718C251.4796,-707.2292 234.3674,-705.0033 167.5,-710.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.5,-710.718C419.8987,-703.9027 399.2795,-714.9231 318.5,-710.718"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M891.8377,-708.1494C859.827,-708.1006 818.0119,-708.574 781,-710.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-710.718C701.3634,-715.3311 567.6567,-529.7673 500.5,-486.718"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-710.718C676.5032,-722.5161 677.6318,-794.9764 582,-838.718 547.6614,-854.4243 528.8716,-837.8006 500.5,-862.718"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M933.246,-720.7742C915.415,-741.4682 879.922,-785.7787 862,-829.718 828.0548,-912.9415 877.7045,-955.1988 826,-1028.718 824.0276,-1031.5225 821.6493,-1034.0674 819.029,-1036.3678"/>
<polygon fill="#000000" stroke="#000000" points="816.5959,-1033.812 810.606,-1042.5511 820.7383,-1039.4548 816.5959,-1033.812"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781,-710.718C726.7778,-710.6803 712.4165,-701.4051 659,-710.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-710.718C589.6024,-722.8172 570.5717,-717.9552 500.5,-710.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.5,-710.718C442.1056,-704.6869 291.112,-661.2041 254,-615.718 190.553,-537.9545 172.2245,-210.4049 168.3662,-121.2208"/>
<polygon fill="#000000" stroke="#000000" points="171.8589,-120.9706 167.9482,-111.124 164.8649,-121.2602 171.8589,-120.9706"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_coords.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_coords.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M659,-900.718C624.3802,-895.6744 585.057,-896.1333 554.2395,-897.8735"/>
<polygon fill="#000000" stroke="#000000" points="553.895,-894.3881 544.1335,-898.5066 554.3328,-901.3744 553.895,-894.3881"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M891.7881,-715.0905C881.559,-717.5561 871.1687,-720.9756 862,-725.718 756.196,-780.4442 776.8751,-917.8906 659,-900.718"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-172.718C290.483,-183.1169 272.6954,-168.4034 254,-191.718 179.734,-284.3336 283.1961,-625.5084 218,-724.718 216.1045,-727.6023 213.7834,-730.184 211.1885,-732.4918"/>
<polygon fill="#000000" stroke="#000000" points="208.7749,-729.9186 202.7339,-738.6225 212.8842,-735.5855 208.7749,-729.9186"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M418.611,-160.7143C386.5003,-159.0604 349.9,-161.0635 318.5,-172.718"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-172.718C289.8246,-183.3612 276.8155,-169.0898 254,-148.718 227.6091,-125.1538 244.348,-101.3302 218,-77.718 200.1415,-61.7138 189.929,-50.2326 167.5,-58.718"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M488.634,-184.8026C471.7419,-202.4282 440.4375,-236.6942 419,-269.718 399.0857,-300.3954 404.1663,-313.8907 383,-343.718 370.8857,-360.7893 354.1698,-377.4953 340.7908,-389.6955"/>
<polygon fill="#000000" stroke="#000000" points="338.0991,-387.4062 332.9626,-396.6726 342.7566,-392.6318 338.0991,-387.4062"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M485.4525,-184.9612C466.0752,-201.7514 433.2067,-233.9437 419,-269.718 367.408,-399.6334 409.1733,-760.4055 383,-897.718 370.6034,-962.7541 342.2598,-1036.0276 327.6222,-1071.3786"/>
<polygon fill="#000000" stroke="#000000" points="324.3553,-1070.1188 323.7167,-1080.6944 330.8109,-1072.8253 324.3553,-1070.1188"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_constants.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M318.5,-172.718C268.7151,-191.1963 213.4435,-146.0552 185.6171,-118.3739"/>
<polygon fill="#000000" stroke="#000000" points="188.0101,-115.8147 178.5237,-111.0968 182.9975,-120.7008 188.0101,-115.8147"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~special_fun_modules.f90 -->
<g id="sourcefile~~main.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~special_fun_modules.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M445.894,-184.7193C426.1881,-189.0503 403.7561,-193.9804 383.2648,-198.484"/>
<polygon fill="#000000" stroke="#000000" points="382.3973,-195.091 373.3818,-200.6561 383.9,-201.9279 382.3973,-195.091"/>
</g>
</g>
</svg>
</div><script>var pansourcefilemainf90EfferentGraph = svgPanZoom('#sourcefilemainf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#progs-1">Programs</a></h3></div>
  <div id="progs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/main.html">main</a>
      
    </div>
  </div>
</div>

















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/main.f90.html#src">main.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">program </span><span class="n">main</span>
<a name="ln-2"></a>  <span class="c">!! @note  Main function of KORC. @endnote</span>
<a name="ln-3"></a>  <span class="c">!! The main program contains the calls to the main functions and subroutines. </span>
<a name="ln-4"></a>  <span class="c">!! Also, it contains the variables that control</span>
<a name="ln-5"></a>  <span class="c">!! the behavior of the core of KORC and all other external/optional modules.</span>
<a name="ln-6"></a>
<a name="ln-7"></a>  <span class="k">use </span><span class="n">korc_types</span>
<a name="ln-8"></a>  <span class="k">use </span><span class="n">korc_units</span>
<a name="ln-9"></a>  <span class="k">use </span><span class="n">korc_hpc</span>
<a name="ln-10"></a>  <span class="k">use </span><span class="n">korc_HDF5</span>
<a name="ln-11"></a>  <span class="k">use </span><span class="n">korc_fields</span>
<a name="ln-12"></a>  <span class="k">use </span><span class="n">korc_ppusher</span>
<a name="ln-13"></a>  <span class="k">use </span><span class="n">korc_interp</span>
<a name="ln-14"></a>  <span class="k">use </span><span class="n">korc_collisions</span>
<a name="ln-15"></a>  <span class="k">use </span><span class="n">korc_initialize</span>
<a name="ln-16"></a>  <span class="k">use </span><span class="n">korc_finalize</span>
<a name="ln-17"></a>  <span class="k">use </span><span class="n">korc_profiles</span>
<a name="ln-18"></a>  <span class="k">use </span><span class="n">korc_input</span>
<a name="ln-19"></a><span class="cp">#ifdef FIO</span>
<a name="ln-20"></a>  <span class="k">use </span><span class="n">korc_fio</span>
<a name="ln-21"></a><span class="cp">#endif</span>
<a name="ln-22"></a>  
<a name="ln-23"></a>  <span class="k">implicit none</span>
<a name="ln-24"></a>
<a name="ln-25"></a><span class="k">  TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-26"></a>  <span class="c">!! Contains the parameters that control the core of KORC: </span>
<a name="ln-27"></a>  <span class="c">!! time steping, output list, etc.</span>
<a name="ln-28"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">SPECIES</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">spp</span>
<a name="ln-29"></a>  <span class="c">!! Contains the initial parameters of each species, which </span>
<a name="ln-30"></a>  <span class="c">!! can be different electrons with different</span>
<a name="ln-31"></a>  <span class="c">!! distribution functions.</span>
<a name="ln-32"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">FIELDS</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F</span>
<a name="ln-33"></a>  <span class="c">!! F: Contains the parameters of the analytical magnetic </span>
<a name="ln-34"></a>  <span class="c">!! and electric fields, or in the case of using </span>
<a name="ln-35"></a>  <span class="c">!! external fields it contains the data used in the interpolations. </span>
<a name="ln-36"></a>  <span class="c">!!See [[korc_fields(module)]] for details.</span>
<a name="ln-37"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">PROFILES</span><span class="p">)</span> <span class="kd">::</span> <span class="n">P</span>
<a name="ln-38"></a>  <span class="c">!! P: Contains the parameters of the analytical plasma profiles, </span>
<a name="ln-39"></a>  <span class="c">!! or in the case of using external </span>
<a name="ln-40"></a>  <span class="c">!! fields it contains the data used in the interpolations. </span>
<a name="ln-41"></a>  <span class="c">!! See [[korc_profiles(module)]] for details.</span>
<a name="ln-42"></a>  <span class="kt">INTEGER</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="kd">::</span> <span class="n">it</span> 
<a name="ln-43"></a>  <span class="c">!! Time iteration</span>
<a name="ln-44"></a>  <span class="kt">INTEGER</span> 				<span class="kd">::</span> <span class="n">mpierr</span>
<a name="ln-45"></a>    
<a name="ln-46"></a>  <span class="k">call </span><span class="n">initialize_communications</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-47"></a>  <span class="c">!!&lt;h2&gt;Order of KORC operations&lt;/h2&gt;</span>
<a name="ln-48"></a>  <span class="c">!!</span>
<a name="ln-49"></a>  <span class="c">!!&lt;h3&gt;Communication and Timing&lt;/h3&gt;</span>
<a name="ln-50"></a>  <span class="c">!! &lt;h4&gt;1\. Parallel Communications&lt;/h4&gt;</span>
<a name="ln-51"></a>  <span class="c">!!</span>
<a name="ln-52"></a>  <span class="c">!! Subroutine [[initialize_communications]] in [[korc_hpc]] that </span>
<a name="ln-53"></a>  <span class="c">!! initializes MPI and OpenMP communications.</span>
<a name="ln-54"></a>
<a name="ln-55"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-56"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-57"></a>  <span class="k">end if</span>
<a name="ln-58"></a><span class="k">  </span>
<a name="ln-59"></a><span class="k">  call </span><span class="n">timing_KORC</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-60"></a>  <span class="c">!! &lt;h4&gt;2\. Timers&lt;/h4&gt;</span>
<a name="ln-61"></a>  <span class="c">!!</span>
<a name="ln-62"></a>  <span class="c">!! Subroutine [[timing_KORC]] in [[korc_hpc]] that times the </span>
<a name="ln-63"></a>  <span class="c">!! execution of any parallel sections of KORC.</span>
<a name="ln-64"></a>  
<a name="ln-65"></a>  <span class="c">! * * * INITIALIZATION STAGE * * *!</span>
<a name="ln-66"></a>
<a name="ln-67"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-68"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-69"></a>  <span class="k">end if</span>
<a name="ln-70"></a><span class="k">  </span>
<a name="ln-71"></a><span class="k">  call </span><span class="n">initialize_HDF5</span><span class="p">()</span>
<a name="ln-72"></a>  <span class="c">!!&lt;h3&gt;Initialization&lt;/h3&gt;</span>
<a name="ln-73"></a>  <span class="c">!!</span>
<a name="ln-74"></a>  <span class="c">!! &lt;h4&gt;1\. HDF5&lt;/h4&gt;</span>
<a name="ln-75"></a>  <span class="c">!!</span>
<a name="ln-76"></a>  <span class="c">!! Subroutine [[initialize_HDF5]] in [[korc_HDF5]] that initializes</span>
<a name="ln-77"></a>  <span class="c">!! HDF5 library. </span>
<a name="ln-78"></a>
<a name="ln-79"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-80"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-81"></a>  <span class="k">end if</span>
<a name="ln-82"></a><span class="k">  </span>
<a name="ln-83"></a><span class="k">  call </span><span class="n">initialize_korc_parameters</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-84"></a>  <span class="c">!! &lt;h4&gt;2\. Initialize korc parameters&lt;/h4&gt;</span>
<a name="ln-85"></a>  <span class="c">!!</span>
<a name="ln-86"></a>  <span class="c">!! Subroutine [[initialize_korc_parameters]] in [[korc_initialize]] that </span>
<a name="ln-87"></a>  <span class="c">!! initializes paths and KORC parameters through [[load_korc_params]]</span>
<a name="ln-88"></a>  <span class="c">!! on MPI processes.</span>
<a name="ln-89"></a>
<a name="ln-90"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-91"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-92"></a>  <span class="k">end if</span>
<a name="ln-93"></a><span class="k">  </span>
<a name="ln-94"></a><span class="k">  call </span><span class="n">initialize_fields</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-95"></a>  <span class="c">!! &lt;h4&gt;3\. Initialize fields&lt;/h4&gt;</span>
<a name="ln-96"></a>  <span class="c">!!</span>
<a name="ln-97"></a>  <span class="c">!! Subroutine [[initialize_fields]] in [[korc_fields]] that initializes </span>
<a name="ln-98"></a>  <span class="c">!! parameters of the EM fields, either analytically or from an external HDF5</span>
<a name="ln-99"></a>  <span class="c">!! file. Reads in &amp;amp;analytical_fields_params and </span>
<a name="ln-100"></a>  <span class="c">!! &amp;amp;externalPlasmaModel namelists from input file.</span>
<a name="ln-101"></a>
<a name="ln-102"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-103"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-104"></a>  <span class="k">end if</span>
<a name="ln-105"></a>
<a name="ln-106"></a><span class="k">  call </span><span class="n">initialize_profiles</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-107"></a>  <span class="c">!! &lt;h4&gt;4\. Initialize Profiles&lt;/h4&gt;</span>
<a name="ln-108"></a>  <span class="c">!! </span>
<a name="ln-109"></a>  <span class="c">!! Subroutine [[initialize_profiles]] in [[korc_profiles]] that initializes </span>
<a name="ln-110"></a>  <span class="c">!! parameters of the plasma profiles, either analytically or from an</span>
<a name="ln-111"></a>  <span class="c">!! external HDF5</span>
<a name="ln-112"></a>  <span class="c">!! file. Reads in &amp;amp;plasmaProfiles namelist from input file.</span>
<a name="ln-113"></a>  <span class="c">!! Only initialized if collisions (params%collisions==T) are</span>
<a name="ln-114"></a>
<a name="ln-115"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-116"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-117"></a>  <span class="k">end if</span>
<a name="ln-118"></a><span class="k">  </span>
<a name="ln-119"></a><span class="k">  call </span><span class="n">initialize_particles</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span> <span class="c">! Initialize particles</span>
<a name="ln-120"></a>  <span class="c">!! &lt;h4&gt;5\. Initialize Particle Velocity Phase Space&lt;/h4&gt;</span>
<a name="ln-121"></a>  <span class="c">!! </span>
<a name="ln-122"></a>  <span class="c">!! Subroutine [[initialize_particles]] in [[korc_initialize]] that </span>
<a name="ln-123"></a>  <span class="c">!! initializes particle parameters from &amp;amplasma_species namelist, </span>
<a name="ln-124"></a>  <span class="c">!! allocates arrays for individual particles, including location, velocity, </span>
<a name="ln-125"></a>  <span class="c">!! local EM fields and plasma profiles, etc., and </span>
<a name="ln-126"></a>  <span class="c">!! calls [[initial_energy_pitch_dist]] to assign particles&#39; energy and pitch</span>
<a name="ln-127"></a>  <span class="c">!! angle according to the chosen distribution.</span>
<a name="ln-128"></a>
<a name="ln-129"></a><span class="c">!  write(output_unit_write,&#39;(&quot;init eta: &quot;,E17.10)&#39;) spp(1)%vars%eta</span>
<a name="ln-130"></a>
<a name="ln-131"></a>  
<a name="ln-132"></a><span class="cp">#ifdef FIO</span>
<a name="ln-133"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-134"></a>
<a name="ln-135"></a><span class="k">     if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-136"></a><span class="k">        write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;* * * * INITIALIZING M3D-C1 INTERFACE * * * *&quot;</span>
<a name="ln-137"></a>     <span class="n">endif</span>
<a name="ln-138"></a>     
<a name="ln-139"></a>     <span class="k">call </span><span class="n">initialize_m3d_c1</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">spp</span><span class="p">,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-140"></a>
<a name="ln-141"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-142"></a><span class="k">        write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;* * * * * * * * * * * * * * * * * * * * * * *&quot;</span>
<a name="ln-143"></a>     <span class="n">endif</span>
<a name="ln-144"></a>
<a name="ln-145"></a>  <span class="n">elseif</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="s1">&#39;NIMROD&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-146"></a>
<a name="ln-147"></a><span class="k">     if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-148"></a><span class="k">        write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;* * * * INITIALIZING NIMROD INTERFACE * * * *&quot;</span>
<a name="ln-149"></a>     <span class="n">endif</span>
<a name="ln-150"></a>     
<a name="ln-151"></a>     <span class="k">call </span><span class="n">initialize_nimrod</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">spp</span><span class="p">,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-152"></a>
<a name="ln-153"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-154"></a><span class="k">        write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;* * * * * * * * * * * * * * * * * * * * * * *&quot;</span>
<a name="ln-155"></a>     <span class="n">endif</span>
<a name="ln-156"></a>     
<a name="ln-157"></a>  <span class="n">endif</span>
<a name="ln-158"></a><span class="cp">#endif  </span>
<a name="ln-159"></a>
<a name="ln-160"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-161"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-162"></a>  <span class="k">end if</span>
<a name="ln-163"></a><span class="k">  </span>
<a name="ln-164"></a><span class="k">  call </span><span class="n">compute_charcs_plasma_params</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-165"></a>  <span class="c">!! &lt;h4&gt;9\. Compute Characteristic Plasma Parameters&lt;/h4&gt;</span>
<a name="ln-166"></a>  <span class="c">!!</span>
<a name="ln-167"></a>  <span class="c">!! Subroutine [[compute_charcs_plasma_params]] in [[korc_units]] calculates</span>
<a name="ln-168"></a>  <span class="c">!! the characteristic plasma parameters params%cpp that are used for normalizations.</span>
<a name="ln-169"></a>  <span class="c">!! Also finds the maximum non-relativistic and relativistic cyclotron frequencies</span>
<a name="ln-170"></a>  <span class="c">!! to be used for setting the timstep for the time-evolution algorithms.</span>
<a name="ln-171"></a>
<a name="ln-172"></a>  <span class="k">call </span><span class="n">initialize_collision_params</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-173"></a>  <span class="c">!! &lt;h4&gt;6\. Initialize Collision Parameters&lt;/h4&gt;</span>
<a name="ln-174"></a>  <span class="c">!!</span>
<a name="ln-175"></a>  <span class="c">!! Subroutine [[initialize_collision_params]] in [[korc_collisions]] that</span>
<a name="ln-176"></a>  <span class="c">!! initializes collision parameters for the SS (single-species) and MS</span>
<a name="ln-177"></a>  <span class="c">!! (multiple-species) data types, reading in namefiles from the KORC input file.</span>
<a name="ln-178"></a>  <span class="c">!! MS reads in namelist &amp;CollisionParamsMultipleSpecies while SS reads in</span>
<a name="ln-179"></a>  <span class="c">!! namelist &amp;CollisionParamsSingleSpecies. </span>
<a name="ln-180"></a>  
<a name="ln-181"></a>  <span class="k">call </span><span class="n">define_time_step</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-182"></a>  <span class="c">!! &lt;h4&gt;10\. Define Time Step&lt;/h4&gt;</span>
<a name="ln-183"></a>  <span class="c">!!</span>
<a name="ln-184"></a>  <span class="c">!! Subroutine [[define_time_step]] in [[korc_initialize]] either loads</span>
<a name="ln-185"></a>  <span class="c">!! time-stepping parameters for a restart, or defines new parameters based</span>
<a name="ln-186"></a>  <span class="c">!! on a maximum timestep</span>
<a name="ln-187"></a>  <span class="c">!! set by the inverse of the relativistic cyclotron frequency.</span>
<a name="ln-188"></a>
<a name="ln-189"></a>  
<a name="ln-190"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-191"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-192"></a>  <span class="k">end if</span>
<a name="ln-193"></a><span class="k">  </span>
<a name="ln-194"></a><span class="k">  call </span><span class="n">initialize_particle_pusher</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-195"></a>  <span class="c">!! &lt;h4&gt;11\. Initialize Particle Pusher&lt;/h4&gt;    </span>
<a name="ln-196"></a>  
<a name="ln-197"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">SC_E</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-198"></a><span class="k">     call </span><span class="n">define_SC_time_step</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-199"></a>  <span class="k">end if</span>
<a name="ln-200"></a><span class="k">     </span>
<a name="ln-201"></a><span class="k">  call </span><span class="n">normalize_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<a name="ln-202"></a>  <span class="c">!! &lt;h4&gt;12\. Normalize Variables&lt;/h4&gt;</span>
<a name="ln-203"></a>  <span class="c">!!</span>
<a name="ln-204"></a>  <span class="c">!! Subroutine [[normalize_variables]] in [[korc_units]] normalizes </span>
<a name="ln-205"></a>  <span class="c">!! variables consistent with characteristic plasma parameters </span>
<a name="ln-206"></a>  <span class="c">!! calculated in [[compute_charcs_plasma_params]].</span>
<a name="ln-207"></a>
<a name="ln-208"></a>
<a name="ln-209"></a>  
<a name="ln-210"></a>  <span class="k">call </span><span class="n">normalize_collisions_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-211"></a>  <span class="c">!! &lt;h4&gt;13\. Normalize Collision Parameters &lt;/h4&gt;</span>
<a name="ln-212"></a>  <span class="c">!!</span>
<a name="ln-213"></a>  <span class="c">!! Subroutine [[normalize_collisions_params]] in [[korc_collisions]] that</span>
<a name="ln-214"></a>  <span class="c">!! normalizes collision parameters for the SS (single-species) and MS</span>
<a name="ln-215"></a>  <span class="c">!! (multiple-species) data types.</span>
<a name="ln-216"></a>
<a name="ln-217"></a>  
<a name="ln-218"></a>  <span class="k">call </span><span class="n">define_collisions_time_step</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-219"></a>  <span class="c">!! &lt;h4&gt;14\. Define Collision Time Step&lt;/h4&gt;</span>
<a name="ln-220"></a>  <span class="c">!!</span>
<a name="ln-221"></a>  <span class="c">!! Subroutine [[define_collisions_time_step]] in [[korc_collisions]] that</span>
<a name="ln-222"></a>  <span class="c">!! sets subcycling iteration number for collisions based off of the collision</span>
<a name="ln-223"></a>  <span class="c">!! frequency model used.</span>
<a name="ln-224"></a>
<a name="ln-225"></a>  <span class="c">! *** *** *** *** *** ***   *** *** *** *** *** *** ***</span>
<a name="ln-226"></a>  <span class="c">! *** BEYOND THIS POINT VARIABLES ARE DIMENSIONLESS ***</span>
<a name="ln-227"></a>  <span class="c">! *** *** *** *** *** ***   *** *** *** *** *** *** ***</span>
<a name="ln-228"></a>
<a name="ln-229"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-230"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-231"></a>  <span class="k">end if</span>
<a name="ln-232"></a>
<a name="ln-233"></a><span class="cp">#ifdef PSPLINE</span>
<a name="ln-234"></a>  <span class="k">call </span><span class="n">initialize_fields_interpolant</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-235"></a>  <span class="c">!! &lt;h4&gt;15\. Initialize Fields Interpolant&lt;/h4&gt;</span>
<a name="ln-236"></a>  <span class="c">!!</span>
<a name="ln-237"></a>  <span class="c">!! Subroutine [[initialize_fields_interpolant]] in [[korc_interp]] calls</span>
<a name="ln-238"></a>  <span class="c">!! EZspline</span>
<a name="ln-239"></a>  <span class="c">!! subroutines EZspline_init for memory allocation and boundary condition</span>
<a name="ln-240"></a>  <span class="c">!! setup</span>
<a name="ln-241"></a>  <span class="c">!! and EZspline_setup to compute the necessary cubic coefficients needed</span>
<a name="ln-242"></a>  <span class="c">!! for subsequent</span>
<a name="ln-243"></a>  <span class="c">!! field interpolations. The magnetic field can be defined in terms of an</span>
<a name="ln-244"></a>  <span class="c">!! axisymmetric</span>
<a name="ln-245"></a>  <span class="c">!! scalar flux function, axisymmetric field, or 3D field, while the</span>
<a name="ln-246"></a>  <span class="c">!! electric field</span>
<a name="ln-247"></a>  <span class="c">!! can be defined as an axisymmetric or 3D field.</span>
<a name="ln-248"></a>
<a name="ln-249"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-250"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-251"></a>  <span class="k">end if</span>
<a name="ln-252"></a><span class="k">  </span>
<a name="ln-253"></a><span class="k">  call </span><span class="n">initialize_profiles_interpolant</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<a name="ln-254"></a><span class="cp">#endif</span>
<a name="ln-255"></a>  <span class="c">!! &lt;h4&gt;16\. Initialize Profiles Interpolant&lt;/h4&gt;</span>
<a name="ln-256"></a>  <span class="c">!!</span>
<a name="ln-257"></a>  <span class="c">!! Subroutine [[initialize_profiles_interpolant]] in [[korc_interp]]</span>
<a name="ln-258"></a>  <span class="c">!! calls EZspline</span>
<a name="ln-259"></a>  <span class="c">!! subroutines EZlinear_init for axisymmetric (flux-surface quantities) or</span>
<a name="ln-260"></a>  <span class="c">!! EZspline_init for 3D profiles for memory allocation and boundary</span>
<a name="ln-261"></a>  <span class="c">!! condition setup</span>
<a name="ln-262"></a>  <span class="c">!! and EZspline_setup to compute the necessary cubic coefficients needed</span>
<a name="ln-263"></a>  <span class="c">!! for subsequent</span>
<a name="ln-264"></a>  <span class="c">!! field interpolations. </span>
<a name="ln-265"></a>  <span class="c">!! Only initialized if collisions (params%collisions==T) are present for</span>
<a name="ln-266"></a>  <span class="c">!! ne, Te, Zeff</span>
<a name="ln-267"></a>
<a name="ln-268"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-269"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-270"></a>  <span class="k">end if</span>
<a name="ln-271"></a><span class="k">  </span>
<a name="ln-272"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-273"></a><span class="k">     write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;* * * * INITIALIZING INITIAL CONDITIONS * * * *&quot;,/)&#39;</span><span class="p">)</span>
<a name="ln-274"></a>     <span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-275"></a>  <span class="k">end if</span>
<a name="ln-276"></a><span class="k">  call </span><span class="n">set_up_particles_ic</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<a name="ln-277"></a>  
<a name="ln-278"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-279"></a><span class="k">     write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;* * * * * * * * * * * * * * * * * * * * * * * *&quot;,/)&#39;</span><span class="p">)</span>
<a name="ln-280"></a>     <span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-281"></a>  <span class="k">end if</span>
<a name="ln-282"></a>
<a name="ln-283"></a>  <span class="c">!write(6,*) &#39;V&#39;,spp(1)%vars%V</span>
<a name="ln-284"></a>  
<a name="ln-285"></a><span class="c">!  write(output_unit_write,&#39;(&quot;post ic eta: &quot;,E17.10)&#39;) spp(1)%vars%eta</span>
<a name="ln-286"></a>  
<a name="ln-287"></a>  <span class="c">!! &lt;h4&gt;17\. Set Particle Initial Conditions&lt;/h4&gt;  </span>
<a name="ln-288"></a>  <span class="c">!!</span>
<a name="ln-289"></a>  <span class="c">!! Subroutine [[set_up_particles_ic]] in [[korc_initialize]] calls</span>
<a name="ln-290"></a>  <span class="c">!! subroutines to prescribe initial conditions or load them </span>
<a name="ln-291"></a>  <span class="c">!! from file for a restart. Initial spatial values are prescribed with </span>
<a name="ln-292"></a>  <span class="c">!! [[intitial_spatial_distribution]] in [[korc_spatial_distribution]] and </span>
<a name="ln-293"></a>  <span class="c">!! initial velocity values are prescribed with [[initial_gyro_distribution]]</span>
<a name="ln-294"></a>  <span class="c">!! in [[korc_velocity_distribution]].</span>
<a name="ln-295"></a>
<a name="ln-296"></a><span class="c">!  if (minval(spp(1)%vars%Y(:,1)).lt.1._rp/params%cpp%length) stop &#39;error with init&#39;</span>
<a name="ln-297"></a>  
<a name="ln-298"></a>  <span class="c">! * * * INITIALIZATION STAGE * * *</span>
<a name="ln-299"></a>
<a name="ln-300"></a>  
<a name="ln-301"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-302"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-303"></a>  <span class="k">end if</span>
<a name="ln-304"></a>
<a name="ln-305"></a><span class="c">!  write(output_unit_write,&#39;(&quot;GC init eta: &quot;,E17.10)&#39;) spp(1)%vars%eta</span>
<a name="ln-306"></a>
<a name="ln-307"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">params</span><span class="p">%</span><span class="n">restart</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">proceed</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">reinit</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-308"></a><span class="k">     if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;FO&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-309"></a>
<a name="ln-310"></a><span class="k">        call </span><span class="n">FO_init</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">,.</span><span class="n">true</span><span class="p">.,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-311"></a>
<a name="ln-312"></a>     <span class="k">else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-313"></a>
<a name="ln-314"></a><span class="k">        call </span><span class="n">GC_init</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>
<a name="ln-315"></a>
<a name="ln-316"></a>     <span class="k">end if</span>
<a name="ln-317"></a>
<a name="ln-318"></a><span class="k">     if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">SC_E</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-319"></a>
<a name="ln-320"></a><span class="k">        if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-321"></a><span class="k">           call </span><span class="n">init_SC_E1D</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-322"></a>        <span class="k">else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;E&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-323"></a><span class="k">           call </span><span class="n">init_SC_E1D_FS</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-324"></a>        <span class="k">end if</span>
<a name="ln-325"></a><span class="k">           </span>
<a name="ln-326"></a><span class="k">     end if</span>
<a name="ln-327"></a>
<a name="ln-328"></a><span class="k">  else</span>
<a name="ln-329"></a>
<a name="ln-330"></a><span class="k">     call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">vars</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-331"></a>
<a name="ln-332"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">SC_E</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-333"></a>
<a name="ln-334"></a>
<a name="ln-335"></a><span class="k">        if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-336"></a><span class="k">           call </span><span class="n">reinit_SC_E1D</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-337"></a>        <span class="k">else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;E&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-338"></a><span class="k">           call </span><span class="n">reinit_SC_E1D_FS</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-339"></a>        <span class="k">end if</span>
<a name="ln-340"></a>
<a name="ln-341"></a><span class="k">        </span>
<a name="ln-342"></a><span class="k">     </span>
<a name="ln-343"></a><span class="k">     end if</span>
<a name="ln-344"></a><span class="k">     </span>
<a name="ln-345"></a><span class="k">  end if</span>
<a name="ln-346"></a>
<a name="ln-347"></a>  <span class="c">!write(6,*) &#39;V&#39;,spp(1)%vars%V</span>
<a name="ln-348"></a>  <span class="c">!write(6,*) &#39;eta&#39;,spp(1)%vars%eta</span>
<a name="ln-349"></a>  
<a name="ln-350"></a><span class="c">!  write(6,*) &#39;1Y_R&#39;,spp(1)%vars%Y(1:4,1)*params%cpp%length</span>
<a name="ln-351"></a>  
<a name="ln-352"></a>  <span class="c">! * * * SAVING INITIAL CONDITION AND VARIOUS SIMULATION PARAMETERS * * * !</span>
<a name="ln-353"></a>  
<a name="ln-354"></a>  <span class="k">call </span><span class="n">save_simulation_parameters</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<a name="ln-355"></a>
<a name="ln-356"></a>  <span class="k">call </span><span class="n">save_collision_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-357"></a>  <span class="c">!! &lt;h4&gt;18\. Save Simulation and Collision Parameters&lt;/h4&gt;  </span>
<a name="ln-358"></a>  <span class="c">!!</span>
<a name="ln-359"></a>  <span class="c">!! Subroutines [[save_simulation_parameters]] in [[korc_HDF5]] and</span>
<a name="ln-360"></a>  <span class="c">!! [[save_collision_params]] in [[korc_collisions]] call</span>
<a name="ln-361"></a>  <span class="c">!! subroutines to save simulation and collision parameters.</span>
<a name="ln-362"></a>  
<a name="ln-363"></a>  
<a name="ln-364"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">params</span><span class="p">%</span><span class="n">restart</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">proceed</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">reinit</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-365"></a><span class="k">     </span>
<a name="ln-366"></a><span class="k">     call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span> <span class="c">! Save initial condition</span>
<a name="ln-367"></a>     <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-368"></a>
<a name="ln-369"></a>  <span class="k">end if</span>
<a name="ln-370"></a>  
<a name="ln-371"></a>  
<a name="ln-372"></a>  <span class="c">! * * * SAVING INITIAL CONDITION AND VARIOUS SIMULATION PARAMETERS * * * !</span>
<a name="ln-373"></a>
<a name="ln-374"></a><span class="c">!  write(output_unit_write,&#39;(&quot;pre ppusher loop eta: &quot;,E17.10)&#39;) spp(1)%vars%eta</span>
<a name="ln-375"></a>
<a name="ln-376"></a>  <span class="k">call </span><span class="n">timing_KORC</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-377"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-378"></a><span class="k">     </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-379"></a>  <span class="k">end if</span>
<a name="ln-380"></a>
<a name="ln-381"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;FO&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.((</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;ANA&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-382"></a>       <span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;UNI&#39;</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-383"></a><span class="k">     call </span><span class="n">FO_init</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">,.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-384"></a>     <span class="c">! Initial half-time particle push</span>
<a name="ln-385"></a>     
<a name="ln-386"></a>     <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-387"></a>        <span class="k">call </span><span class="n">adv_FOeqn_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>
<a name="ln-388"></a>
<a name="ln-389"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-390"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-391"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-392"></a>
<a name="ln-393"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-394"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-395"></a>     <span class="k">end do</span>
<a name="ln-396"></a><span class="k">  end if</span>
<a name="ln-397"></a>
<a name="ln-398"></a><span class="cp">#ifdef PSPLINE</span>
<a name="ln-399"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;FO&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;EXT&#39;</span> <span class="p">&amp;</span>
<a name="ln-400"></a>       <span class="p">.</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.((</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;MARS&#39;</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-401"></a>       <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">14</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;AORSA&#39;</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-402"></a><span class="k">     call </span><span class="n">FO_init</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">,.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-403"></a>     <span class="c">! Initial half-time particle push</span>
<a name="ln-404"></a>     
<a name="ln-405"></a>     <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-406"></a>        <span class="k">call </span><span class="n">adv_FOinterp_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>
<a name="ln-407"></a>        
<a name="ln-408"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-409"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-410"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-411"></a>
<a name="ln-412"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-413"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-414"></a>     <span class="k">end do</span>
<a name="ln-415"></a><span class="k">  end if</span>
<a name="ln-416"></a><span class="cp">#endif</span>
<a name="ln-417"></a>
<a name="ln-418"></a><span class="cp">#ifdef FIO</span>
<a name="ln-419"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;FO&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-420"></a>       <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-421"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;NIMROD&#39;</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-422"></a>       <span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">ReInterp_2x1t</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-423"></a><span class="k">     call </span><span class="n">FO_init</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">,.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-424"></a>     <span class="c">! Initial half-time particle push</span>
<a name="ln-425"></a>     
<a name="ln-426"></a>     <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-427"></a>        <span class="k">call </span><span class="n">adv_FOfio_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>
<a name="ln-428"></a>        
<a name="ln-429"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-430"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-431"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-432"></a>
<a name="ln-433"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-434"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-435"></a>     <span class="k">end do</span>
<a name="ln-436"></a><span class="k">  end if</span>
<a name="ln-437"></a>
<a name="ln-438"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;FO&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-439"></a>       <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-440"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;NIMROD&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-441"></a>       <span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">ReInterp_2x1t</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-442"></a><span class="k">     call </span><span class="n">FO_init</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">,.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-443"></a>     <span class="c">! Initial half-time particle push</span>
<a name="ln-444"></a>     
<a name="ln-445"></a>     <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="n">F</span><span class="p">%</span><span class="n">ind0_2x1t</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">time_slice</span>
<a name="ln-446"></a>
<a name="ln-447"></a>        <span class="c">!write(6,*) it,F%ind0_2x1t</span>
<a name="ln-448"></a>        
<a name="ln-449"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">ind0_2x1t</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-450"></a><span class="k">           if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-451"></a><span class="k">              call </span><span class="n">initialize_m3d_c1</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">spp</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-452"></a>           <span class="k">else</span>
<a name="ln-453"></a><span class="k">              call </span><span class="n">initialize_nimrod</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">spp</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-454"></a>           <span class="k">end if</span>
<a name="ln-455"></a><span class="k">           if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">collisions</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-456"></a><span class="k">              if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-457"></a><span class="k">                 call </span><span class="n">initialize_m3d_c1_imp</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-458"></a>                      <span class="n">params</span><span class="p">%</span><span class="n">num_impurity_species</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-459"></a>              <span class="k">end if</span>
<a name="ln-460"></a><span class="k">           end if</span>
<a name="ln-461"></a><span class="k">        end if</span>
<a name="ln-462"></a>
<a name="ln-463"></a><span class="k">        if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-464"></a><span class="k">           write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;tskip&#39;</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-465"></a>           <span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-466"></a>        <span class="k">end if</span>
<a name="ln-467"></a>
<a name="ln-468"></a><span class="k">        call </span><span class="n">adv_FOfio_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>
<a name="ln-469"></a>               
<a name="ln-470"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">it</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-471"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-472"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">it</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span> 
<a name="ln-473"></a>        
<a name="ln-474"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-475"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-476"></a>
<a name="ln-477"></a>        <span class="n">F</span><span class="p">%</span><span class="n">ind_2x1t</span><span class="o">=</span><span class="n">F</span><span class="p">%</span><span class="n">ind_2x1t</span><span class="o">+</span><span class="mi">1_ip</span>
<a name="ln-478"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-479"></a><span class="k">           write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;KORC time &#39;</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="nb">time</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span>
<a name="ln-480"></a><span class="nb">           flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-481"></a>        <span class="k">end if</span>
<a name="ln-482"></a><span class="k">              </span>
<a name="ln-483"></a><span class="k">     end do</span>
<a name="ln-484"></a><span class="k">     </span>
<a name="ln-485"></a><span class="k">  end if</span>
<a name="ln-486"></a><span class="cp">#endif</span>
<a name="ln-487"></a>
<a name="ln-488"></a><span class="cp">#ifdef PSPLINE</span>
<a name="ln-489"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;FO&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-490"></a>       <span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;MARS&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-491"></a><span class="k">     call </span><span class="n">FO_init</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">,.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-492"></a>     <span class="c">! Initial half-time particle push</span>
<a name="ln-493"></a>     
<a name="ln-494"></a>     <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-495"></a>        <span class="k">call </span><span class="n">adv_FOinterp_mars_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>
<a name="ln-496"></a>        
<a name="ln-497"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-498"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-499"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-500"></a>
<a name="ln-501"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-502"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-503"></a>     <span class="k">end do</span>
<a name="ln-504"></a><span class="k">  end if</span>
<a name="ln-505"></a>
<a name="ln-506"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;FO&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-507"></a>       <span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">14</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;AORSA&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-508"></a><span class="k">     call </span><span class="n">FO_init</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">spp</span><span class="p">,.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-509"></a>     <span class="c">! Initial half-time particle push</span>
<a name="ln-510"></a>
<a name="ln-511"></a>     <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-512"></a>        <span class="k">call </span><span class="n">adv_FOinterp_aorsa_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>
<a name="ln-513"></a>
<a name="ln-514"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-515"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-516"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-517"></a>
<a name="ln-518"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-519"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-520"></a>     <span class="k">end do</span>
<a name="ln-521"></a><span class="k">  end if</span>
<a name="ln-522"></a><span class="cp">#endif</span>
<a name="ln-523"></a>  
<a name="ln-524"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;eqn&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-525"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">t_it_SC</span>
<a name="ln-526"></a>        <span class="k">call </span><span class="n">adv_GCeqn_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>
<a name="ln-527"></a>        
<a name="ln-528"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-529"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">t_it_SC</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-530"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">t_it_SC</span>
<a name="ln-531"></a>
<a name="ln-532"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>        
<a name="ln-533"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-534"></a>
<a name="ln-535"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-536"></a><span class="k">           </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-537"></a>        <span class="k">end if</span>
<a name="ln-538"></a><span class="k">        </span>
<a name="ln-539"></a><span class="k">     end do</span>
<a name="ln-540"></a><span class="k">  end if</span>
<a name="ln-541"></a>
<a name="ln-542"></a><span class="cp">#ifdef PSPLINE</span>
<a name="ln-543"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-544"></a>       <span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;PSI&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-545"></a>       <span class="n">params</span><span class="p">%</span><span class="n">SC_E</span><span class="p">.</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-546"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-547"></a>        <span class="k">call </span><span class="n">adv_GCinterp_psi_top_FS</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-548"></a>        
<a name="ln-549"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-550"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-551"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-552"></a>
<a name="ln-553"></a>        
<a name="ln-554"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-555"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-556"></a>     <span class="k">end do</span>
<a name="ln-557"></a><span class="k">  end if</span>
<a name="ln-558"></a>
<a name="ln-559"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-560"></a>       <span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;PSI&#39;</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-561"></a>       <span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">12</span><span class="p">:</span><span class="mi">14</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;PSI&#39;</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-562"></a>       <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">SC_E</span><span class="p">).</span><span class="nb">and</span><span class="p">.(.</span><span class="nb">not</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">Dim2x1t</span><span class="p">).</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-563"></a><span class="k">     </span>
<a name="ln-564"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-565"></a>        <span class="k">call </span><span class="n">adv_GCinterp_psi_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-566"></a>        
<a name="ln-567"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-568"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-569"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-570"></a>        
<a name="ln-571"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-572"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-573"></a>     <span class="k">end do</span>
<a name="ln-574"></a><span class="k">  end if</span>
<a name="ln-575"></a>
<a name="ln-576"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-577"></a>       <span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;PSI&#39;</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-578"></a>       <span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">12</span><span class="p">:</span><span class="mi">14</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;PSI&#39;</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-579"></a>       <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">SC_E</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">Dim2x1t</span><span class="p">.</span><span class="nb">and</span><span class="p">.(.</span><span class="nb">not</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">ReInterp_2x1t</span><span class="p">).</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-580"></a><span class="k">     </span>
<a name="ln-581"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-582"></a>        <span class="k">call </span><span class="n">adv_GCinterp_psi2x1t_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-583"></a>
<a name="ln-584"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-585"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-586"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-587"></a>
<a name="ln-588"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-589"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-590"></a>        
<a name="ln-591"></a>     <span class="k">end do</span>
<a name="ln-592"></a><span class="k">  end if</span>
<a name="ln-593"></a><span class="k">  </span>
<a name="ln-594"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-595"></a>       <span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-596"></a>       <span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-597"></a>       <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;PSI&#39;</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-598"></a>       <span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">12</span><span class="p">:</span><span class="mi">14</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;PSI&#39;</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-599"></a>       <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">SC_E</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-600"></a>       <span class="n">F</span><span class="p">%</span><span class="n">Dim2x1t</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">ReInterp_2x1t</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-601"></a>       <span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-602"></a>
<a name="ln-603"></a><span class="k">     if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-604"></a><span class="k">        write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;initial 2x1t_ind time&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">ind_2x1t</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span>
<a name="ln-605"></a><span class="nb">        flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>  
<a name="ln-606"></a>     <span class="k">end if</span>
<a name="ln-607"></a><span class="k">        </span>
<a name="ln-608"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-609"></a>        <span class="k">call </span><span class="n">adv_GCinterp_psiwE_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-610"></a>
<a name="ln-611"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-612"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-613"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-614"></a>
<a name="ln-615"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-616"></a>
<a name="ln-617"></a>        <span class="n">F</span><span class="p">%</span><span class="n">ind_2x1t</span><span class="o">=</span><span class="n">F</span><span class="p">%</span><span class="n">ind_2x1t</span><span class="o">+</span><span class="mi">1_ip</span>
<a name="ln-618"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-619"></a><span class="k">           write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;KORC time&#39;</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="nb">time</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span>
<a name="ln-620"></a><span class="nb">           </span><span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;2x1t_ind time&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">ind_2x1t</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span>
<a name="ln-621"></a><span class="nb">        </span><span class="k">end if</span>
<a name="ln-622"></a><span class="k">        call </span><span class="n">initialize_fields_interpolant</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-623"></a>
<a name="ln-624"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">LargeCollisions</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-625"></a><span class="k">           call </span><span class="n">initialize_collision_params</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-626"></a>           <span class="k">call </span><span class="n">define_collisions_time_step</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-627"></a>        <span class="k">end if</span>
<a name="ln-628"></a>
<a name="ln-629"></a><span class="k">        call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-630"></a>        
<a name="ln-631"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-632"></a><span class="k">           </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>  
<a name="ln-633"></a>        <span class="k">end if</span>
<a name="ln-634"></a><span class="k">        </span>
<a name="ln-635"></a><span class="k">     end do</span>
<a name="ln-636"></a><span class="k">  end if</span>
<a name="ln-637"></a><span class="k">  </span>
<a name="ln-638"></a>
<a name="ln-639"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-640"></a>       <span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">dBfield</span><span class="p">.</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-641"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-642"></a>        <span class="k">call </span><span class="n">adv_GCinterp_2DBdB_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-643"></a>        
<a name="ln-644"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-645"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-646"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-647"></a>
<a name="ln-648"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-649"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-650"></a>     <span class="k">end do</span>
<a name="ln-651"></a><span class="k">  end if</span>
<a name="ln-652"></a><span class="k">  </span>
<a name="ln-653"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-654"></a>       <span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;2DB&#39;</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-655"></a>       <span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">12</span><span class="p">:</span><span class="mi">13</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;2D&#39;</span><span class="p">).</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.(</span><span class="n">F</span><span class="p">%</span><span class="n">dBfield</span><span class="p">).</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-656"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-657"></a>        <span class="k">call </span><span class="n">adv_GCinterp_B2D_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-658"></a>        
<a name="ln-659"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-660"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-661"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-662"></a>
<a name="ln-663"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-664"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-665"></a>     <span class="k">end do</span>
<a name="ln-666"></a><span class="k">  end if</span>
<a name="ln-667"></a><span class="k">  </span>
<a name="ln-668"></a>
<a name="ln-669"></a>
<a name="ln-670"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-671"></a>         <span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">F</span><span class="p">%</span><span class="n">dBfield</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-672"></a>         <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">14</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;3DBdB&#39;</span><span class="p">).</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-673"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-674"></a>        <span class="k">call </span><span class="n">adv_GCinterp_3DBdB_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-675"></a>        
<a name="ln-676"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-677"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-678"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-679"></a>
<a name="ln-680"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-681"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-682"></a>     <span class="k">end do</span>
<a name="ln-683"></a><span class="k">  end if</span>
<a name="ln-684"></a>
<a name="ln-685"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-686"></a>         <span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">F</span><span class="p">%</span><span class="n">dBfield</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-687"></a>         <span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">14</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;3DBdB&#39;</span><span class="p">).</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-688"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-689"></a>        <span class="k">call </span><span class="n">adv_GCinterp_3DBdB1_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-690"></a>        
<a name="ln-691"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-692"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-693"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-694"></a>
<a name="ln-695"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-696"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-697"></a>     <span class="k">end do</span>
<a name="ln-698"></a><span class="k">  end if</span>
<a name="ln-699"></a>
<a name="ln-700"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-701"></a>       <span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">).</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.(</span><span class="n">F</span><span class="p">%</span><span class="n">dBfield</span><span class="p">).</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-702"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-703"></a>        <span class="k">call </span><span class="n">adv_GCinterp_B_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-704"></a>        
<a name="ln-705"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-706"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-707"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-708"></a>
<a name="ln-709"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-710"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-711"></a>     <span class="k">end do</span>
<a name="ln-712"></a><span class="k">  end if</span>
<a name="ln-713"></a><span class="cp">#endif</span>
<a name="ln-714"></a>
<a name="ln-715"></a><span class="cp">#ifdef FIO</span>
<a name="ln-716"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-717"></a>       <span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">ReInterp_2x1t</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-718"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">ito</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_steps</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-719"></a>        <span class="k">call </span><span class="n">adv_GCinterp_fio_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-720"></a>        
<a name="ln-721"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-722"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">t_it_SC</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>        
<a name="ln-723"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span><span class="o">-</span><span class="mi">1_ip</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">t_it_SC</span>
<a name="ln-724"></a>
<a name="ln-725"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-726"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-727"></a>
<a name="ln-728"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-729"></a><span class="k">           </span><span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-730"></a>        <span class="k">end if</span>
<a name="ln-731"></a><span class="k">        </span>
<a name="ln-732"></a><span class="k">     end do</span>
<a name="ln-733"></a><span class="k">     </span>
<a name="ln-734"></a><span class="k">  end if</span>
<a name="ln-735"></a>
<a name="ln-736"></a><span class="k">  if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;GC&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;M3D_C1&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-737"></a>       <span class="n">F</span><span class="p">%</span><span class="n">ReInterp_2x1t</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-738"></a>
<a name="ln-739"></a><span class="k">     do </span><span class="n">it</span><span class="o">=</span><span class="n">F</span><span class="p">%</span><span class="n">ind0_2x1t</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">time_slice</span>
<a name="ln-740"></a>
<a name="ln-741"></a><span class="c">!        write(6,*) it,F%ind0_2x1t</span>
<a name="ln-742"></a>        
<a name="ln-743"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">ind0_2x1t</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-744"></a><span class="k">           call </span><span class="n">initialize_m3d_c1</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">spp</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-745"></a>           <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">collisions</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">radiation</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-746"></a><span class="k">              call </span><span class="n">initialize_m3d_c1_imp</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-747"></a>                   <span class="n">params</span><span class="p">%</span><span class="n">num_impurity_species</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-748"></a>           <span class="k">end if</span>
<a name="ln-749"></a><span class="k">        end if</span>
<a name="ln-750"></a><span class="k">        </span>
<a name="ln-751"></a><span class="k">        if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-752"></a><span class="k">           write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;tskip&#39;</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-753"></a>           <span class="nb">flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-754"></a>        <span class="k">end if</span>
<a name="ln-755"></a><span class="k">           </span>
<a name="ln-756"></a><span class="k">        call </span><span class="n">adv_GCinterp_fio_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-757"></a>               
<a name="ln-758"></a>        <span class="n">params</span><span class="p">%</span><span class="n">it</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">it</span><span class="o">+</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>
<a name="ln-759"></a>        <span class="n">params</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">init_time</span> <span class="p">&amp;</span>
<a name="ln-760"></a>             <span class="o">+</span><span class="kt">REAL</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">it</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span> 
<a name="ln-761"></a>        
<a name="ln-762"></a>        <span class="k">call </span><span class="n">save_simulation_outputs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-763"></a>        <span class="k">call </span><span class="n">save_restart_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<a name="ln-764"></a>
<a name="ln-765"></a>        <span class="c">!comment out for debugging only</span>
<a name="ln-766"></a>        <span class="n">F</span><span class="p">%</span><span class="n">ind_2x1t</span><span class="o">=</span><span class="n">F</span><span class="p">%</span><span class="n">ind_2x1t</span><span class="o">+</span><span class="mi">1_ip</span>
<a name="ln-767"></a>
<a name="ln-768"></a>
<a name="ln-769"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-770"></a><span class="k">           write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;KORC time &#39;</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="nb">time</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span>
<a name="ln-771"></a><span class="nb">           flush</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-772"></a>        <span class="k">end if</span>
<a name="ln-773"></a><span class="k">              </span>
<a name="ln-774"></a><span class="k">     end do</span>
<a name="ln-775"></a><span class="k">  end if</span>
<a name="ln-776"></a><span class="cp">#endif</span>
<a name="ln-777"></a>  
<a name="ln-778"></a>  <span class="k">call </span><span class="n">timing_KORC</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-779"></a>
<a name="ln-780"></a>  <span class="c">! * * * FINALIZING SIMULATION * * * </span>
<a name="ln-781"></a>  <span class="k">call </span><span class="n">finalize_HDF5</span><span class="p">()</span>
<a name="ln-782"></a>
<a name="ln-783"></a><span class="cp">#ifdef PSPLINE</span>
<a name="ln-784"></a>  <span class="k">call </span><span class="n">finalize_interpolants</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-785"></a><span class="cp">#endif</span>
<a name="ln-786"></a>  
<a name="ln-787"></a><span class="cp">#ifdef FIO</span>
<a name="ln-788"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="s1">&#39;M3D_C1&#39;</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-789"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="s1">&#39;NIMROD&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-790"></a><span class="k">     call </span><span class="n">finalize_FIO</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<a name="ln-791"></a>  <span class="k">end if</span>
<a name="ln-792"></a><span class="cp">#endif</span>
<a name="ln-793"></a>  
<a name="ln-794"></a>  <span class="c">! DEALLOCATION OF VARIABLES</span>
<a name="ln-795"></a>  <span class="k">call </span><span class="n">deallocate_variables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>
<a name="ln-796"></a>
<a name="ln-797"></a>  
<a name="ln-798"></a>  <span class="k">call </span><span class="n">deallocate_collisions_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-799"></a>
<a name="ln-800"></a>  
<a name="ln-801"></a>  <span class="k">call </span><span class="n">finalize_communications</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-802"></a>  <span class="c">! * * * FINALIZING SIMULATION * * *</span>
<a name="ln-803"></a>
<a name="ln-804"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-805"></a><span class="k">     write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;KORC ran successfully!&quot;)&#39;</span><span class="p">)</span>
<a name="ln-806"></a>     <span class="k">close</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">)</span>
<a name="ln-807"></a>  <span class="k">end if</span>
<a name="ln-808"></a><span class="k">  </span>
<a name="ln-809"></a><span class="k">end program </span><span class="n">main</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2022 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> KORC was developed by Matt Beidler</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>