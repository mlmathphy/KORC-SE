<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Kinetic Orbit Runaway electrons Code (KORC)">
    
    <meta name="author" content="Matt Beidler" >
    <link rel="icon" href="../favicon.png">

    <title>include_CoulombCollisionsLA_GC_p &ndash; KORC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">KORC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>README</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>include_CoulombCollisionsLA_GC_p
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.8% of total for procedures.">209 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/korc_collisions.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/korc_collisions.f90.html'>korc_collisions.f90</a></li>
    
     <li><a href='../module/korc_collisions.html'>korc_collisions</a></li>
    
  
     <li class="active">include_CoulombCollisionsLA_GC_p</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/include_coulombcollisionsla_gc_p.html#src">include_CoulombCollisionsLA_GC_p</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine include_CoulombCollisionsLA_GC_p(spp, achunk, tt, params, Y_R, Y_PHI, Y_Z, Ppll, Pmu, me, flagCon, flagCol, F, P, E_PHI, ne, Te, PSIp)
    
    
   
</h2>
    
  


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-spp~8"></span>type(SPECIES),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>spp</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-achunk"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>achunk</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tt~4"></span>integer(kind=ip),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>tt</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-params~37"></span>type(KORC_PARAMS),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>params</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-y_r~2"></span>real(kind=rp),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>Y_R</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-y_phi~2"></span>real(kind=rp),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>Y_PHI</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-y_z~2"></span>real(kind=rp),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>Y_Z</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ppll~2"></span>real(kind=rp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>Ppll</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pmu~2"></span>real(kind=rp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>Pmu</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-me~5"></span>real(kind=rp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>me</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flagcon~5"></span>integer(kind=is),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>flagCon</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flagcol~5"></span>integer(kind=is),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>flagCol</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f~10"></span>type(FIELDS),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>F</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-p~8"></span>type(PROFILES),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>P</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-e_phi~2"></span>real(kind=rp),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>E_PHI</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ne~27"></span>real(kind=rp),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>ne</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-te~29"></span>real(kind=rp),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>Te</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-psip~5"></span>real(kind=rp),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(achunk)</td><td>::</td>
  <td><strong>PSIp</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~include_coulombcollisionsla_gc_p~~CallsGraph Pages: 1 -->
<svg id="procinclude_coulombcollisionsla_gc_pCallsGraph" width="641pt" height="822pt"
 viewBox="0.00 0.00 641.00 822.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph" class="graph" transform="scale(.8013 .8013) rotate(0) translate(4 1022)">
<title>proc~~include_coulombcollisionsla_gc_p~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1022 796,-1022 796,4 -4,4"/>
<!-- proc~include_coulombcollisionsla_gc_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node1" class="node">
<title>proc~include_coulombcollisionsla_gc_p</title>
<polygon fill="none" stroke="#000000" points="185,-598 0,-598 0,-574 185,-574 185,-598"/>
<text text-anchor="middle" x="92.5" y="-583.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">include_CoulombCollisionsLA_GC_p</text>
</g>
<!-- proc~calculate_gcfieldswe_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node2" class="node">
<title>proc~calculate_gcfieldswe_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node2"><a xlink:href=".././proc/calculate_gcfieldswe_p.html" xlink:title="calculate_GCfieldswE_p">
<polygon fill="#d9534f" stroke="#d9534f" points="352.5,-724 226.5,-724 226.5,-700 352.5,-700 352.5,-724"/>
<text text-anchor="middle" x="289.5" y="-709.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calculate_GCfieldswE_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~calculate_gcfieldswe_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge1" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~calculate_gcfieldswe_p</title>
<path fill="none" stroke="#000000" d="M104.0952,-598.1894C125.3305,-619.8465 172.7357,-665.1768 221,-691 224.5387,-692.8934 228.2736,-694.643 232.0989,-696.2552"/>
<polygon fill="#000000" stroke="#000000" points="231.1446,-699.6387 241.7339,-699.9828 233.6704,-693.1103 231.1446,-699.6387"/>
</g>
<!-- proc~dca_sd -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node3" class="node">
<title>proc~dca_sd</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node3"><a xlink:href=".././proc/dca_sd.html" xlink:title="dCA_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="316.5,-598 262.5,-598 262.5,-574 316.5,-574 316.5,-598"/>
<text text-anchor="middle" x="289.5" y="-583.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dCA_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~dca_sd -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge2" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~dca_sd</title>
<path fill="none" stroke="#000000" d="M185.2315,-586C208.9768,-586 233.1706,-586 252.268,-586"/>
<polygon fill="#000000" stroke="#000000" points="252.3181,-589.5001 262.3181,-586 252.318,-582.5001 252.3181,-589.5001"/>
</g>
<!-- proc~interp_fields_3d_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node4" class="node">
<title>proc~interp_fields_3d_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node4"><a xlink:href=".././proc/interp_fields_3d_p.html" xlink:title="interp_fields_3D_p">
<polygon fill="#d9534f" stroke="#d9534f" points="339.5,-892 239.5,-892 239.5,-868 339.5,-868 339.5,-892"/>
<text text-anchor="middle" x="289.5" y="-877.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_fields_3D_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~interp_fields_3d_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge3" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~interp_fields_3d_p</title>
<path fill="none" stroke="#000000" d="M94.613,-598.1872C102.6493,-640.8234 135.3025,-784.7171 221,-859 223.8462,-861.4671 226.9774,-863.6443 230.2865,-865.5658"/>
<polygon fill="#000000" stroke="#000000" points="228.8736,-868.7718 239.3876,-870.0781 231.983,-862.5003 228.8736,-868.7718"/>
</g>
<!-- proc~get_random -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node5" class="node">
<title>proc~get_random</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node5"><a xlink:href=".././proc/get_random.html" xlink:title="get_random">
<polygon fill="#d94e8f" stroke="#d94e8f" points="507,-66 438,-66 438,-42 507,-42 507,-66"/>
<text text-anchor="middle" x="472.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_random</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~get_random -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge4" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~get_random</title>
<path fill="none" stroke="#000000" d="M94.651,-573.8313C105.9119,-511.3952 159.8889,-227.554 221,-166 265.9626,-120.7114 305.3324,-159.0391 358,-123 379.1376,-108.5361 372.8089,-92.3853 394,-78 404.1329,-71.1214 416.3089,-66.1564 428.0144,-62.5955"/>
<polygon fill="#000000" stroke="#000000" points="428.9752,-65.9612 437.6812,-59.9233 427.1101,-59.2142 428.9752,-65.9612"/>
</g>
<!-- proc~calculate_gcfields_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node6" class="node">
<title>proc~calculate_gcfields_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node6"><a xlink:href=".././proc/calculate_gcfields_p.html" xlink:title="calculate_GCfields_p">
<polygon fill="#d9534f" stroke="#d9534f" points="345.5,-682 233.5,-682 233.5,-658 345.5,-658 345.5,-682"/>
<text text-anchor="middle" x="289.5" y="-667.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calculate_GCfields_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~calculate_gcfields_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge5" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~calculate_gcfields_p</title>
<path fill="none" stroke="#000000" d="M114.304,-598.0153C139.4885,-611.5787 182.4159,-633.7385 221,-649 226.0604,-651.0016 231.3919,-652.9324 236.7539,-654.7581"/>
<polygon fill="#000000" stroke="#000000" points="235.7936,-658.1266 246.3865,-657.9235 237.979,-651.4765 235.7936,-658.1266"/>
</g>
<!-- korc_abort -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node7" class="node">
<title>korc_abort</title>
<polygon fill="#777777" stroke="#777777" points="503.5,-24 441.5,-24 441.5,0 503.5,0 503.5,-24"/>
<text text-anchor="middle" x="472.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_abort</text>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;korc_abort -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge7" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;korc_abort</title>
<path fill="none" stroke="#000000" d="M94.1944,-573.8505C103.6867,-507.4862 152.3098,-189.3703 221,-123 266.0405,-79.4808 307.0967,-126.4886 358,-90 382.3526,-72.5435 369.8677,-50.7598 394,-33 404.7588,-25.0822 418.2981,-20.1487 431.0891,-17.075"/>
<polygon fill="#000000" stroke="#000000" points="432.0426,-20.4516 441.1195,-14.9872 430.6161,-13.5985 432.0426,-20.4516"/>
</g>
<!-- proc~analytical_profiles_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node8" class="node">
<title>proc~analytical_profiles_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node8"><a xlink:href=".././proc/analytical_profiles_p.html" xlink:title="analytical_profiles_p">
<polygon fill="#d9534f" stroke="#d9534f" points="343.5,-81 235.5,-81 235.5,-57 343.5,-57 343.5,-81"/>
<text text-anchor="middle" x="289.5" y="-66.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">analytical_profiles_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~analytical_profiles_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge6" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~analytical_profiles_p</title>
<path fill="none" stroke="#000000" d="M94.1733,-573.7231C103.7357,-505.1798 153.4217,-170.2101 221,-95 224.0473,-91.6085 227.5842,-88.6571 231.4137,-86.0889"/>
<polygon fill="#000000" stroke="#000000" points="233.2549,-89.0678 240.1886,-81.0569 229.7726,-82.9954 233.2549,-89.0678"/>
</g>
<!-- proc~interp_hcollision_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node9" class="node">
<title>proc~interp_hcollision_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node9"><a xlink:href=".././proc/interp_hcollision_p.html" xlink:title="interp_Hcollision_p">
<polygon fill="#d9534f" stroke="#d9534f" points="340,-1018 239,-1018 239,-994 340,-994 340,-1018"/>
<text text-anchor="middle" x="289.5" y="-1003.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_Hcollision_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~interp_hcollision_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge8" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~interp_hcollision_p</title>
<path fill="none" stroke="#000000" d="M94.8879,-598.3686C106.8834,-659.3225 162.313,-927.1343 221,-985 223.6821,-987.6445 226.6881,-989.9573 229.9038,-991.9797"/>
<polygon fill="#000000" stroke="#000000" points="228.3493,-995.1167 238.8277,-996.6837 231.6135,-988.9244 228.3493,-995.1167"/>
</g>
<!-- proc~cb_ei_sd -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node10" class="node">
<title>proc~cb_ei_sd</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node10"><a xlink:href=".././proc/cb_ei_sd.html" xlink:title="CB_ei_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="320.5,-241 258.5,-241 258.5,-217 320.5,-217 320.5,-241"/>
<text text-anchor="middle" x="289.5" y="-226.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ei_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~cb_ei_sd -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge9" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~cb_ei_sd</title>
<path fill="none" stroke="#000000" d="M95.5369,-573.8643C106.6411,-531.1929 148.238,-385.3299 221,-287 232.4372,-271.5439 248.7629,-257.5128 262.6076,-247.1238"/>
<polygon fill="#000000" stroke="#000000" points="264.8056,-249.8531 270.8413,-241.1456 260.6929,-244.1887 264.8056,-249.8531"/>
</g>
<!-- proc~interp_fields_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node11" class="node">
<title>proc~interp_fields_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node11"><a xlink:href=".././proc/interp_fields_p.html" xlink:title="interp_fields_p">
<polygon fill="#d9534f" stroke="#d9534f" points="330,-850 249,-850 249,-826 330,-826 330,-850"/>
<text text-anchor="middle" x="289.5" y="-835.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_fields_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~interp_fields_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge10" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~interp_fields_p</title>
<path fill="none" stroke="#000000" d="M95.7267,-598.1582C106.5153,-636.4283 145.012,-755.5125 221,-817 226.3923,-821.3633 232.6858,-824.8221 239.232,-827.5635"/>
<polygon fill="#000000" stroke="#000000" points="238.3341,-830.9611 248.9282,-831.0883 240.7257,-824.3823 238.3341,-830.9611"/>
</g>
<!-- proc~calculate_gcfields_p_fs -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node12" class="node">
<title>proc~calculate_gcfields_p_fs</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node12"><a xlink:href=".././proc/calculate_gcfields_p_fs.html" xlink:title="calculate_GCfields_p_FS">
<polygon fill="#d9534f" stroke="#d9534f" points="355,-808 224,-808 224,-784 355,-784 355,-808"/>
<text text-anchor="middle" x="289.5" y="-793.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calculate_GCfields_p_FS</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~calculate_gcfields_p_fs -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge11" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~calculate_gcfields_p_fs</title>
<path fill="none" stroke="#000000" d="M97.354,-598.2746C111.2645,-631.8578 154.5856,-726.0061 221,-775 223.102,-776.5507 225.3202,-777.9883 227.6212,-779.3209"/>
<polygon fill="#000000" stroke="#000000" points="226.3309,-782.5897 236.837,-783.9576 229.477,-776.3365 226.3309,-782.5897"/>
</g>
<!-- proc~large_angle_source -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node13" class="node">
<title>proc~large_angle_source</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node13"><a xlink:href=".././proc/large_angle_source.html" xlink:title="large_angle_source">
<polygon fill="#d9534f" stroke="#d9534f" points="342,-199 237,-199 237,-175 342,-175 342,-199"/>
<text text-anchor="middle" x="289.5" y="-184.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">large_angle_source</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~large_angle_source -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge12" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~large_angle_source</title>
<path fill="none" stroke="#000000" d="M92.8392,-573.7922C94.9616,-521.6496 110.3133,-315.3914 221,-208 223.1342,-205.9293 225.4671,-204.0623 227.9431,-202.3789"/>
<polygon fill="#000000" stroke="#000000" points="229.8625,-205.314 236.8314,-197.3337 226.407,-199.2263 229.8625,-205.314"/>
</g>
<!-- proc~interp_focollision_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node14" class="node">
<title>proc~interp_focollision_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node14"><a xlink:href=".././proc/interp_focollision_p.html" xlink:title="interp_FOcollision_p">
<polygon fill="#d9534f" stroke="#d9534f" points="343.5,-976 235.5,-976 235.5,-952 343.5,-952 343.5,-976"/>
<text text-anchor="middle" x="289.5" y="-961.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_FOcollision_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~interp_focollision_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge13" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~interp_focollision_p</title>
<path fill="none" stroke="#000000" d="M93.1176,-598.219C96.3333,-648.6068 115.3808,-842.336 221,-943 222.6826,-944.6037 224.4847,-946.0852 226.3796,-947.4537"/>
<polygon fill="#000000" stroke="#000000" points="224.8283,-950.6049 235.2017,-952.7596 228.4361,-944.6062 224.8283,-950.6049"/>
</g>
<!-- proc~analytical_fields_gc_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node15" class="node">
<title>proc~analytical_fields_gc_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node15"><a xlink:href=".././proc/analytical_fields_gc_p.html" xlink:title="analytical_fields_GC_p">
<polygon fill="#d9534f" stroke="#d9534f" points="349.5,-39 229.5,-39 229.5,-15 349.5,-15 349.5,-39"/>
<text text-anchor="middle" x="289.5" y="-24.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">analytical_fields_GC_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~analytical_fields_gc_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge14" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~analytical_fields_gc_p</title>
<path fill="none" stroke="#000000" d="M93.765,-573.9232C101.5443,-501.8457 145.0812,-128.8604 221,-48 222.0376,-46.8948 223.1317,-45.8473 224.2746,-44.8544"/>
<polygon fill="#000000" stroke="#000000" points="226.3093,-47.7022 232.4425,-39.063 222.2605,-41.9919 226.3093,-47.7022"/>
</g>
<!-- proc~calculate_2dbdbfields_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node16" class="node">
<title>proc~calculate_2dbdbfields_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node16"><a xlink:href=".././proc/calculate_2dbdbfields_p.html" xlink:title="calculate_2DBdBfields_p">
<polygon fill="#d9534f" stroke="#d9534f" points="354,-934 225,-934 225,-910 354,-910 354,-934"/>
<text text-anchor="middle" x="289.5" y="-919.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calculate_2DBdBfields_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~calculate_2dbdbfields_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge15" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~calculate_2dbdbfields_p</title>
<path fill="none" stroke="#000000" d="M93.7557,-598.0506C99.242,-644.4805 125.3039,-813.5384 221,-901 222.3256,-902.2115 223.7195,-903.3532 225.1699,-904.429"/>
<polygon fill="#000000" stroke="#000000" points="223.6651,-907.6137 234.0106,-909.8988 227.3481,-901.6609 223.6651,-907.6137"/>
</g>
<!-- proc~cb_ei_sd_fio -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node17" class="node">
<title>proc~cb_ei_sd_fio</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node17"><a xlink:href=".././proc/cb_ei_sd_fio.html" xlink:title="CB_ei_SD_FIO">
<polygon fill="#d94e8f" stroke="#d94e8f" points="332,-320 247,-320 247,-296 332,-296 332,-320"/>
<text text-anchor="middle" x="289.5" y="-305.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ei_SD_FIO</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~cb_ei_sd_fio -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge16" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~cb_ei_sd_fio</title>
<path fill="none" stroke="#000000" d="M101.219,-573.696C132.1142,-530.0977 236.577,-382.6832 275.0873,-328.3387"/>
<polygon fill="#000000" stroke="#000000" points="277.9555,-330.3447 280.8817,-320.1619 272.2441,-326.2974 277.9555,-330.3447"/>
</g>
<!-- proc~cf_sd_fio -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node18" class="node">
<title>proc~cf_sd_fio</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node18"><a xlink:href=".././proc/cf_sd_fio.html" xlink:title="CF_SD_FIO">
<polygon fill="#d94e8f" stroke="#d94e8f" points="324.5,-514 254.5,-514 254.5,-490 324.5,-490 324.5,-514"/>
<text text-anchor="middle" x="289.5" y="-499.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CF_SD_FIO</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~cf_sd_fio -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge17" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~cf_sd_fio</title>
<path fill="none" stroke="#000000" d="M114.304,-573.9847C139.4885,-560.4213 182.4159,-538.2615 221,-523 228.5654,-520.0076 236.7364,-517.1735 244.7097,-514.6121"/>
<polygon fill="#000000" stroke="#000000" points="245.7764,-517.9458 254.2834,-511.6307 243.695,-511.2623 245.7764,-517.9458"/>
</g>
<!-- proc~ca_sd -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node19" class="node">
<title>proc~ca_sd</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node19"><a xlink:href=".././proc/ca_sd.html" xlink:title="CA_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="316.5,-556 262.5,-556 262.5,-532 316.5,-532 316.5,-556"/>
<text text-anchor="middle" x="289.5" y="-541.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CA_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~ca_sd -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge18" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~ca_sd</title>
<path fill="none" stroke="#000000" d="M148.9523,-573.9645C182.0649,-566.9049 222.9821,-558.1815 252.1114,-551.9712"/>
<polygon fill="#000000" stroke="#000000" points="253.2233,-555.3129 262.2737,-549.8046 251.7636,-548.4667 253.2233,-555.3129"/>
</g>
<!-- proc~calculate_gcfields_2x1t_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node20" class="node">
<title>proc~calculate_gcfields_2x1t_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node20"><a xlink:href=".././proc/calculate_gcfields_2x1t_p.html" xlink:title="calculate_GCfields_2x1t_p">
<polygon fill="#d9534f" stroke="#d9534f" points="358,-766 221,-766 221,-742 358,-742 358,-766"/>
<text text-anchor="middle" x="289.5" y="-751.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calculate_GCfields_2x1t_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~calculate_gcfields_2x1t_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge19" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~calculate_gcfields_2x1t_p</title>
<path fill="none" stroke="#000000" d="M99.8276,-598.3095C117.2148,-626.4586 163.8219,-695.9492 221,-733 223.6292,-734.7037 226.4042,-736.2755 229.2708,-737.7247"/>
<polygon fill="#000000" stroke="#000000" points="228.1154,-741.0426 238.6714,-741.9481 230.984,-734.6574 228.1154,-741.0426"/>
</g>
<!-- proc~cf_sd -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node21" class="node">
<title>proc~cf_sd</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node21"><a xlink:href=".././proc/cf_sd.html" xlink:title="CF_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="316.5,-463 262.5,-463 262.5,-439 316.5,-439 316.5,-463"/>
<text text-anchor="middle" x="289.5" y="-448.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CF_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~cf_sd -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge20" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~cf_sd</title>
<path fill="none" stroke="#000000" d="M105.1029,-573.6924C127.153,-552.6409 174.7956,-509.261 221,-481 230.9211,-474.9317 242.2863,-469.437 252.8702,-464.8574"/>
<polygon fill="#000000" stroke="#000000" points="254.4264,-468.0006 262.3066,-460.9188 251.7301,-461.5407 254.4264,-468.0006"/>
</g>
<!-- proc~cb_ee_sd -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node22" class="node">
<title>proc~cb_ee_sd</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node22"><a xlink:href=".././proc/cb_ee_sd.html" xlink:title="CB_ee_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="322,-640 257,-640 257,-616 322,-616 322,-640"/>
<text text-anchor="middle" x="289.5" y="-625.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ee_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~cb_ee_sd -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge21" class="edge">
<title>proc~include_coulombcollisionsla_gc_p&#45;&gt;proc~cb_ee_sd</title>
<path fill="none" stroke="#000000" d="M148.9523,-598.0355C180.0397,-604.6633 218.0061,-612.7577 246.6388,-618.8621"/>
<polygon fill="#000000" stroke="#000000" points="246.2253,-622.3525 256.7353,-621.0146 247.685,-615.5064 246.2253,-622.3525"/>
</g>
<!-- ezspline_error -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node23" class="node">
<title>ezspline_error</title>
<polygon fill="#777777" stroke="#777777" points="512,-892 433,-892 433,-868 512,-868 512,-892"/>
<text text-anchor="middle" x="472.5" y="-877.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_error</text>
</g>
<!-- proc~calculate_gcfieldswe_p&#45;&gt;ezspline_error -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge23" class="edge">
<title>proc~calculate_gcfieldswe_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M346.064,-724.0365C350.4479,-726.4937 354.5157,-729.4482 358,-733 398.7858,-774.5754 352.4709,-818.167 394,-859 401.8559,-866.7242 412.2239,-871.6901 422.8403,-874.8616"/>
<polygon fill="#000000" stroke="#000000" points="422.0449,-878.2704 432.595,-877.2975 423.7409,-871.479 422.0449,-878.2704"/>
</g>
<!-- proc~check_if_in_fields_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node29" class="node">
<title>proc~check_if_in_fields_domain_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node29"><a xlink:href=".././proc/check_if_in_fields_domain_p.html" xlink:title="check_if_in_fields_domain_p">
<polygon fill="#d9534f" stroke="#d9534f" points="546,-850 399,-850 399,-826 546,-826 546,-850"/>
<text text-anchor="middle" x="472.5" y="-835.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_if_in_fields_domain_p</text>
</a>
</g>
</g>
<!-- proc~calculate_gcfieldswe_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge22" class="edge">
<title>proc~calculate_gcfieldswe_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M344.9249,-724.1724C349.6575,-726.5991 354.1129,-729.5095 358,-733 388.2213,-760.1376 363.2941,-790.4119 394,-817 395.5198,-818.316 397.1136,-819.5505 398.7685,-820.7086"/>
<polygon fill="#000000" stroke="#000000" points="397.1061,-823.7919 407.4921,-825.885 400.6782,-817.7719 397.1061,-823.7919"/>
</g>
<!-- ezspline_derivative -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node35" class="node">
<title>ezspline_derivative</title>
<polygon fill="#777777" stroke="#777777" points="523.5,-808 421.5,-808 421.5,-784 523.5,-784 523.5,-808"/>
<text text-anchor="middle" x="472.5" y="-793.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_derivative</text>
</g>
<!-- proc~calculate_gcfieldswe_p&#45;&gt;ezspline_derivative -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge24" class="edge">
<title>proc~calculate_gcfieldswe_p&#45;&gt;ezspline_derivative</title>
<path fill="none" stroke="#000000" d="M339.435,-724.0517C345.9058,-726.5406 352.2677,-729.499 358,-733 377.5807,-744.9589 374.5542,-757.8229 394,-770 400.274,-773.9288 407.2052,-777.3298 414.2744,-780.2561"/>
<polygon fill="#000000" stroke="#000000" points="413.3605,-783.6538 423.951,-783.9573 415.8613,-777.1157 413.3605,-783.6538"/>
</g>
<!-- proc~psi -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node24" class="node">
<title>proc~psi</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node24"><a xlink:href=".././proc/psi.html" xlink:title="psi">
<polygon fill="#d94e8f" stroke="#d94e8f" points="499.5,-614 445.5,-614 445.5,-590 499.5,-590 499.5,-614"/>
<text text-anchor="middle" x="472.5" y="-599.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psi</text>
</a>
</g>
</g>
<!-- proc~dca_sd&#45;&gt;proc~psi -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge27" class="edge">
<title>proc~dca_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M316.5023,-588.3609C347.8578,-591.1023 399.7733,-595.6414 435.0235,-598.7234"/>
<polygon fill="#000000" stroke="#000000" points="435.1201,-602.2451 445.3869,-599.6295 435.7298,-595.2717 435.1201,-602.2451"/>
</g>
<!-- proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node25" class="node">
<title>proc~vte</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node25"><a xlink:href=".././proc/vte.html" xlink:title="VTe">
<polygon fill="#d94e8f" stroke="#d94e8f" points="792,-494 738,-494 738,-470 792,-470 792,-494"/>
<text text-anchor="middle" x="765" y="-479.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VTe</text>
</a>
</g>
</g>
<!-- proc~dca_sd&#45;&gt;proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge26" class="edge">
<title>proc~dca_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M316.6339,-590.7672C329.8411,-593.9434 345.52,-599.0407 358,-607 378.1655,-619.8609 372.1513,-637.2694 394,-647 457.742,-675.3883 482.4289,-659.9207 551,-647 621.8061,-633.6582 647.0552,-634.6109 702,-588 729.019,-565.0792 747.4345,-527.4896 757.0776,-503.7789"/>
<polygon fill="#000000" stroke="#000000" points="760.4181,-504.8455 760.7817,-494.257 753.8943,-502.3077 760.4181,-504.8455"/>
</g>
<!-- proc~gammacee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node30" class="node">
<title>proc~gammacee</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node30"><a xlink:href=".././proc/gammacee.html" xlink:title="Gammacee">
<polygon fill="#d94e8f" stroke="#d94e8f" points="506,-496 439,-496 439,-472 506,-472 506,-496"/>
<text text-anchor="middle" x="472.5" y="-481.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Gammacee</text>
</a>
</g>
</g>
<!-- proc~dca_sd&#45;&gt;proc~gammacee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge25" class="edge">
<title>proc~dca_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M316.6011,-579.8247C329.5069,-576.3541 344.9375,-571.4163 358,-565 392.8833,-547.8654 428.7774,-520.6104 450.862,-502.5152"/>
<polygon fill="#000000" stroke="#000000" points="453.1652,-505.152 458.6191,-496.0688 448.6912,-499.7684 453.1652,-505.152"/>
</g>
<!-- proc~interp_fields_3d_p&#45;&gt;ezspline_error -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge30" class="edge">
<title>proc~interp_fields_3d_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M339.5056,-880C365.3627,-880 396.8286,-880 422.6615,-880"/>
<polygon fill="#000000" stroke="#000000" points="422.9889,-883.5001 432.9889,-880 422.9889,-876.5001 422.9889,-883.5001"/>
</g>
<!-- ezspline_interp -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node26" class="node">
<title>ezspline_interp</title>
<polygon fill="#777777" stroke="#777777" points="514,-934 431,-934 431,-910 514,-910 514,-934"/>
<text text-anchor="middle" x="472.5" y="-919.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_interp</text>
</g>
<!-- proc~interp_fields_3d_p&#45;&gt;ezspline_interp -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge28" class="edge">
<title>proc~interp_fields_3d_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M339.5056,-891.4767C364.8236,-897.2874 395.5191,-904.3322 421.0386,-910.1892"/>
<polygon fill="#000000" stroke="#000000" points="420.3734,-913.6274 430.903,-912.4531 421.9393,-906.8048 420.3734,-913.6274"/>
</g>
<!-- proc~interp_fields_3d_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge29" class="edge">
<title>proc~interp_fields_3d_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M339.5056,-868.5233C361.2611,-863.5302 386.9872,-857.6259 409.9879,-852.347"/>
<polygon fill="#000000" stroke="#000000" points="411.0346,-855.6979 419.9983,-850.0496 409.4687,-848.8753 411.0346,-855.6979"/>
</g>
<!-- omp_get_thread_num -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node31" class="node">
<title>omp_get_thread_num</title>
<polygon fill="#777777" stroke="#777777" points="702,-66 587,-66 587,-42 702,-42 702,-66"/>
<text text-anchor="middle" x="644.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">omp_get_thread_num</text>
</g>
<!-- proc~get_random&#45;&gt;omp_get_thread_num -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge31" class="edge">
<title>proc~get_random&#45;&gt;omp_get_thread_num</title>
<path fill="none" stroke="#000000" d="M507.3068,-54C527.2336,-54 552.9259,-54 576.6792,-54"/>
<polygon fill="#000000" stroke="#000000" points="576.7181,-57.5001 586.7181,-54 576.718,-50.5001 576.7181,-57.5001"/>
</g>
<!-- interface~random_get_number -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node37" class="node">
<title>interface~random_get_number</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node37"><a xlink:href=".././interface/random_get_number.html" xlink:title="random_get_number">
<polygon fill="#a7506f" stroke="#a7506f" points="699.5,-24 589.5,-24 589.5,0 699.5,0 699.5,-24"/>
<text text-anchor="middle" x="644.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">random_get_number</text>
</a>
</g>
</g>
<!-- proc~get_random&#45;&gt;interface~random_get_number -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge32" class="edge">
<title>proc~get_random&#45;&gt;interface~random_get_number</title>
<path fill="none" stroke="#000000" d="M507.3068,-45.5007C529.6766,-40.0383 559.312,-32.8017 585.3137,-26.4525"/>
<polygon fill="#000000" stroke="#000000" points="586.1942,-29.8404 595.0785,-24.068 584.5336,-23.0402 586.1942,-29.8404"/>
</g>
<!-- proc~calculate_gcfields_p&#45;&gt;ezspline_error -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge34" class="edge">
<title>proc~calculate_gcfields_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M345.671,-681.4184C350.2526,-683.9978 354.4688,-687.1499 358,-691 409.6142,-747.2769 341.3791,-803.6633 394,-859 401.6664,-867.0621 412.0586,-872.1499 422.7698,-875.3309"/>
<polygon fill="#000000" stroke="#000000" points="422.0815,-878.7657 432.6272,-877.7467 423.7478,-871.9669 422.0815,-878.7657"/>
</g>
<!-- proc~calculate_gcfields_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge33" class="edge">
<title>proc~calculate_gcfields_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M345.7346,-681.8531C350.2441,-684.3464 354.4286,-687.3595 358,-691 398.7858,-732.5754 352.4709,-776.167 394,-817 395.1003,-818.0818 396.2498,-819.1095 397.4424,-820.0858"/>
<polygon fill="#000000" stroke="#000000" points="395.6334,-823.088 405.8726,-825.8101 399.5657,-817.2969 395.6334,-823.088"/>
</g>
<!-- proc~calculate_gcfields_p&#45;&gt;ezspline_derivative -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge35" class="edge">
<title>proc~calculate_gcfields_p&#45;&gt;ezspline_derivative</title>
<path fill="none" stroke="#000000" d="M344.5027,-682.0942C349.378,-684.5364 353.9801,-687.4718 358,-691 386.9995,-716.4522 365.2869,-744.2251 394,-770 399.3618,-774.8131 405.6383,-778.7383 412.2648,-781.9388"/>
<polygon fill="#000000" stroke="#000000" points="410.8939,-785.1591 421.4649,-785.8692 413.644,-778.7219 410.8939,-785.1591"/>
</g>
<!-- proc~interp_hcollision_p&#45;&gt;ezspline_error -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge38" class="edge">
<title>proc~interp_hcollision_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M340.1106,-996.0966C346.6241,-993.2767 352.8172,-989.6539 358,-985 388.2213,-957.8624 363.2941,-927.5881 394,-901 402.163,-893.9317 412.4619,-889.2128 422.8898,-886.0703"/>
<polygon fill="#000000" stroke="#000000" points="424.0435,-889.3878 432.8618,-883.5151 422.306,-882.6069 424.0435,-889.3878"/>
</g>
<!-- proc~interp_hcollision_p&#45;&gt;ezspline_interp -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge36" class="edge">
<title>proc~interp_hcollision_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M334.2616,-993.9099C342.2845,-991.2842 350.48,-988.2933 358,-985 374.9675,-977.5694 377.831,-973.0374 394,-964 409.1627,-955.525 426.141,-946.3969 440.4187,-938.8223"/>
<polygon fill="#000000" stroke="#000000" points="442.1609,-941.8603 449.3649,-934.0916 438.8886,-935.6722 442.1609,-941.8603"/>
</g>
<!-- proc~check_if_in_profiles_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node36" class="node">
<title>proc~check_if_in_profiles_domain_p</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node36"><a xlink:href=".././proc/check_if_in_profiles_domain_p.html" xlink:title="check_if_in_profiles_domain_p">
<polygon fill="#d9534f" stroke="#d9534f" points="551,-997 394,-997 394,-973 551,-973 551,-997"/>
<text text-anchor="middle" x="472.5" y="-982.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_if_in_profiles_domain_p</text>
</a>
</g>
</g>
<!-- proc~interp_hcollision_p&#45;&gt;proc~check_if_in_profiles_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge37" class="edge">
<title>proc~interp_hcollision_p&#45;&gt;proc~check_if_in_profiles_domain_p</title>
<path fill="none" stroke="#000000" d="M340.4757,-1000.1503C353.8806,-998.6121 368.7396,-996.9069 383.5113,-995.2118"/>
<polygon fill="#000000" stroke="#000000" points="384.1692,-998.6594 393.7049,-994.0421 383.3711,-991.705 384.1692,-998.6594"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge39" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M320.8309,-223.4153C333.1219,-220.2319 346.9084,-215.3563 358,-208 378.7713,-194.2237 371.4165,-175.5461 394,-165 457.2238,-135.4755 485.2116,-141.7442 551,-165 632.3455,-193.7551 653.1512,-215.8822 702,-287 739.9498,-342.2503 756.1634,-421.7934 762.08,-459.9484"/>
<polygon fill="#000000" stroke="#000000" points="758.6356,-460.5843 763.5421,-469.9745 765.5623,-459.5741 758.6356,-460.5843"/>
</g>
<!-- proc~clogei -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node27" class="node">
<title>proc~clogei</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node27"><a xlink:href=".././proc/clogei.html" xlink:title="CLogei">
<polygon fill="#d94e8f" stroke="#d94e8f" points="671.5,-108 617.5,-108 617.5,-84 671.5,-84 671.5,-108"/>
<text text-anchor="middle" x="644.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLogei</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~clogei -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge40" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~clogei</title>
<path fill="none" stroke="#000000" d="M320.7549,-225.4188C333.6127,-222.5391 347.8402,-217.3493 358,-208 389.7012,-178.8275 359.4175,-143.6915 394,-118 456.7517,-71.3815 554.2751,-79.2153 607.2261,-88.1348"/>
<polygon fill="#000000" stroke="#000000" points="606.7386,-91.603 617.1984,-89.9173 607.9704,-84.7123 606.7386,-91.603"/>
</g>
<!-- proc~g_j -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node28" class="node">
<title>proc~g_j</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node28"><a xlink:href=".././proc/g_j.html" xlink:title="g_j">
<polygon fill="#d94e8f" stroke="#d94e8f" points="499.5,-222 445.5,-222 445.5,-198 499.5,-198 499.5,-222"/>
<text text-anchor="middle" x="472.5" y="-207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">g_j</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~g_j -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge41" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~g_j</title>
<path fill="none" stroke="#000000" d="M320.5435,-225.7769C352.3339,-222.4763 401.7476,-217.3459 435.5373,-213.8377"/>
<polygon fill="#000000" stroke="#000000" points="435.9004,-217.3189 445.4854,-212.8048 435.1774,-210.3563 435.9004,-217.3189"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~gammacee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge42" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M310.1484,-241.0823C325.752,-251.3155 346.401,-267.428 358,-287 398.7058,-355.6859 339.2515,-404.8853 394,-463 403.0072,-472.561 415.8467,-477.9452 428.5393,-480.926"/>
<polygon fill="#000000" stroke="#000000" points="428.1341,-484.4114 438.611,-482.8352 429.4379,-477.5339 428.1341,-484.4114"/>
</g>
<!-- proc~clogee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node32" class="node">
<title>proc~clogee</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node32"><a xlink:href=".././proc/clogee.html" xlink:title="CLogee">
<polygon fill="#d94e8f" stroke="#d94e8f" points="671.5,-374 617.5,-374 617.5,-350 671.5,-350 671.5,-374"/>
<text text-anchor="middle" x="644.5" y="-359.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLogee</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~clogee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge43" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M320.6238,-220.8026C332.4957,-217.3282 346.0428,-212.9367 358,-208 374.7225,-201.0959 376.439,-193.3498 394,-189 461.7309,-172.2232 491.0669,-153.2653 551,-189 606.5137,-222.0997 631.0541,-300.8521 640.0725,-339.6357"/>
<polygon fill="#000000" stroke="#000000" points="636.754,-340.8456 642.3043,-349.8703 643.5932,-339.3541 636.754,-340.8456"/>
</g>
<!-- proc~interp_fields_p&#45;&gt;ezspline_error -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge46" class="edge">
<title>proc~interp_fields_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M330.1136,-847.3212C357.524,-853.6121 393.8675,-861.9532 422.9755,-868.6337"/>
<polygon fill="#000000" stroke="#000000" points="422.4136,-872.0957 432.9431,-870.9214 423.9795,-865.2731 422.4136,-872.0957"/>
</g>
<!-- proc~interp_fields_p&#45;&gt;ezspline_interp -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge44" class="edge">
<title>proc~interp_fields_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M330.3086,-846.3988C339.8643,-849.4529 349.6754,-853.5481 358,-859 378.5672,-872.4697 373.1932,-887.9034 394,-901 402.1524,-906.1314 411.5405,-910.0195 420.9252,-912.9624"/>
<polygon fill="#000000" stroke="#000000" points="420.0776,-916.3597 430.6519,-915.6995 421.9739,-909.6214 420.0776,-916.3597"/>
</g>
<!-- proc~interp_fields_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge45" class="edge">
<title>proc~interp_fields_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M330.1136,-838C347.4091,-838 368.2611,-838 388.608,-838"/>
<polygon fill="#000000" stroke="#000000" points="388.858,-841.5001 398.8579,-838 388.8579,-834.5001 388.858,-841.5001"/>
</g>
<!-- proc~calculate_gcfields_p_fs&#45;&gt;ezspline_error -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge48" class="edge">
<title>proc~calculate_gcfields_p_fs&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M340.3613,-808.0018C346.55,-810.4858 352.589,-813.4563 358,-817 378.5672,-830.4697 373.1932,-845.9034 394,-859 402.6859,-864.4672 412.7747,-868.5231 422.7674,-871.5281"/>
<polygon fill="#000000" stroke="#000000" points="422.1065,-874.9748 432.6727,-874.1962 423.9272,-868.2157 422.1065,-874.9748"/>
</g>
<!-- proc~calculate_gcfields_p_fs&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge47" class="edge">
<title>proc~calculate_gcfields_p_fs&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M341.9405,-808.0355C363.1894,-812.9123 387.8981,-818.5832 410.0666,-823.671"/>
<polygon fill="#000000" stroke="#000000" points="409.5223,-827.137 420.0519,-825.9627 411.0882,-820.3144 409.5223,-827.137"/>
</g>
<!-- proc~calculate_gcfields_p_fs&#45;&gt;ezspline_derivative -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge49" class="edge">
<title>proc~calculate_gcfields_p_fs&#45;&gt;ezspline_derivative</title>
<path fill="none" stroke="#000000" d="M355.0503,-796C373.3966,-796 393.2603,-796 411.3415,-796"/>
<polygon fill="#000000" stroke="#000000" points="411.4683,-799.5001 421.4682,-796 411.4682,-792.5001 411.4683,-799.5001"/>
</g>
<!-- proc~large_angle_source&#45;&gt;proc~get_random -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge52" class="edge">
<title>proc~large_angle_source&#45;&gt;proc~get_random</title>
<path fill="none" stroke="#000000" d="M336.2563,-174.9877C344.1664,-171.429 351.8089,-166.8569 358,-161 386.6184,-133.9263 364.8071,-106.4533 394,-80 403.3918,-71.4896 415.6414,-65.7568 427.6608,-61.8981"/>
<polygon fill="#000000" stroke="#000000" points="428.965,-65.1666 437.6353,-59.0776 427.0602,-58.4307 428.965,-65.1666"/>
</g>
<!-- proc~large_angle_source&#45;&gt;korc_abort -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge51" class="edge">
<title>proc~large_angle_source&#45;&gt;korc_abort</title>
<path fill="none" stroke="#000000" d="M306.1292,-174.9254C321.3646,-163.1374 343.6656,-143.9559 358,-123 382.3229,-87.4417 361.7777,-61.5959 394,-33 404.3423,-23.8216 418.2725,-18.5931 431.5271,-15.6354"/>
<polygon fill="#000000" stroke="#000000" points="432.269,-19.0575 441.4606,-13.7884 430.9893,-12.1754 432.269,-19.0575"/>
</g>
<!-- proc~large_angle_source&#45;&gt;proc~gammacee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge50" class="edge">
<title>proc~large_angle_source&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M342.3317,-196.2154C348.2744,-199.1492 353.7189,-202.9867 358,-208 432.3277,-295.0393 318.1143,-377.3156 394,-463 402.7828,-472.9168 415.6837,-478.3841 428.5002,-481.3318"/>
<polygon fill="#000000" stroke="#000000" points="428.214,-484.8374 438.6804,-483.1924 429.4726,-477.9514 428.214,-484.8374"/>
</g>
<!-- proc~interp_focollision_p&#45;&gt;ezspline_error -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge55" class="edge">
<title>proc~interp_focollision_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M340.3613,-951.9982C346.55,-949.5142 352.589,-946.5437 358,-943 378.5672,-929.5303 373.1932,-914.0966 394,-901 402.6859,-895.5328 412.7747,-891.4769 422.7674,-888.4719"/>
<polygon fill="#000000" stroke="#000000" points="423.9272,-891.7843 432.6727,-885.8038 422.1065,-885.0252 423.9272,-891.7843"/>
</g>
<!-- proc~interp_focollision_p&#45;&gt;ezspline_interp -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge53" class="edge">
<title>proc~interp_focollision_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M341.9405,-951.9645C366.7255,-946.2761 396.2177,-939.5074 420.8954,-933.8437"/>
<polygon fill="#000000" stroke="#000000" points="421.8329,-937.2196 430.7965,-931.5713 420.267,-930.397 421.8329,-937.2196"/>
</g>
<!-- proc~interp_focollision_p&#45;&gt;proc~check_if_in_profiles_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge54" class="edge">
<title>proc~interp_focollision_p&#45;&gt;proc~check_if_in_profiles_domain_p</title>
<path fill="none" stroke="#000000" d="M343.9106,-970.2438C356.4202,-971.6794 370.0432,-973.2427 383.5905,-974.7973"/>
<polygon fill="#000000" stroke="#000000" points="383.5818,-978.3192 393.9156,-975.9821 384.3799,-971.3648 383.5818,-978.3192"/>
</g>
<!-- proc~calculate_2dbdbfields_p&#45;&gt;ezspline_error -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge58" class="edge">
<title>proc~calculate_2dbdbfields_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M341.9405,-909.9645C367.3753,-904.127 397.7673,-897.1518 422.8263,-891.4005"/>
<polygon fill="#000000" stroke="#000000" points="423.8897,-894.7475 432.8534,-889.0992 422.3238,-887.9249 423.8897,-894.7475"/>
</g>
<!-- proc~calculate_2dbdbfields_p&#45;&gt;ezspline_interp -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge56" class="edge">
<title>proc~calculate_2dbdbfields_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M354.019,-922C375.8507,-922 399.9329,-922 420.6521,-922"/>
<polygon fill="#000000" stroke="#000000" points="420.8386,-925.5001 430.8386,-922 420.8385,-918.5001 420.8386,-925.5001"/>
</g>
<!-- proc~calculate_2dbdbfields_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge57" class="edge">
<title>proc~calculate_2dbdbfields_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M340.3613,-909.9982C346.55,-907.5142 352.589,-904.5437 358,-901 378.5672,-887.5303 373.1932,-872.0966 394,-859 396.8058,-857.2339 399.7579,-855.6152 402.8059,-854.1315"/>
<polygon fill="#000000" stroke="#000000" points="404.3983,-857.2562 412.1869,-850.0737 401.6192,-850.8315 404.3983,-857.2562"/>
</g>
<!-- proc~cb_ei_sd_fio&#45;&gt;proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge59" class="edge">
<title>proc~cb_ei_sd_fio&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M332.0588,-297.8134C413.1189,-281.0707 591.419,-257.3471 702,-341 740.4459,-370.0837 755.9644,-427.8678 761.7965,-459.6902"/>
<polygon fill="#000000" stroke="#000000" points="758.3807,-460.4854 763.4771,-469.7739 765.2854,-459.3345 758.3807,-460.4854"/>
</g>
<!-- proc~cb_ei_sd_fio&#45;&gt;proc~clogei -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge60" class="edge">
<title>proc~cb_ei_sd_fio&#45;&gt;proc~clogei</title>
<path fill="none" stroke="#000000" d="M325.1591,-295.9362C345.2966,-289.2399 370.9714,-280.8957 394,-274 463.3071,-253.2467 491.9583,-272.8121 551,-231 592.5979,-201.5412 621.6974,-147.3832 635.4666,-117.3942"/>
<polygon fill="#000000" stroke="#000000" points="638.6804,-118.7808 639.5443,-108.2212 632.2839,-115.9373 638.6804,-118.7808"/>
</g>
<!-- proc~cb_ei_sd_fio&#45;&gt;proc~g_j -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge61" class="edge">
<title>proc~cb_ei_sd_fio&#45;&gt;proc~g_j</title>
<path fill="none" stroke="#000000" d="M304.2317,-295.8258C323.7351,-280.1994 359.6765,-253.0727 394,-236 407.0088,-229.5293 422.0004,-224.1114 435.3739,-219.925"/>
<polygon fill="#000000" stroke="#000000" points="436.6548,-223.1949 445.2257,-216.9668 434.6416,-216.4906 436.6548,-223.1949"/>
</g>
<!-- proc~cb_ei_sd_fio&#45;&gt;proc~gammacee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge62" class="edge">
<title>proc~cb_ei_sd_fio&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M294.1854,-320.2612C306.0805,-349.697 340.3607,-424.7471 394,-463 404.2298,-470.2954 416.8429,-475.0564 428.9429,-478.1634"/>
<polygon fill="#000000" stroke="#000000" points="428.3987,-481.6283 438.9226,-480.4036 429.932,-474.7982 428.3987,-481.6283"/>
</g>
<!-- proc~cb_ei_sd_fio&#45;&gt;proc~clogee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge63" class="edge">
<title>proc~cb_ei_sd_fio&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M332.3213,-314.5137C402.5154,-325.1911 540.8785,-346.2379 607.2572,-356.3349"/>
<polygon fill="#000000" stroke="#000000" points="606.8584,-359.8144 617.271,-357.8581 607.9111,-352.894 606.8584,-359.8144"/>
</g>
<!-- proc~cf_sd_fio&#45;&gt;proc~psi -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge64" class="edge">
<title>proc~cf_sd_fio&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M324.7145,-507.9483C336.1065,-511.085 348.2922,-515.8352 358,-523 380.9114,-539.9096 371.2792,-558.8353 394,-576 406.0753,-585.1224 421.5163,-591.1406 435.5037,-595.0643"/>
<polygon fill="#000000" stroke="#000000" points="434.8093,-598.4989 445.3629,-597.5655 436.5307,-591.7138 434.8093,-598.4989"/>
</g>
<!-- proc~cf_sd_fio&#45;&gt;proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge65" class="edge">
<title>proc~cf_sd_fio&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M324.5649,-512.4504C349.4217,-519.6561 380.639,-528.241 394,-530 463.1808,-539.1076 481.6464,-537.6825 551,-530 614.1059,-523.0095 685.7979,-504.7602 728.1157,-492.8853"/>
<polygon fill="#000000" stroke="#000000" points="729.3001,-496.1875 737.963,-490.0879 727.3871,-489.4539 729.3001,-496.1875"/>
</g>
<!-- proc~cf_sd_fio&#45;&gt;proc~gammacee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge67" class="edge">
<title>proc~cf_sd_fio&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M324.7842,-498.5294C354.3648,-495.6199 396.7433,-491.4515 428.5288,-488.325"/>
<polygon fill="#000000" stroke="#000000" points="429.2591,-491.7702 438.8684,-487.308 428.5738,-484.8038 429.2591,-491.7702"/>
</g>
<!-- proc~cf_sd_fio&#45;&gt;proc~clogee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge66" class="edge">
<title>proc~cf_sd_fio&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M324.6344,-512.5758C377.369,-526.312 478.5198,-544.2075 551,-505 598.79,-479.1485 626.0601,-417.0784 637.7078,-383.8562"/>
<polygon fill="#000000" stroke="#000000" points="641.0961,-384.7598 640.9468,-374.166 634.4571,-382.5406 641.0961,-384.7598"/>
</g>
<!-- proc~h_j -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node33" class="node">
<title>proc~h_j</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node33"><a xlink:href=".././proc/h_j.html" xlink:title="h_j">
<polygon fill="#d94e8f" stroke="#d94e8f" points="499.5,-454 445.5,-454 445.5,-430 499.5,-430 499.5,-454"/>
<text text-anchor="middle" x="472.5" y="-439.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h_j</text>
</a>
</g>
</g>
<!-- proc~cf_sd_fio&#45;&gt;proc~h_j -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge68" class="edge">
<title>proc~cf_sd_fio&#45;&gt;proc~h_j</title>
<path fill="none" stroke="#000000" d="M319.4146,-489.9652C340.1671,-481.8317 368.5449,-471.1342 394,-463 407.4929,-458.6883 422.4773,-454.5284 435.7076,-451.0645"/>
<polygon fill="#000000" stroke="#000000" points="436.6185,-454.4442 445.4293,-448.5602 434.8723,-447.6654 436.6185,-454.4442"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~psi -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge71" class="edge">
<title>proc~ca_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M316.5325,-552.1847C329.1469,-556.0303 344.3558,-560.7043 358,-565 383.9198,-573.1605 413.061,-582.5808 435.4578,-589.8738"/>
<polygon fill="#000000" stroke="#000000" points="434.6455,-593.2902 445.2379,-593.0627 436.8156,-586.635 434.6455,-593.2902"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge70" class="edge">
<title>proc~ca_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M316.6095,-547.6978C330.1215,-550.6213 346.0767,-555.8151 358,-565 382.0351,-583.515 367.4865,-608.2511 394,-623 454.978,-656.9208 484.0468,-642.6521 551,-623 631.5697,-599.3512 709.6507,-533.9397 745.1242,-501.1942"/>
<polygon fill="#000000" stroke="#000000" points="747.5179,-503.7477 752.4243,-494.3573 742.7329,-498.6385 747.5179,-503.7477"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~gammacee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge69" class="edge">
<title>proc~ca_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M316.5636,-535.9129C329.1846,-532.0878 344.39,-527.4029 358,-523 381.4583,-515.4111 407.4826,-506.5801 428.7854,-499.2425"/>
<polygon fill="#000000" stroke="#000000" points="430.2128,-502.4525 438.5223,-495.8796 427.9276,-495.836 430.2128,-502.4525"/>
</g>
<!-- proc~calculate_gcfields_2x1t_p&#45;&gt;ezspline_error -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge73" class="edge">
<title>proc~calculate_gcfields_2x1t_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M344.9249,-766.1724C349.6575,-768.5991 354.1129,-771.5095 358,-775 388.2213,-802.1376 363.2941,-832.4119 394,-859 402.163,-866.0683 412.4619,-870.7872 422.8898,-873.9297"/>
<polygon fill="#000000" stroke="#000000" points="422.306,-877.3931 432.8618,-876.4849 424.0435,-870.6122 422.306,-877.3931"/>
</g>
<!-- proc~calculate_gcfields_2x1t_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge72" class="edge">
<title>proc~calculate_gcfields_2x1t_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M340.3613,-766.0018C346.55,-768.4858 352.589,-771.4563 358,-775 378.5672,-788.4697 373.1932,-803.9034 394,-817 396.8058,-818.7661 399.7579,-820.3848 402.8059,-821.8685"/>
<polygon fill="#000000" stroke="#000000" points="401.6192,-825.1685 412.1869,-825.9263 404.3983,-818.7438 401.6192,-825.1685"/>
</g>
<!-- proc~calculate_gcfields_2x1t_p&#45;&gt;ezspline_derivative -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge74" class="edge">
<title>proc~calculate_gcfields_2x1t_p&#45;&gt;ezspline_derivative</title>
<path fill="none" stroke="#000000" d="M341.9405,-766.0355C363.6531,-771.0187 388.9782,-776.8311 411.5143,-782.0033"/>
<polygon fill="#000000" stroke="#000000" points="410.7856,-785.427 421.3152,-784.2527 412.3515,-778.6044 410.7856,-785.427"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~psi -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge75" class="edge">
<title>proc~cf_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M316.8311,-460.0718C329.9358,-465.1251 345.4686,-472.1875 358,-481 399.234,-509.9971 437.3967,-555.5989 457.5561,-581.7532"/>
<polygon fill="#000000" stroke="#000000" points="454.8481,-583.9746 463.681,-589.8253 460.4246,-579.7433 454.8481,-583.9746"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge76" class="edge">
<title>proc~cf_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M316.549,-440.9724C337.3848,-433.8058 367.0849,-424.7869 394,-421 463.0972,-411.2781 481.8937,-411.3431 551,-421 614.7582,-429.9096 686.1876,-453.0671 728.2854,-468.1482"/>
<polygon fill="#000000" stroke="#000000" points="727.2314,-471.4889 737.8255,-471.6081 729.618,-464.9083 727.2314,-471.4889"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~gammacee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge78" class="edge">
<title>proc~cf_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M316.5023,-455.8693C346.0926,-461.2052 393.9933,-469.8431 428.9185,-476.141"/>
<polygon fill="#000000" stroke="#000000" points="428.3893,-479.602 438.8517,-477.9323 429.6316,-472.7131 428.3893,-479.602"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~clogee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge77" class="edge">
<title>proc~cf_sd&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M304.7092,-438.8378C324.1516,-424.0285 359.447,-399.5647 394,-388 466.621,-363.6942 557.1287,-360.4767 607.0544,-360.8688"/>
<polygon fill="#000000" stroke="#000000" points="607.3199,-364.3726 617.3658,-361.0065 607.4135,-357.3732 607.3199,-364.3726"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~h_j -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge79" class="edge">
<title>proc~cf_sd&#45;&gt;proc~h_j</title>
<path fill="none" stroke="#000000" d="M316.5023,-449.672C347.8578,-448.1299 399.7733,-445.5767 435.0235,-443.8431"/>
<polygon fill="#000000" stroke="#000000" points="435.571,-447.3205 445.3869,-443.3334 435.2271,-440.329 435.571,-447.3205"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~psi -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge83" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M322.2167,-623.3517C353.9432,-618.8441 402.021,-612.0134 435.213,-607.2976"/>
<polygon fill="#000000" stroke="#000000" points="436.0187,-610.7184 445.427,-605.8464 435.034,-603.788 436.0187,-610.7184"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge82" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M322.0584,-636.4651C333.5983,-639.8603 346.5543,-644.13 358,-649 374.8422,-656.1662 376.2818,-664.4088 394,-669 527.6812,-703.6403 597.6591,-718.4632 702,-628 739.5036,-595.4845 755.4035,-536.6228 761.546,-504.4629"/>
<polygon fill="#000000" stroke="#000000" points="765.0504,-504.7425 763.3312,-494.2881 758.1557,-503.5327 765.0504,-504.7425"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~gammacee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge80" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M322.0198,-621.7477C333.9307,-618.5254 347.1405,-613.7981 358,-607 401.5458,-579.74 439.3611,-531.7838 458.7253,-504.5022"/>
<polygon fill="#000000" stroke="#000000" points="461.7307,-506.3108 464.5666,-496.1025 455.9837,-502.3142 461.7307,-506.3108"/>
</g>
<!-- proc~delta -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node34" class="node">
<title>proc~delta</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node34"><a xlink:href=".././proc/delta.html" xlink:title="delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="671.5,-770 617.5,-770 617.5,-746 671.5,-746 671.5,-770"/>
<text text-anchor="middle" x="644.5" y="-755.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">delta</text>
</a>
</g>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~delta -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge81" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~delta</title>
<path fill="none" stroke="#000000" d="M322.0194,-632.0456C334.4832,-635.0052 348.0779,-640.1292 358,-649 387.9761,-675.7997 361.5688,-708.2302 394,-732 457.1471,-778.2824 554.5128,-772.5396 607.3332,-764.9074"/>
<polygon fill="#000000" stroke="#000000" points="607.9317,-768.3566 617.28,-763.3707 606.8628,-761.4387 607.9317,-768.3566"/>
</g>
<!-- proc~clogei&#45;&gt;proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge85" class="edge">
<title>proc~clogei&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M671.7707,-102.3262C682.7469,-106.2264 694.5469,-112.3907 702,-122 722.9444,-149.0038 753.2552,-385.5196 762.3341,-459.7869"/>
<polygon fill="#000000" stroke="#000000" points="758.881,-460.3859 763.5603,-469.8914 765.83,-459.5426 758.881,-460.3859"/>
</g>
<!-- proc~clog0 -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node38" class="node">
<title>proc~clog0</title>
<g id="a_proc~~include_coulombcollisionsla_gc_p~~CallsGraph_node38"><a xlink:href=".././proc/clog0.html" xlink:title="CLog0">
<polygon fill="#d94e8f" stroke="#d94e8f" points="792,-240 738,-240 738,-216 792,-216 792,-240"/>
<text text-anchor="middle" x="765" y="-225.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLog0</text>
</a>
</g>
</g>
<!-- proc~clogei&#45;&gt;proc~clog0 -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge84" class="edge">
<title>proc~clogei&#45;&gt;proc~clog0</title>
<path fill="none" stroke="#000000" d="M671.6729,-104.3456C681.997,-108.4709 693.3432,-114.259 702,-122 728.412,-145.6177 747.0053,-183.0031 756.85,-206.4823"/>
<polygon fill="#000000" stroke="#000000" points="753.6612,-207.9334 760.6428,-215.9026 760.1546,-205.319 753.6612,-207.9334"/>
</g>
<!-- proc~gammacee&#45;&gt;proc~clogee -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge86" class="edge">
<title>proc~gammacee&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M506.2275,-479.2869C520.7527,-476.1993 537.4694,-471.1598 551,-463 585.3218,-442.3019 614.8073,-405.3674 631.0597,-382.3589"/>
<polygon fill="#000000" stroke="#000000" points="634.0246,-384.2244 636.8127,-374.003 628.259,-380.2548 634.0246,-384.2244"/>
</g>
<!-- proc~clogee&#45;&gt;proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge88" class="edge">
<title>proc~clogee&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M671.7517,-370.7083C681.9694,-374.8577 693.2202,-380.5672 702,-388 725.9467,-408.2727 744.5342,-439.8353 755.1292,-460.7112"/>
<polygon fill="#000000" stroke="#000000" points="752.0089,-462.2976 759.5512,-469.7383 758.2952,-459.2182 752.0089,-462.2976"/>
</g>
<!-- proc~clogee&#45;&gt;proc~clog0 -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge87" class="edge">
<title>proc~clogee&#45;&gt;proc~clog0</title>
<path fill="none" stroke="#000000" d="M655.6204,-349.6338C676.5137,-326.3997 721.7962,-276.044 747.0546,-247.9558"/>
<polygon fill="#000000" stroke="#000000" points="749.8224,-250.1124 753.9065,-240.3363 744.6174,-245.4317 749.8224,-250.1124"/>
</g>
<!-- proc~delta&#45;&gt;proc~vte -->
<g id="proc~~include_coulombcollisionsla_gc_p~~CallsGraph_edge89" class="edge">
<title>proc~delta&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M671.7305,-751.2964C682.5651,-747.3449 694.2687,-741.2445 702,-732 731.3491,-696.9068 753.9968,-558.4556 761.932,-504.0857"/>
<polygon fill="#000000" stroke="#000000" points="765.408,-504.5019 763.36,-494.107 758.4786,-503.5103 765.408,-504.5019"/>
</g>
</g>
</svg>
</div><script>var panprocinclude_coulombcollisionsla_gc_pCallsGraph = svgPanZoom('#procinclude_coulombcollisionsla_gc_pCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/include_coulombcollisionsla_gc_p.html#src">include_CoulombCollisionsLA_GC_p</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">include_CoulombCollisionsLA_GC_p</span><span class="p">(</span><span class="n">spp</span><span class="p">,</span><span class="n">achunk</span><span class="p">,</span><span class="n">tt</span><span class="p">,</span><span class="n">params</span><span class="p">,</span> <span class="p">&amp;</span>
       <span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">Ppll</span><span class="p">,</span><span class="n">Pmu</span><span class="p">,</span><span class="n">me</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="n">Te</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>

    <span class="k">TYPE</span><span class="p">(</span><span class="n">SPECIES</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">spp</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">PROFILES</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                                 <span class="kd">::</span> <span class="n">P</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">FIELDS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                                   <span class="kd">::</span> <span class="n">F</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 		<span class="kd">::</span> <span class="n">params</span>
    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">achunk</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">Ppll</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">Pmu</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 			<span class="kd">::</span> <span class="n">Bmag</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">B_R</span><span class="p">,</span><span class="n">B_PHI</span><span class="p">,</span><span class="n">B_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curlb_R</span><span class="p">,</span><span class="n">curlb_PHI</span><span class="p">,</span><span class="n">curlb_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gradB_R</span><span class="p">,</span><span class="n">gradB_PHI</span><span class="p">,</span><span class="n">gradB_Z</span><span class="p">,</span><span class="n">ntot</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">E_R</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">E_PHI_LAC</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">E_PHI</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="n">Te</span><span class="p">,</span><span class="n">PSIp</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> 			<span class="kd">::</span> <span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">flagCol</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">flagCon</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> 			<span class="kd">::</span> <span class="n">me</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 			<span class="kd">::</span> <span class="n">Zeff</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 			<span class="kd">::</span> <span class="n">nAr0</span><span class="p">,</span><span class="n">nAr1</span><span class="p">,</span><span class="n">nAr2</span><span class="p">,</span><span class="n">nAr3</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 			<span class="kd">::</span> <span class="n">nD</span><span class="p">,</span><span class="n">nD1</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 			<span class="kd">::</span> <span class="n">dW</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 			<span class="kd">::</span> <span class="n">rnd1</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> 					<span class="kd">::</span> <span class="n">dt</span><span class="p">,</span><span class="nb">time</span>
<span class="nb">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">pm</span><span class="p">,</span><span class="n">pm0</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span>  	<span class="kd">::</span> <span class="n">dp</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span>  	<span class="kd">::</span> <span class="n">xi</span><span class="p">,</span><span class="n">xi0</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span>  	<span class="kd">::</span> <span class="n">dxi</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span>  					<span class="kd">::</span> <span class="n">v</span><span class="p">,</span><span class="n">gam</span>
    <span class="c">!! speed of particle</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 					<span class="kd">::</span> <span class="n">CAL</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span>					<span class="kd">::</span> <span class="n">dCAL</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 					<span class="kd">::</span> <span class="n">CFL</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 					<span class="kd">::</span> <span class="n">CBL</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">SC_p</span><span class="p">,</span><span class="n">SC_xi</span><span class="p">,</span><span class="n">BREM_p</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> 					<span class="kd">::</span> <span class="n">kappa</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">cc</span><span class="p">,</span><span class="n">ii</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">ip</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tt</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">num_impurity_species</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">nimp</span>
  

    <span class="n">dt</span><span class="o">=</span><span class="n">cparams_ss</span><span class="p">%</span><span class="n">coll_per_dump_dt</span>
    <span class="nb">time</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">init_time</span><span class="o">+</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">it</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span><span class="o">+</span> <span class="p">&amp;</span>
         <span class="n">tt</span><span class="o">*</span><span class="n">cparams_ss</span><span class="p">%</span><span class="n">coll_per_dump_dt</span>


       

    <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;eqn&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">analytical_fields_GC_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">Y_Z</span><span class="p">,</span><span class="n">B_R</span><span class="p">,</span><span class="n">B_PHI</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span><span class="n">E_R</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">curlb_R</span><span class="p">,</span><span class="n">curlb_PHI</span><span class="p">,</span><span class="n">curlb_Z</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">gradB_R</span><span class="p">,</span><span class="n">gradB_PHI</span><span class="p">,</span><span class="n">gradB_Z</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>          
    <span class="k">else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="cp">#ifdef PSPLINE</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">Bflux</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">SC_E</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">calculate_GCfields_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_R</span><span class="p">,</span><span class="n">B_PHI</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">E_R</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">curlb_R</span><span class="p">,</span><span class="n">curlb_PHI</span><span class="p">,</span><span class="n">curlb_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">gradB_R</span><span class="p">,</span><span class="n">gradB_PHI</span><span class="p">,</span><span class="n">gradB_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>
             <span class="k">else</span>
<span class="k">                call </span><span class="n">calculate_GCfields_p_FS</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_R</span><span class="p">,</span><span class="n">B_PHI</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">E_R</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">curlb_R</span><span class="p">,</span><span class="n">curlb_PHI</span><span class="p">,</span><span class="n">curlb_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">gradB_R</span><span class="p">,</span><span class="n">gradB_PHI</span><span class="p">,</span><span class="n">gradB_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">          else if</span> <span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">ReInterp_2x1t</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">calculate_GCfieldswE_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_R</span><span class="p">,</span><span class="n">B_PHI</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">E_R</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">curlb_R</span><span class="p">,</span><span class="n">curlb_PHI</span><span class="p">,</span><span class="n">curlb_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">gradB_R</span><span class="p">,</span><span class="n">gradB_PHI</span><span class="p">,</span><span class="n">gradB_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>
          <span class="k">else if</span> <span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">Bflux3D</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">calculate_GCfields_2x1t_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_R</span><span class="p">,</span><span class="n">B_PHI</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">E_R</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">curlb_R</span><span class="p">,</span><span class="n">curlb_PHI</span><span class="p">,</span><span class="n">curlb_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">gradB_R</span><span class="p">,</span><span class="n">gradB_PHI</span><span class="p">,</span><span class="n">gradB_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">PSIp</span><span class="p">,</span><span class="nb">time</span><span class="p">)</span>
          <span class="k">else if</span> <span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">dBfield</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">calculate_2DBdBfields_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_R</span><span class="p">,</span><span class="n">B_PHI</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">E_R</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">curlb_R</span><span class="p">,</span><span class="n">curlb_PHI</span><span class="p">,</span><span class="n">curlb_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">gradB_R</span><span class="p">,</span><span class="n">gradB_PHI</span><span class="p">,</span><span class="n">gradB_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">interp_fields_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_R</span><span class="p">,</span><span class="n">B_PHI</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">E_R</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">curlb_R</span><span class="p">,</span><span class="n">curlb_PHI</span><span class="p">,</span><span class="n">curlb_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">gradB_R</span><span class="p">,</span><span class="n">gradB_PHI</span><span class="p">,</span><span class="n">gradB_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">)</span>
          <span class="k">end if</span>
<span class="k">       else</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">dBfield</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">calculate_2DBdBfields_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_R</span><span class="p">,</span><span class="n">B_PHI</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">E_R</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">curlb_R</span><span class="p">,</span><span class="n">curlb_PHI</span><span class="p">,</span><span class="n">curlb_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">gradB_R</span><span class="p">,</span><span class="n">gradB_PHI</span><span class="p">,</span><span class="n">gradB_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">interp_fields_3D_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_R</span><span class="p">,</span><span class="n">B_PHI</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">E_R</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">curlb_R</span><span class="p">,</span><span class="n">curlb_PHI</span><span class="p">,</span><span class="n">curlb_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">gradB_R</span><span class="p">,</span><span class="n">gradB_PHI</span><span class="p">,</span><span class="n">gradB_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">)</span>
          <span class="k">end if</span>
<span class="k">       </span><span class="n">endif</span>
<span class="cp">#endif</span>
       <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">ReInterp_2x1t</span><span class="p">)</span> <span class="k">call </span><span class="n">add_analytical_E_p</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">tt</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">E_PHI</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">)</span>
    <span class="k">end if</span>


<span class="k">    if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">profile_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;ANALYTICAL&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">analytical_profiles_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="nb">time</span><span class="p">,</span><span class="n">params</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">ne</span><span class="p">,</span><span class="n">Te</span><span class="p">,</span><span class="n">Zeff</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>
    <span class="k">else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">profile_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;EXTERNAL&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="cp">#ifdef PSPLINE</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">profile_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;H&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">interp_Hcollision_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="n">Te</span><span class="p">,</span><span class="n">Zeff</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">nAr0</span><span class="p">,</span><span class="n">nAr1</span><span class="p">,</span><span class="n">nAr2</span><span class="p">,</span><span class="n">nAr3</span><span class="p">,</span><span class="n">nD</span><span class="p">,</span><span class="n">nD1</span><span class="p">,</span><span class="n">flagCon</span><span class="p">)</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>
             <span class="n">nimp</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">nAr0</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">nimp</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">nAr1</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">nimp</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">nAr2</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">nimp</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">nAr3</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">nimp</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">nD</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">nimp</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">nD1</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">end do</span>
<span class="k">       else</span>
<span class="k">          call </span><span class="n">interp_FOcollision_p</span><span class="p">(</span><span class="n">achunk</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="n">Te</span><span class="p">,</span><span class="n">Zeff</span><span class="p">,</span><span class="n">flagCon</span><span class="p">)</span>
       <span class="n">endif</span>
<span class="cp">#endif</span>
    <span class="k">end if</span>

<span class="k">    </span><span class="n">E_PHI_LAC</span><span class="o">=</span><span class="n">E_PHI</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">FokPlan</span><span class="p">)</span> <span class="n">E_PHI</span><span class="o">=</span><span class="mf">0._rp</span>

    <span class="c">!$OMP SIMD</span>
    <span class="c">!       !$OMP&amp; aligned (pm,xi,v,Ppll,Bmag,Pmu)</span>
    <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>
       <span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">B_R</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_R</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">B_PHI</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_PHI</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
       <span class="c">! Transform p_pll,mu to P,eta</span>
       <span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">Ppll</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">Ppll</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">me</span><span class="o">*</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">Pmu</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
       <span class="n">pm0</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
       <span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">Ppll</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
       <span class="n">xi0</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
       
       <span class="n">gam</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

       <span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">gam</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
       <span class="c">! normalized speed (v_K=v_P/c)</span>
    <span class="k">end do</span>
    <span class="c">!$OMP END SIMD</span>

    <span class="c">!       write(output_unit_write,&#39;(&quot;ne: &quot;E17.10)&#39;) ne</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;Te: &quot;E17.10)&#39;) Te</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;Bmag: &quot;E17.10)&#39;) Bmag                </span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;v: &quot;,E17.10)&#39;) v</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;xi: &quot;,E17.10)&#39;) xi</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;size(E_PHI_GC): &quot;,I16)&#39;) size(E_PHI)</span>


    <span class="c">!$OMP SIMD</span>
    <span class="c">!       !$OMP&amp; aligned(rnd1,dW,CAL,dCAL,CFL,CBL,v,ne,Te,Zeff,dp, &amp;</span>
    <span class="c">!       !$OMP&amp; flagCon,flagCol,dxi,xi,pm,Ppll,Pmu,Bmag)</span>
    <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>

<span class="cp">#ifdef PARALLEL_RANDOM</span>
       <span class="n">rnd1</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_random</span><span class="p">()</span>
       <span class="n">rnd1</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_random</span><span class="p">()</span>
       <span class="c">!       rnd1(:,1) = get_random_mkl()</span>
       <span class="c">!       rnd1(:,2) = get_random_mkl()</span>
<span class="cp">#else</span>
       <span class="k">call </span><span class="nb">RANDOM_NUMBER</span><span class="p">(</span><span class="n">rnd1</span><span class="p">)</span>
<span class="cp">#endif</span>

       <span class="n">dW</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">rnd1</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>     
       <span class="n">dW</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">rnd1</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>     

       <span class="c">!          write(output_unit_write,&#39;(&quot;dW1: &quot;,E17.10)&#39;) dW(cc,1)</span>
       <span class="c">!          write(output_unit_write,&#39;(&quot;dW2: &quot;,E17.10)&#39;) dW(cc,2)</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">profile_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;H&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          </span><span class="n">CAL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">CA_SD</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
          <span class="n">dCAL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span> <span class="n">dCA_SD</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">me</span><span class="p">,</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
          <span class="n">CFL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">CF_SD_FIO</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">nimp</span><span class="p">(</span><span class="n">cc</span><span class="p">,:))</span>
          <span class="n">CBL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">CB_ee_SD</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Zeff</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">+</span> <span class="p">&amp;</span>
               <span class="n">CB_ei_SD_FIO</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">nimp</span><span class="p">(</span><span class="n">cc</span><span class="p">,:),</span><span class="n">Zeff</span><span class="p">(</span><span class="n">cc</span><span class="p">)))</span>
          <span class="c">! using *_FIO routine to include additions due to Hollmann species</span>
          <span class="c">! profile</span>
       <span class="k">else</span>
<span class="k">          </span><span class="n">CAL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">CA_SD</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
          <span class="n">dCAL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span> <span class="n">dCA_SD</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">me</span><span class="p">,</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
          <span class="n">CFL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">CF_SD</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
          <span class="n">CBL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">CB_ee_SD</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Zeff</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">+</span> <span class="p">&amp;</span>
               <span class="n">CB_ei_SD</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Zeff</span><span class="p">(</span><span class="n">cc</span><span class="p">)))</span>
       <span class="n">endif</span>

       <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">energy_diffusion</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          </span><span class="n">CAL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mf">0._rp</span>
          <span class="n">dCAL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mf">0._rp</span>
       <span class="n">endif</span>

       <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">pitch_diffusion</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          </span><span class="n">CBL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mf">0._rp</span>
       <span class="n">endif</span>


       <span class="n">dp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="kt">REAL</span><span class="p">(</span><span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span> <span class="p">&amp;</span>
            <span class="p">((</span><span class="o">-</span><span class="n">CFL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">dCAL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_PHI</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span><span class="o">+</span> <span class="p">&amp;</span>
            <span class="nb">sqrt</span><span class="p">(</span><span class="mf">2.0_rp</span><span class="o">*</span><span class="n">CAL</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span><span class="n">dW</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

       <span class="n">dxi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="kt">REAL</span><span class="p">(</span><span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span> <span class="p">&amp;</span>
            <span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">CBL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">+</span> <span class="p">&amp;</span>
            <span class="n">E_PHI</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">/</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span><span class="o">-</span> <span class="p">&amp;</span>
            <span class="nb">sqrt</span><span class="p">(</span><span class="mf">2.0_rp</span><span class="o">*</span><span class="n">CBL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)))</span><span class="o">/</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">dW</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>


       <span class="k">if</span><span class="p">(</span><span class="n">cparams_ss</span><span class="p">%</span><span class="n">sample_test</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          </span><span class="n">dp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mf">0._rp</span>
          <span class="n">dxi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mf">0._rp</span>
       <span class="k">end if</span>

       <span class="c">!          write(output_unit_write,&#39;(&quot;dp: &quot;,E17.10)&#39;) dp(cc)</span>
       <span class="c">!          write(output_unit_write,&#39;(&quot;dxi: &quot;,E17.10)&#39;) dxi(cc)</span>

       <span class="c">!write(6,*) &#39;gam,xi&#39;,gam(cc),xi(cc)</span>
       
       <span class="c">!write(6,*) &#39;dpE&#39;,E_PHI(cc)*xi(cc)*dt</span>
       <span class="c">!write(6,*) &#39;dpCF&#39;,CFL(cc)*dt</span>
       <span class="c">!write(6,*) &#39;dpCA&#39;,sqrt(2*CAL(cc)*dt)</span>

       <span class="c">!write(6,*) &#39;dxiE&#39;,E_PHI(cc)*(1-xi(cc)*xi(cc))/pm(cc)*dt</span>
       <span class="c">!write(6,*) &#39;dxiCB&#39;,2*xi(cc)*CBL(cc)/(pm(cc)*pm(cc))*dt</span>
       
    <span class="k">end do</span>
    <span class="c">!$OMP END SIMD</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">FokPlan</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">radiation</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">GC_rad_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;SDE&#39;</span><span class="p">)</span> <span class="k">then</span>

          <span class="c">!$OMP SIMD</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>

             <span class="n">SC_p</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=-</span><span class="n">gam</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">/</span> <span class="p">&amp;</span>
                  <span class="p">(</span><span class="n">cparams_ss</span><span class="p">%</span><span class="n">taur</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">SC_xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">/</span> <span class="p">&amp;</span>
                  <span class="p">((</span><span class="n">cparams_ss</span><span class="p">%</span><span class="n">taur</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">gam</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

             <span class="n">kappa</span><span class="o">=</span><span class="mf">2._rp</span><span class="o">*</span><span class="n">C_PI</span><span class="o">*</span><span class="n">C_RE</span><span class="o">**</span><span class="mf">2._rp</span><span class="o">*</span><span class="n">C_ME</span><span class="o">*</span><span class="n">C_C</span><span class="o">**</span><span class="mf">2._rp</span><span class="o">/</span> <span class="p">&amp;</span>
                  <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="o">**</span><span class="mf">2._rp</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">energy</span><span class="p">)</span>
             <span class="n">BREM_p</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=-</span><span class="mf">2._rp</span><span class="o">*</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">Zeff</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Zeff</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="mf">1._rp</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
                  <span class="n">C_a</span><span class="o">/</span><span class="n">C_PI</span><span class="o">*</span><span class="p">(</span><span class="n">gam</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="mf">1._rp</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">log</span><span class="p">(</span><span class="mf">2._rp</span><span class="o">*</span><span class="n">gam</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">-</span><span class="mf">1._rp</span><span class="o">/</span><span class="mf">3._rp</span><span class="p">)</span>

             <span class="c">!write(6,*) &#39;dpR&#39;,SC_p(cc)*dt</span>
             <span class="c">!write(6,*) &#39;dpB&#39;,BREM_p(cc)*dt</span>

             <span class="c">!write(6,*) &#39;dxiR&#39;,SC_xi(cc)*dt</span>

             <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">FP_bremsstrahlung</span><span class="p">)</span> <span class="n">BREM_p</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mf">0._rp</span>
             
             <span class="n">dp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">dp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SC_p</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">BREM_p</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span> <span class="p">&amp;</span>
                  <span class="kt">REAL</span><span class="p">(</span><span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
             <span class="n">dxi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">dxi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SC_xi</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span> <span class="p">&amp;</span>
                  <span class="kt">REAL</span><span class="p">(</span><span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

          <span class="k">end do</span>
          <span class="c">!$OMP END SIMD</span>

       <span class="k">end if</span>
<span class="k">    end if</span>

    <span class="c">!$OMP SIMD</span>
    <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>  

       <span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">dp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
       <span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">dxi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
    <span class="k">end do</span>
    <span class="c">!$OMP END SIMD</span>

    <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>  
       <span class="c">!          if (pm(cc)&lt;0) pm(cc)=-pm(cc)</span>

       <span class="c">! Keep xi between [-1,1]</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
          <span class="c">!             write(output_unit_write,&#39;(&quot;High xi at: &quot;,E17.10,&quot; with dxi: &quot;,E17.10)&#39;) &amp;</span>
          <span class="c">!                  time*params%cpp%time, dxi(cc)</span>
          <span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="nb">mod</span><span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="mf">1._rp</span><span class="p">)</span>
       <span class="k">else if</span> <span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">&lt;-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          </span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span><span class="o">-</span><span class="nb">mod</span><span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="o">-</span><span class="mf">1._rp</span><span class="p">)</span>
          <span class="c">!             write(output_unit_write,&#39;(&quot;Low xi at: &quot;,E17.10,&quot; with dxi: &quot;,E17.10)&#39;) &amp;</span>
          <span class="c">!                  time*params%cpp%time, dxi(cc)</span>
       <span class="n">endif</span>

       <span class="k">if</span> <span class="p">((</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="nb">min</span><span class="p">(</span><span class="n">cparams_ss</span><span class="p">%</span><span class="n">p_min</span><span class="o">*</span><span class="n">cparams_ss</span><span class="p">%</span><span class="n">pmin_scale</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">p_therm</span><span class="p">)).</span><span class="nb">and</span><span class="p">.</span><span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">1_ip</span><span class="p">)</span> <span class="k">then</span>
          <span class="c">!             write(output_unit_write,&#39;(&quot;Momentum less than zero&quot;)&#39;)</span>
          <span class="c">!             stop</span>
          <span class="c">!             write(output_unit_write,&#39;(&quot;Particle not tracked at: &quot;,E17.10,&quot; &amp;</span>
          <span class="c">!                  &amp; with xi: &quot;,E17.10)&#39;) time*params%cpp%time, xi(cc)</span>
          <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mi">0_ip</span>
       <span class="k">end if</span>

<span class="k">    end do</span>


    <span class="c">!       write(output_unit_write,&#39;(&quot;rnd1: &quot;,E17.10)&#39;) rnd1</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;flag: &quot;,I16)&#39;) flag</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;CA: &quot;,E17.10)&#39;) CAL</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;dCA: &quot;,E17.10)&#39;) dCAL</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;CF &quot;,E17.10)&#39;) CFL</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;CB: &quot;,E17.10)&#39;) CBL</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;dp: &quot;,E17.10)&#39;) dp</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;dxi: &quot;,E17.10)&#39;) dxi</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;Ppll: &quot;,E17.10)&#39;) Ppll</span>
    <span class="c">!      write(output_unit_write,&#39;(&quot;Pmu: &quot;,E17.10)&#39;) Pmu</span>
    <span class="c">!       write(output_unit_write,&#39;(&quot;E_PHI_COL: &quot;,E17.10)&#39;) E_PHI</span>


    <span class="c">!       if (tt .EQ. 1_ip) then</span>
    <span class="c">!          write(output_unit_write,&#39;(&quot;dp_rad: &quot;,E17.10)&#39;) &amp;</span>
    <span class="c">!               -gam(1)*pm(1)*(1-xi(1)*xi(1))/ &amp;</span>
    <span class="c">!               (cparams_ss%taur/Bmag(1)**2)*dt</span>
    <span class="c">!          write(output_unit_write,&#39;(&quot;dxi_rad: &quot;,E17.10)&#39;) &amp;</span>
    <span class="c">!               xi(1)*(1-xi(1)*xi(1))/ &amp;</span>
    <span class="c">!               ((cparams_ss%taur/Bmag(1)**2)*gam(1))*dt</span>
    <span class="c">!       end if</span>

    <span class="c">!       if (tt .EQ. 1_ip) then</span>
    <span class="c">!          write(output_unit_write,&#39;(&quot;CA: &quot;,E17.10)&#39;) CAL(1)</span>
    <span class="c">!          write(output_unit_write,&#39;(&quot;dCA: &quot;,E17.10)&#39;) dCAL(1)</span>
    <span class="c">!          write(output_unit_write,&#39;(&quot;CF &quot;,E17.10)&#39;) CFL(1)</span>
    <span class="c">!          write(output_unit_write,&#39;(&quot;CB: &quot;,E17.10)&#39;) CBL(1)</span>
    <span class="c">!       end if</span>

<span class="cp">#if DBG_CHECK    </span>
    <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>  
       <span class="k">if</span> <span class="p">(</span><span class="n">ISNAN</span><span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)).</span><span class="nb">or</span><span class="p">.(</span><span class="nb">abs</span><span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="mf">1._rp</span><span class="p">))</span> <span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;xi is NaN or &gt;1 before LAC&#39;</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;p0,xi0&#39;</span><span class="p">,</span><span class="n">pm0</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">xi0</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;p,xi&#39;</span><span class="p">,</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;dp,dxi&#39;</span><span class="p">,</span><span class="n">dp</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">dxi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;CBL&#39;</span><span class="p">,</span><span class="n">CBL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;v,ne,Te,Zeff&#39;</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span><span class="p">,</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">temperature</span><span class="p">,</span><span class="n">Zeff</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;ppll,pmu,Bmag&#39;</span><span class="p">,</span><span class="n">Ppll</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Pmu</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">call </span><span class="n">korc_abort</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">    end do</span>
<span class="cp"># endif</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">cparams_ss</span><span class="p">%</span><span class="n">avalanche</span><span class="p">)</span> <span class="k">then</span> 

       <span class="c">!$OMP SIMD</span>
       <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>
          <span class="n">ntot</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">bound_electron_model</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;HESSLOW&#39;</span><span class="p">)</span> <span class="k">then          </span>

<span class="k">             if</span> <span class="p">((</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">Zj</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.0</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="p">(</span><span class="n">neut_prof</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;UNIFORM&#39;</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">ntot</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">ntot</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">nz</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">(</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">Zo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">Zj</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
             <span class="k">else if</span> <span class="p">((</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">Zj</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.0</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="p">(</span><span class="n">neut_prof</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;HOLLOW&#39;</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">ntot</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">ntot</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">nz</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="mf">0._rp</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">(</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">Zo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">Zj</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
             <span class="k">else</span>
<span class="k">                </span><span class="n">ntot</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">ntot</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">nz</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">ne</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">(</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">Zo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">Zj</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
             <span class="n">endif</span>

             <span class="k">do </span><span class="n">ii</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">num_impurity_species</span>
                <span class="n">ntot</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">ntot</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">nz</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">/</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">ne</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">(</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">Zo</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">-</span><span class="n">cparams_ms</span><span class="p">%</span><span class="n">Zj</span><span class="p">(</span><span class="n">ii</span><span class="p">))</span>
             <span class="k">end do</span>

<span class="k">          end if</span>
<span class="k">       end do</span>
       <span class="c">!$OMP END SIMD</span>

       <span class="c">!write(6,*) &#39;ntot&#39;,ntot*params%cpp%density</span>

       <span class="k">call </span><span class="n">large_angle_source</span><span class="p">(</span><span class="n">spp</span><span class="p">,</span><span class="n">params</span><span class="p">,</span><span class="n">achunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">pm</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="n">ntot</span><span class="p">,</span><span class="n">Te</span><span class="p">,</span><span class="n">Bmag</span><span class="p">,</span><span class="n">E_PHI_LAC</span><span class="p">,</span><span class="n">me</span><span class="p">,</span><span class="n">flagCol</span><span class="p">,</span><span class="n">flagCon</span><span class="p">)</span>

    <span class="k">end if</span>

<span class="cp">#if DBG_CHECK    </span>
    <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>  
       <span class="k">if</span> <span class="p">(</span><span class="n">ISNAN</span><span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)).</span><span class="nb">or</span><span class="p">.(</span><span class="nb">abs</span><span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="mf">1._rp</span><span class="p">))</span> <span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;xi is NaN or &gt;1 after LAC&#39;</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;p0,xi0&#39;</span><span class="p">,</span><span class="n">pm0</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">xi0</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;p,xi&#39;</span><span class="p">,</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;dp,dxi&#39;</span><span class="p">,</span><span class="n">dp</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">dxi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;CBL&#39;</span><span class="p">,</span><span class="n">CBL</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;v,ne,Te,Zeff&#39;</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span><span class="p">,</span><span class="n">Te</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">temperature</span><span class="p">,</span><span class="n">Zeff</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">call </span><span class="n">korc_abort</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">    end do</span>
<span class="cp"># endif</span>
    
    <span class="c">!$OMP SIMD</span>
    <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>  
       <span class="c">! Transform P,xi to p_pll,mu</span>
       <span class="n">Ppll</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
       <span class="n">Pmu</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">Ppll</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">Ppll</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">me</span><span class="o">*</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
    <span class="k">end do</span>
    <span class="c">!$OMP END SIMD</span>

<span class="cp">#if DBG_CHECK    </span>
    <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">achunk</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">Pmu</span><span class="p">(</span><span class="n">cc</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0._rp</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;mu is negative&#39;</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;p,xi&#39;</span><span class="p">,</span><span class="n">pm</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">xi</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;V_PLL,V_MU&#39;</span><span class="p">,</span><span class="n">Ppll</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">Pmu</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">call </span><span class="n">korc_abort</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
       <span class="n">endif</span>
    <span class="k">end do</span>
<span class="cp">#endif</span>

    <span class="n">E_PHI</span><span class="o">=</span><span class="n">E_PHI_LAC</span>
    
  <span class="k">end subroutine </span><span class="n">include_CoulombCollisionsLA_GC_p</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2022 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> KORC was developed by Matt Beidler</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>