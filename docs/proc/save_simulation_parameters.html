<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Kinetic Orbit Runaway electrons Code (KORC)">
    
    <meta name="author" content="Matt Beidler" >
    <link rel="icon" href="../favicon.png">

    <title>save_simulation_parameters &ndash; KORC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">KORC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>README</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>save_simulation_parameters
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.1% of total for procedures.">763 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/korc_HDF5.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/korc_hdf5.f90.html'>korc_HDF5.f90</a></li>
    
     <li><a href='../module/korc_hdf5.html'>korc_HDF5</a></li>
    
  
     <li class="active">save_simulation_parameters</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/save_simulation_parameters.html#src">save_simulation_parameters</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine save_simulation_parameters(params, spp, F, P)
    
    
   
</h2>
    
  


    
    <p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>Subroutine to save to a HDF5 file all the relevant simulation
 parameters. </p></div>
<p>This subroutine saves to the HDF5 file "<a>simulation_parameters.h5</a>"
 all the relevant simulation parameters of KORC, most of them being part
 of the input file, but also including some derived quantities from the
 input parameters. This file is intended to facilitate the
 post-processing of KORC data using any software that supports
 the HDF5 software.</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-params"></span>type(KORC_PARAMS),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>params</strong></td><td><p>Core KORC simulation parameters.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-spp"></span>type(SPECIES),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>spp</strong></td><td><p>An instance of KORC's derived type SPECIES containing all
 the information of different electron species. See <a href="../module/korc_types.html">korc_types</a>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f"></span>type(FIELDS),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>F</strong></td><td><p>An instance of KORC's derived type FIELDS containing all the information
 about the fields used in the simulation. See <a href="../module/korc_types.html">korc_types</a>
 and <a href="../module/korc_fields.html">korc_fields</a>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-p~2"></span>type(PROFILES),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>P</strong></td><td><p>An instance of KORC's derived type PROFILES containing all the
 information about the plasma profiles used in the simulation.
 See <a href="../module/korc_types.html">korc_types</a> and <a href="../module/korc_profiles.html">korc_profiles</a>.</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~save_simulation_parameters~~CallsGraph Pages: 1 -->
<svg id="procsave_simulation_parametersCallsGraph" width="616pt" height="452pt"
 viewBox="0.00 0.00 616.00 452.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~save_simulation_parameters~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 448)">
<title>proc~~save_simulation_parameters~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-448 612,-448 612,4 -4,4"/>
<!-- proc~save_simulation_parameters -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node1" class="node">
<title>proc~save_simulation_parameters</title>
<polygon fill="none" stroke="#000000" points="147,-213 0,-213 0,-189 147,-189 147,-213"/>
<text text-anchor="middle" x="73.5" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">save_simulation_parameters</text>
</g>
<!-- proc~rsave_2d_array_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node2" class="node">
<title>proc~rsave_2d_array_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node2"><a xlink:href=".././proc/rsave_2d_array_to_hdf5.html" xlink:title="rsave_2d_array_to_hdf5">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-360 342,-360 342,-336 468,-336 468,-360"/>
<text text-anchor="middle" x="405" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rsave_2d_array_to_hdf5</text>
</a>
</g>
</g>
<!-- proc~save_simulation_parameters&#45;&gt;proc~rsave_2d_array_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge1" class="edge">
<title>proc~save_simulation_parameters&#45;&gt;proc~rsave_2d_array_to_hdf5</title>
<path fill="none" stroke="#000000" d="M88.6227,-213.2265C109.0177,-229.2307 146.9499,-257.3185 183,-275 235.771,-300.8826 299.9095,-320.849 345.6504,-333.3064"/>
<polygon fill="#000000" stroke="#000000" points="344.8446,-336.714 355.4102,-335.9267 346.6598,-329.9534 344.8446,-336.714"/>
</g>
<!-- h5fclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node3" class="node">
<title>h5fclose_f</title>
<polygon fill="#777777" stroke="#777777" points="274.5,-150 214.5,-150 214.5,-126 274.5,-126 274.5,-150"/>
<text text-anchor="middle" x="244.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5fclose_f</text>
</g>
<!-- proc~save_simulation_parameters&#45;&gt;h5fclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge2" class="edge">
<title>proc~save_simulation_parameters&#45;&gt;h5fclose_f</title>
<path fill="none" stroke="#000000" d="M104.0655,-188.9264C125.9642,-180.3621 156.2001,-168.7115 183,-159 190.0009,-156.4631 197.4797,-153.8384 204.7246,-151.34"/>
<polygon fill="#000000" stroke="#000000" points="206.0645,-154.5808 214.3923,-148.0312 203.7977,-147.9579 206.0645,-154.5808"/>
</g>
<!-- interface~save_1d_array_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node4" class="node">
<title>interface~save_1d_array_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node4"><a xlink:href=".././interface/save_1d_array_to_hdf5.html" xlink:title="save_1d_array_to_hdf5">
<polygon fill="#a7506f" stroke="#a7506f" points="306,-234 183,-234 183,-210 306,-210 306,-234"/>
<text text-anchor="middle" x="244.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">save_1d_array_to_hdf5</text>
</a>
</g>
</g>
<!-- proc~save_simulation_parameters&#45;&gt;interface~save_1d_array_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge3" class="edge">
<title>proc~save_simulation_parameters&#45;&gt;interface~save_1d_array_to_hdf5</title>
<path fill="none" stroke="#000000" d="M147.0118,-210.0278C155.6,-211.0825 164.3528,-212.1574 172.9144,-213.2088"/>
<polygon fill="#000000" stroke="#000000" points="172.5036,-216.6845 182.8557,-214.4296 173.3569,-209.7367 172.5036,-216.6845"/>
</g>
<!-- h5eset_auto_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node5" class="node">
<title>h5eset_auto_f</title>
<polygon fill="#777777" stroke="#777777" points="284,-108 205,-108 205,-84 284,-84 284,-108"/>
<text text-anchor="middle" x="244.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5eset_auto_f</text>
</g>
<!-- proc~save_simulation_parameters&#45;&gt;h5eset_auto_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge4" class="edge">
<title>proc~save_simulation_parameters&#45;&gt;h5eset_auto_f</title>
<path fill="none" stroke="#000000" d="M86.3447,-188.8673C105.8617,-170.9882 144.7707,-137.4751 183,-117 186.9674,-114.8751 191.1917,-112.9025 195.4964,-111.0864"/>
<polygon fill="#000000" stroke="#000000" points="196.9516,-114.2752 204.9802,-107.3621 194.3928,-107.7596 196.9516,-114.2752"/>
</g>
<!-- interface~save_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node6" class="node">
<title>interface~save_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node6"><a xlink:href=".././interface/save_to_hdf5.html" xlink:title="save_to_hdf5">
<polygon fill="#a7506f" stroke="#a7506f" points="282.5,-192 206.5,-192 206.5,-168 282.5,-168 282.5,-192"/>
<text text-anchor="middle" x="244.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">save_to_hdf5</text>
</a>
</g>
</g>
<!-- proc~save_simulation_parameters&#45;&gt;interface~save_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge5" class="edge">
<title>proc~save_simulation_parameters&#45;&gt;interface~save_to_hdf5</title>
<path fill="none" stroke="#000000" d="M147.0118,-191.9722C163.6337,-189.9309 180.8724,-187.8139 196.1474,-185.938"/>
<polygon fill="#000000" stroke="#000000" points="196.8782,-189.3747 206.377,-184.6818 196.0249,-182.4269 196.8782,-189.3747"/>
</g>
<!-- proc~save_string_parameter -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node7" class="node">
<title>proc~save_string_parameter</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node7"><a xlink:href=".././proc/save_string_parameter.html" xlink:title="save_string_parameter">
<polygon fill="#d9534f" stroke="#d9534f" points="465,-402 345,-402 345,-378 465,-378 465,-402"/>
<text text-anchor="middle" x="405" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">save_string_parameter</text>
</a>
</g>
</g>
<!-- proc~save_simulation_parameters&#45;&gt;proc~save_string_parameter -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge6" class="edge">
<title>proc~save_simulation_parameters&#45;&gt;proc~save_string_parameter</title>
<path fill="none" stroke="#000000" d="M82.7059,-213.3125C100.0246,-235.6922 139.6343,-283.2817 183,-311 231.6516,-342.0969 294.139,-362.918 340.4166,-375.3415"/>
<polygon fill="#000000" stroke="#000000" points="339.7691,-378.79 350.3299,-377.9414 341.5449,-372.019 339.7691,-378.79"/>
</g>
<!-- proc~rsave_3d_array_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node8" class="node">
<title>proc~rsave_3d_array_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node8"><a xlink:href=".././proc/rsave_3d_array_to_hdf5.html" xlink:title="rsave_3d_array_to_hdf5">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-318 342,-318 342,-294 468,-294 468,-318"/>
<text text-anchor="middle" x="405" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rsave_3d_array_to_hdf5</text>
</a>
</g>
</g>
<!-- proc~save_simulation_parameters&#45;&gt;proc~rsave_3d_array_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge7" class="edge">
<title>proc~save_simulation_parameters&#45;&gt;proc~rsave_3d_array_to_hdf5</title>
<path fill="none" stroke="#000000" d="M102.9838,-213.1352C124.8776,-221.9435 155.5679,-233.8671 183,-243 238.4831,-261.4718 302.866,-279.36 347.9635,-291.3253"/>
<polygon fill="#000000" stroke="#000000" points="347.2904,-294.7674 357.8526,-293.9361 349.0773,-287.9993 347.2904,-294.7674"/>
</g>
<!-- h5gclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node9" class="node">
<title>h5gclose_f</title>
<polygon fill="#777777" stroke="#777777" points="276,-66 213,-66 213,-42 276,-42 276,-66"/>
<text text-anchor="middle" x="244.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5gclose_f</text>
</g>
<!-- proc~save_simulation_parameters&#45;&gt;h5gclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge8" class="edge">
<title>proc~save_simulation_parameters&#45;&gt;h5gclose_f</title>
<path fill="none" stroke="#000000" d="M80.9586,-188.7054C96.7207,-163.7214 135.8695,-106.7068 183,-75 189.1784,-70.8435 196.2588,-67.4344 203.3654,-64.6636"/>
<polygon fill="#000000" stroke="#000000" points="204.7228,-67.8963 212.9903,-61.2706 202.3955,-61.2945 204.7228,-67.8963"/>
</g>
<!-- h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node13" class="node">
<title>h5dclose_f</title>
<polygon fill="#777777" stroke="#777777" points="587.5,-276 524.5,-276 524.5,-252 587.5,-252 587.5,-276"/>
<text text-anchor="middle" x="556" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5dclose_f</text>
</g>
<!-- proc~rsave_2d_array_to_hdf5&#45;&gt;h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge12" class="edge">
<title>proc~rsave_2d_array_to_hdf5&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M451.123,-335.8977C457.0436,-333.4166 462.8336,-330.4739 468,-327 488.4022,-313.2816 484.0333,-299.3449 504,-285 507.4692,-282.5076 511.2767,-280.2526 515.2046,-278.227"/>
<polygon fill="#000000" stroke="#000000" points="516.8929,-281.302 524.4857,-273.9128 513.9422,-274.9542 516.8929,-281.302"/>
</g>
<!-- h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node17" class="node">
<title>h5screate_simple_f</title>
<polygon fill="#777777" stroke="#777777" points="608,-234 504,-234 504,-210 608,-210 608,-234"/>
<text text-anchor="middle" x="556" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5screate_simple_f</text>
</g>
<!-- proc~rsave_2d_array_to_hdf5&#45;&gt;h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge9" class="edge">
<title>proc~rsave_2d_array_to_hdf5&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M455.0637,-335.8779C459.7599,-333.4397 464.1822,-330.5129 468,-327 497.8897,-299.4975 474.9781,-271.4167 504,-243 505.2435,-241.7824 506.5669,-240.6325 507.9529,-239.5467"/>
<polygon fill="#000000" stroke="#000000" points="509.9894,-242.3972 516.4563,-234.005 506.1674,-236.5327 509.9894,-242.3972"/>
</g>
<!-- h5dwrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node20" class="node">
<title>h5dwrite_f</title>
<polygon fill="#777777" stroke="#777777" points="586.5,-360 525.5,-360 525.5,-336 586.5,-336 586.5,-360"/>
<text text-anchor="middle" x="556" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5dwrite_f</text>
</g>
<!-- proc~rsave_2d_array_to_hdf5&#45;&gt;h5dwrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge11" class="edge">
<title>proc~rsave_2d_array_to_hdf5&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M468.1627,-348C484.0304,-348 500.6455,-348 515.1012,-348"/>
<polygon fill="#000000" stroke="#000000" points="515.204,-351.5001 525.2039,-348 515.2039,-344.5001 515.204,-351.5001"/>
</g>
<!-- h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node21" class="node">
<title>h5sclose_f</title>
<polygon fill="#777777" stroke="#777777" points="587.5,-318 524.5,-318 524.5,-294 587.5,-294 587.5,-318"/>
<text text-anchor="middle" x="556" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5sclose_f</text>
</g>
<!-- proc~rsave_2d_array_to_hdf5&#45;&gt;h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge10" class="edge">
<title>proc~rsave_2d_array_to_hdf5&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M448.2705,-335.9645C469.0909,-330.1734 493.9369,-323.2626 514.5185,-317.5379"/>
<polygon fill="#000000" stroke="#000000" points="515.547,-320.8848 524.2433,-314.833 513.6711,-314.1408 515.547,-320.8848"/>
</g>
<!-- proc~isave_1d_array_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node10" class="node">
<title>proc~isave_1d_array_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node10"><a xlink:href=".././proc/isave_1d_array_to_hdf5.html" xlink:title="isave_1d_array_to_hdf5">
<polygon fill="#d9534f" stroke="#d9534f" points="467.5,-276 342.5,-276 342.5,-252 467.5,-252 467.5,-276"/>
<text text-anchor="middle" x="405" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">isave_1d_array_to_hdf5</text>
</a>
</g>
</g>
<!-- interface~save_1d_array_to_hdf5&#45;&gt;proc~isave_1d_array_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge14" class="edge">
<title>interface~save_1d_array_to_hdf5&#45;&gt;proc~isave_1d_array_to_hdf5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M290.4929,-234.0355C308.7934,-238.8244 330.02,-244.3791 349.1898,-249.3955"/>
<polygon fill="#000000" stroke="#000000" points="348.4401,-252.8171 359.0004,-251.9627 350.2123,-246.0451 348.4401,-252.8171"/>
</g>
<!-- proc~rsave_1d_array_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node23" class="node">
<title>proc~rsave_1d_array_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node23"><a xlink:href=".././proc/rsave_1d_array_to_hdf5.html" xlink:title="rsave_1d_array_to_hdf5">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-234 342,-234 342,-210 468,-210 468,-234"/>
<text text-anchor="middle" x="405" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rsave_1d_array_to_hdf5</text>
</a>
</g>
</g>
<!-- interface~save_1d_array_to_hdf5&#45;&gt;proc~rsave_1d_array_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge13" class="edge">
<title>interface~save_1d_array_to_hdf5&#45;&gt;proc~rsave_1d_array_to_hdf5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M306.0945,-222C314.5452,-222 323.288,-222 331.9194,-222"/>
<polygon fill="#000000" stroke="#000000" points="331.9765,-225.5001 341.9764,-222 331.9764,-218.5001 331.9765,-225.5001"/>
</g>
<!-- proc~i2save_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node11" class="node">
<title>proc~i2save_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node11"><a xlink:href=".././proc/i2save_to_hdf5.html" xlink:title="i2save_to_hdf5">
<polygon fill="#d9534f" stroke="#d9534f" points="447,-150 363,-150 363,-126 447,-126 447,-150"/>
<text text-anchor="middle" x="405" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">i2save_to_hdf5</text>
</a>
</g>
</g>
<!-- interface~save_to_hdf5&#45;&gt;proc~i2save_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge15" class="edge">
<title>interface~save_to_hdf5&#45;&gt;proc~i2save_to_hdf5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M282.5363,-170.0466C303.5312,-164.5526 329.915,-157.6484 352.8119,-151.6567"/>
<polygon fill="#000000" stroke="#000000" points="353.9308,-154.9818 362.719,-149.0642 352.1587,-148.2098 353.9308,-154.9818"/>
</g>
<!-- proc~i1save_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node14" class="node">
<title>proc~i1save_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node14"><a xlink:href=".././proc/i1save_to_hdf5.html" xlink:title="i1save_to_hdf5">
<polygon fill="#d9534f" stroke="#d9534f" points="447,-108 363,-108 363,-84 447,-84 447,-108"/>
<text text-anchor="middle" x="405" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">i1save_to_hdf5</text>
</a>
</g>
</g>
<!-- interface~save_to_hdf5&#45;&gt;proc~i1save_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge16" class="edge">
<title>interface~save_to_hdf5&#45;&gt;proc~i1save_to_hdf5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M282.7523,-170.4705C290.8163,-167.5153 298.9953,-163.7472 306,-159 326.352,-145.2072 321.5978,-130.7184 342,-117 345.5519,-114.6117 349.3986,-112.4745 353.3798,-110.5657"/>
<polygon fill="#000000" stroke="#000000" points="355.0229,-113.6695 362.8381,-106.5159 352.2676,-107.2346 355.0229,-113.6695"/>
</g>
<!-- proc~i4save_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node16" class="node">
<title>proc~i4save_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node16"><a xlink:href=".././proc/i4save_to_hdf5.html" xlink:title="i4save_to_hdf5">
<polygon fill="#d9534f" stroke="#d9534f" points="447,-66 363,-66 363,-42 447,-42 447,-66"/>
<text text-anchor="middle" x="405" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">i4save_to_hdf5</text>
</a>
</g>
</g>
<!-- interface~save_to_hdf5&#45;&gt;proc~i4save_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge17" class="edge">
<title>interface~save_to_hdf5&#45;&gt;proc~i4save_to_hdf5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M282.6699,-172.4546C291.104,-169.3783 299.4631,-165.059 306,-159 335.7891,-131.3886 312.1103,-102.5025 342,-75 345.5262,-71.7554 349.568,-69.0109 353.8651,-66.6895"/>
<polygon fill="#000000" stroke="#000000" points="355.3458,-69.8609 362.9604,-62.4942 352.4139,-63.5045 355.3458,-69.8609"/>
</g>
<!-- proc~i8save_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node18" class="node">
<title>proc~i8save_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node18"><a xlink:href=".././proc/i8save_to_hdf5.html" xlink:title="i8save_to_hdf5">
<polygon fill="#d9534f" stroke="#d9534f" points="447,-24 363,-24 363,0 447,0 447,-24"/>
<text text-anchor="middle" x="405" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">i8save_to_hdf5</text>
</a>
</g>
</g>
<!-- interface~save_to_hdf5&#45;&gt;proc~i8save_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge18" class="edge">
<title>interface~save_to_hdf5&#45;&gt;proc~i8save_to_hdf5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M282.599,-173.2628C291.2352,-170.1585 299.704,-165.6239 306,-159 346.1244,-116.7858 301.7218,-75.0674 342,-33 345.3612,-29.4894 349.3239,-26.5656 353.5986,-24.1305"/>
<polygon fill="#000000" stroke="#000000" points="355.1955,-27.2467 362.719,-19.7869 352.1856,-20.9268 355.1955,-27.2467"/>
</g>
<!-- proc~rsave_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node19" class="node">
<title>proc~rsave_to_hdf5</title>
<g id="a_proc~~save_simulation_parameters~~CallsGraph_node19"><a xlink:href=".././proc/rsave_to_hdf5.html" xlink:title="rsave_to_hdf5">
<polygon fill="#d9534f" stroke="#d9534f" points="444.5,-192 365.5,-192 365.5,-168 444.5,-168 444.5,-192"/>
<text text-anchor="middle" x="405" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rsave_to_hdf5</text>
</a>
</g>
</g>
<!-- interface~save_to_hdf5&#45;&gt;proc~rsave_to_hdf5 -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge19" class="edge">
<title>interface~save_to_hdf5&#45;&gt;proc~rsave_to_hdf5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M282.5363,-180C304.2579,-180 331.748,-180 355.1767,-180"/>
<polygon fill="#000000" stroke="#000000" points="355.2792,-183.5001 365.2791,-180 355.2791,-176.5001 355.2792,-183.5001"/>
</g>
<!-- h5dwrite_vl_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node12" class="node">
<title>h5dwrite_vl_f</title>
<polygon fill="#777777" stroke="#777777" points="593,-444 519,-444 519,-420 593,-420 593,-444"/>
<text text-anchor="middle" x="556" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5dwrite_vl_f</text>
</g>
<!-- proc~save_string_parameter&#45;&gt;h5dwrite_vl_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge20" class="edge">
<title>proc~save_string_parameter&#45;&gt;h5dwrite_vl_f</title>
<path fill="none" stroke="#000000" d="M448.2705,-402.0355C467.269,-407.3199 489.6193,-413.5365 509.023,-418.9335"/>
<polygon fill="#000000" stroke="#000000" points="508.2957,-422.364 518.8678,-421.6719 510.1715,-415.6201 508.2957,-422.364"/>
</g>
<!-- proc~save_string_parameter&#45;&gt;h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge21" class="edge">
<title>proc~save_string_parameter&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M455.0637,-377.8779C459.7599,-375.4397 464.1822,-372.5129 468,-369 497.8897,-341.4975 474.9781,-313.4167 504,-285 507.2979,-281.7709 511.1576,-279.0176 515.2578,-276.6746"/>
<polygon fill="#000000" stroke="#000000" points="517.0365,-279.7014 524.4937,-272.1754 513.9709,-273.4084 517.0365,-279.7014"/>
</g>
<!-- h5tcopy_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node15" class="node">
<title>h5tcopy_f</title>
<polygon fill="#777777" stroke="#777777" points="585,-192 527,-192 527,-168 585,-168 585,-192"/>
<text text-anchor="middle" x="556" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5tcopy_f</text>
</g>
<!-- proc~save_string_parameter&#45;&gt;h5tcopy_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge22" class="edge">
<title>proc~save_string_parameter&#45;&gt;h5tcopy_f</title>
<path fill="none" stroke="#000000" d="M456.999,-377.8964C461.0888,-375.4548 464.8475,-372.5222 468,-369 518.9273,-312.1007 454.8628,-259.4521 504,-201 507.6807,-196.6216 512.4107,-193.1467 517.5145,-190.3914"/>
<polygon fill="#000000" stroke="#000000" points="519.2584,-193.4457 526.9592,-186.1691 516.4015,-187.0552 519.2584,-193.4457"/>
</g>
<!-- proc~save_string_parameter&#45;&gt;h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge23" class="edge">
<title>proc~save_string_parameter&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M456.4489,-377.8424C460.7055,-375.4127 464.6512,-372.4976 468,-369 508.2782,-326.9326 465.0465,-286.297 504,-243 504.8974,-242.0025 505.8489,-241.0516 506.8461,-240.145"/>
<polygon fill="#000000" stroke="#000000" points="509.2207,-242.7455 515.2447,-234.0299 505.1004,-237.0866 509.2207,-242.7455"/>
</g>
<!-- proc~save_string_parameter&#45;&gt;h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge24" class="edge">
<title>proc~save_string_parameter&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M451.123,-377.8977C457.0436,-375.4166 462.8336,-372.4739 468,-369 488.4022,-355.2816 484.0333,-341.3449 504,-327 507.4692,-324.5076 511.2767,-322.2526 515.2046,-320.227"/>
<polygon fill="#000000" stroke="#000000" points="516.8929,-323.302 524.4857,-315.9128 513.9422,-316.9542 516.8929,-323.302"/>
</g>
<!-- h5tset_strpad_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node22" class="node">
<title>h5tset_strpad_f</title>
<polygon fill="#777777" stroke="#777777" points="598.5,-402 513.5,-402 513.5,-378 598.5,-378 598.5,-402"/>
<text text-anchor="middle" x="556" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5tset_strpad_f</text>
</g>
<!-- proc~save_string_parameter&#45;&gt;h5tset_strpad_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge25" class="edge">
<title>proc~save_string_parameter&#45;&gt;h5tset_strpad_f</title>
<path fill="none" stroke="#000000" d="M465.1131,-390C477.7067,-390 490.8969,-390 503.2003,-390"/>
<polygon fill="#000000" stroke="#000000" points="503.294,-393.5001 513.294,-390 503.294,-386.5001 503.294,-393.5001"/>
</g>
<!-- proc~rsave_3d_array_to_hdf5&#45;&gt;h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge29" class="edge">
<title>proc~rsave_3d_array_to_hdf5&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M448.2705,-293.9645C469.0909,-288.1734 493.9369,-281.2626 514.5185,-275.5379"/>
<polygon fill="#000000" stroke="#000000" points="515.547,-278.8848 524.2433,-272.833 513.6711,-272.1408 515.547,-278.8848"/>
</g>
<!-- proc~rsave_3d_array_to_hdf5&#45;&gt;h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge26" class="edge">
<title>proc~rsave_3d_array_to_hdf5&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M451.123,-293.8977C457.0436,-291.4166 462.8336,-288.4739 468,-285 488.4022,-271.2816 484.0333,-257.3449 504,-243 506.0756,-241.5088 508.2723,-240.1026 510.5434,-238.7797"/>
<polygon fill="#000000" stroke="#000000" points="512.3146,-241.8037 519.5734,-234.0861 509.0862,-235.5926 512.3146,-241.8037"/>
</g>
<!-- proc~rsave_3d_array_to_hdf5&#45;&gt;h5dwrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge28" class="edge">
<title>proc~rsave_3d_array_to_hdf5&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M448.2705,-318.0355C469.3905,-323.9099 494.6528,-330.9365 515.4043,-336.7085"/>
<polygon fill="#000000" stroke="#000000" points="514.6189,-340.1228 525.1911,-339.4306 516.4948,-333.3788 514.6189,-340.1228"/>
</g>
<!-- proc~rsave_3d_array_to_hdf5&#45;&gt;h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge27" class="edge">
<title>proc~rsave_3d_array_to_hdf5&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M468.1627,-306C483.7703,-306 500.1009,-306 514.3885,-306"/>
<polygon fill="#000000" stroke="#000000" points="514.3915,-309.5001 524.3914,-306 514.3914,-302.5001 514.3915,-309.5001"/>
</g>
<!-- proc~isave_1d_array_to_hdf5&#45;&gt;h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge31" class="edge">
<title>proc~isave_1d_array_to_hdf5&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M467.7258,-264C483.3746,-264 499.7775,-264 514.1391,-264"/>
<polygon fill="#000000" stroke="#000000" points="514.1959,-267.5001 524.1959,-264 514.1958,-260.5001 514.1959,-267.5001"/>
</g>
<!-- proc~isave_1d_array_to_hdf5&#45;&gt;h5tcopy_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge33" class="edge">
<title>proc~isave_1d_array_to_hdf5&#45;&gt;h5tcopy_f</title>
<path fill="none" stroke="#000000" d="M451.123,-251.8977C457.0436,-249.4166 462.8336,-246.4739 468,-243 488.4022,-229.2816 484.0333,-215.3449 504,-201 508.192,-197.9883 512.8779,-195.3234 517.6733,-192.9908"/>
<polygon fill="#000000" stroke="#000000" points="519.1903,-196.1471 526.929,-188.9108 516.3668,-189.7418 519.1903,-196.1471"/>
</g>
<!-- proc~isave_1d_array_to_hdf5&#45;&gt;h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge34" class="edge">
<title>proc~isave_1d_array_to_hdf5&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M448.2705,-251.9645C465.3299,-247.2195 485.0919,-241.7228 502.9963,-236.7427"/>
<polygon fill="#000000" stroke="#000000" points="504.0268,-240.0891 512.7231,-234.0373 502.1509,-233.3451 504.0268,-240.0891"/>
</g>
<!-- proc~isave_1d_array_to_hdf5&#45;&gt;h5dwrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge36" class="edge">
<title>proc~isave_1d_array_to_hdf5&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M451.123,-276.1023C457.0436,-278.5834 462.8336,-281.5261 468,-285 488.4022,-298.7184 484.0333,-312.6551 504,-327 507.7027,-329.6602 511.7908,-332.0498 515.9993,-334.1789"/>
<polygon fill="#000000" stroke="#000000" points="514.7518,-337.4568 525.3021,-338.4274 517.6598,-331.0894 514.7518,-337.4568"/>
</g>
<!-- proc~isave_1d_array_to_hdf5&#45;&gt;h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge37" class="edge">
<title>proc~isave_1d_array_to_hdf5&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M448.2705,-276.0355C469.0909,-281.8266 493.9369,-288.7374 514.5185,-294.4621"/>
<polygon fill="#000000" stroke="#000000" points="513.6711,-297.8592 524.2433,-297.167 515.547,-291.1152 513.6711,-297.8592"/>
</g>
<!-- h5awrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node24" class="node">
<title>h5awrite_f</title>
<polygon fill="#777777" stroke="#777777" points="586.5,-66 525.5,-66 525.5,-42 586.5,-42 586.5,-66"/>
<text text-anchor="middle" x="556" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5awrite_f</text>
</g>
<!-- proc~isave_1d_array_to_hdf5&#45;&gt;h5awrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge35" class="edge">
<title>proc~isave_1d_array_to_hdf5&#45;&gt;h5awrite_f</title>
<path fill="none" stroke="#000000" d="M456.999,-251.8964C461.0888,-249.4548 464.8475,-246.5222 468,-243 518.9273,-186.1007 454.8628,-133.4521 504,-75 507.3596,-71.0035 511.5934,-67.7599 516.1878,-65.129"/>
<polygon fill="#000000" stroke="#000000" points="517.7993,-68.2385 525.3323,-60.7883 514.7975,-61.9147 517.7993,-68.2385"/>
</g>
<!-- h5aclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node25" class="node">
<title>h5aclose_f</title>
<polygon fill="#777777" stroke="#777777" points="587.5,-24 524.5,-24 524.5,0 587.5,0 587.5,-24"/>
<text text-anchor="middle" x="556" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5aclose_f</text>
</g>
<!-- proc~isave_1d_array_to_hdf5&#45;&gt;h5aclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge32" class="edge">
<title>proc~isave_1d_array_to_hdf5&#45;&gt;h5aclose_f</title>
<path fill="none" stroke="#000000" d="M457.4507,-251.851C461.3927,-249.4174 464.996,-246.4991 468,-243 529.6831,-171.1508 444.576,-106.7286 504,-33 507.0835,-29.1742 510.9722,-26.0407 515.2289,-23.4752"/>
<polygon fill="#000000" stroke="#000000" points="516.9311,-26.5381 524.3427,-18.9672 513.8275,-20.2637 516.9311,-26.5381"/>
</g>
<!-- h5tset_size_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node26" class="node">
<title>h5tset_size_f</title>
<polygon fill="#777777" stroke="#777777" points="593,-150 519,-150 519,-126 593,-126 593,-150"/>
<text text-anchor="middle" x="556" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5tset_size_f</text>
</g>
<!-- proc~isave_1d_array_to_hdf5&#45;&gt;h5tset_size_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge30" class="edge">
<title>proc~isave_1d_array_to_hdf5&#45;&gt;h5tset_size_f</title>
<path fill="none" stroke="#000000" d="M455.0637,-251.8779C459.7599,-249.4397 464.1822,-246.5129 468,-243 497.8897,-215.4975 474.9781,-187.4167 504,-159 505.8566,-157.1822 507.8912,-155.5151 510.0465,-153.9872"/>
<polygon fill="#000000" stroke="#000000" points="512.0315,-156.8789 518.8369,-148.7587 508.453,-150.8626 512.0315,-156.8789"/>
</g>
<!-- h5acreate_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_node27" class="node">
<title>h5acreate_f</title>
<polygon fill="#777777" stroke="#777777" points="590,-108 522,-108 522,-84 590,-84 590,-108"/>
<text text-anchor="middle" x="556" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h5acreate_f</text>
</g>
<!-- proc~isave_1d_array_to_hdf5&#45;&gt;h5acreate_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge38" class="edge">
<title>proc~isave_1d_array_to_hdf5&#45;&gt;h5acreate_f</title>
<path fill="none" stroke="#000000" d="M456.4489,-251.8424C460.7055,-249.4127 464.6512,-246.4976 468,-243 508.2782,-200.9326 465.0465,-160.297 504,-117 506.56,-114.1546 509.56,-111.6878 512.8045,-109.5506"/>
<polygon fill="#000000" stroke="#000000" points="514.7259,-112.4894 521.8297,-104.6289 511.3746,-106.3438 514.7259,-112.4894"/>
</g>
<!-- proc~i2save_to_hdf5&#45;&gt;h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge40" class="edge">
<title>proc~i2save_to_hdf5&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M447.0396,-146.4942C454.6597,-149.4892 462.0611,-153.5355 468,-159 497.8897,-186.5025 474.9781,-214.5833 504,-243 507.2979,-246.2291 511.1576,-248.9824 515.2578,-251.3254"/>
<polygon fill="#000000" stroke="#000000" points="513.9709,-254.5916 524.4937,-255.8246 517.0365,-248.2986 513.9709,-254.5916"/>
</g>
<!-- proc~i2save_to_hdf5&#45;&gt;h5tcopy_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge42" class="edge">
<title>proc~i2save_to_hdf5&#45;&gt;h5tcopy_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-149.6993C468.9088,-155.776 495.4368,-163.1546 516.8448,-169.1091"/>
<polygon fill="#000000" stroke="#000000" points="516.0195,-172.5124 526.5917,-171.8202 517.8954,-165.7684 516.0195,-172.5124"/>
</g>
<!-- proc~i2save_to_hdf5&#45;&gt;h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge43" class="edge">
<title>proc~i2save_to_hdf5&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M447.1619,-148.5159C454.4395,-151.3017 461.6855,-154.7541 468,-159 488.4022,-172.7184 484.0333,-186.6551 504,-201 506.0756,-202.4912 508.2723,-203.8974 510.5434,-205.2203"/>
<polygon fill="#000000" stroke="#000000" points="509.0862,-208.4074 519.5734,-209.9139 512.3146,-202.1963 509.0862,-208.4074"/>
</g>
<!-- proc~i2save_to_hdf5&#45;&gt;h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge45" class="edge">
<title>proc~i2save_to_hdf5&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M447.281,-145.7869C454.9721,-148.8392 462.339,-153.0875 468,-159 508.2782,-201.0674 465.0465,-241.703 504,-285 507.1247,-288.4731 510.9049,-291.382 514.9852,-293.8162"/>
<polygon fill="#000000" stroke="#000000" points="513.7457,-297.1084 524.2588,-298.4216 516.8592,-290.839 513.7457,-297.1084"/>
</g>
<!-- proc~i2save_to_hdf5&#45;&gt;h5awrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge44" class="edge">
<title>proc~i2save_to_hdf5&#45;&gt;h5awrite_f</title>
<path fill="none" stroke="#000000" d="M447.1619,-127.4841C454.4395,-124.6983 461.6855,-121.2459 468,-117 488.4022,-103.2816 484.0333,-89.3449 504,-75 507.7027,-72.3398 511.7908,-69.9502 515.9993,-67.8211"/>
<polygon fill="#000000" stroke="#000000" points="517.6598,-70.9106 525.3021,-63.5726 514.7518,-64.5432 517.6598,-70.9106"/>
</g>
<!-- proc~i2save_to_hdf5&#45;&gt;h5aclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge41" class="edge">
<title>proc~i2save_to_hdf5&#45;&gt;h5aclose_f</title>
<path fill="none" stroke="#000000" d="M447.0396,-129.5058C454.6597,-126.5108 462.0611,-122.4645 468,-117 497.8897,-89.4975 474.9781,-61.4167 504,-33 507.2979,-29.7709 511.1576,-27.0176 515.2578,-24.6746"/>
<polygon fill="#000000" stroke="#000000" points="517.0365,-27.7014 524.4937,-20.1754 513.9709,-21.4084 517.0365,-27.7014"/>
</g>
<!-- proc~i2save_to_hdf5&#45;&gt;h5tset_size_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge39" class="edge">
<title>proc~i2save_to_hdf5&#45;&gt;h5tset_size_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-138C466.2343,-138 489.0118,-138 508.7702,-138"/>
<polygon fill="#000000" stroke="#000000" points="508.7923,-141.5001 518.7922,-138 508.7922,-134.5001 508.7923,-141.5001"/>
</g>
<!-- proc~i2save_to_hdf5&#45;&gt;h5acreate_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge46" class="edge">
<title>proc~i2save_to_hdf5&#45;&gt;h5acreate_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-126.3007C467.3101,-120.6687 491.5794,-113.9183 512.0666,-108.2199"/>
<polygon fill="#000000" stroke="#000000" points="513.0896,-111.5683 521.7859,-105.5165 511.2137,-104.8243 513.0896,-111.5683"/>
</g>
<!-- proc~i1save_to_hdf5&#45;&gt;h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge48" class="edge">
<title>proc~i1save_to_hdf5&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M447.281,-103.7869C454.9721,-106.8392 462.339,-111.0875 468,-117 508.2782,-159.0674 465.0465,-199.703 504,-243 507.1247,-246.4731 510.9049,-249.382 514.9852,-251.8162"/>
<polygon fill="#000000" stroke="#000000" points="513.7457,-255.1084 524.2588,-256.4216 516.8592,-248.839 513.7457,-255.1084"/>
</g>
<!-- proc~i1save_to_hdf5&#45;&gt;h5tcopy_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge50" class="edge">
<title>proc~i1save_to_hdf5&#45;&gt;h5tcopy_f</title>
<path fill="none" stroke="#000000" d="M447.1619,-106.5159C454.4395,-109.3017 461.6855,-112.7541 468,-117 488.4022,-130.7184 484.0333,-144.6551 504,-159 508.192,-162.0117 512.8779,-164.6766 517.6733,-167.0092"/>
<polygon fill="#000000" stroke="#000000" points="516.3668,-170.2582 526.929,-171.0892 519.1903,-163.8529 516.3668,-170.2582"/>
</g>
<!-- proc~i1save_to_hdf5&#45;&gt;h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge51" class="edge">
<title>proc~i1save_to_hdf5&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M447.0396,-104.4942C454.6597,-107.4892 462.0611,-111.5355 468,-117 497.8897,-144.5025 474.9781,-172.5833 504,-201 505.2435,-202.2176 506.5669,-203.3675 507.9529,-204.4533"/>
<polygon fill="#000000" stroke="#000000" points="506.1674,-207.4673 516.4563,-209.995 509.9894,-201.6028 506.1674,-207.4673"/>
</g>
<!-- proc~i1save_to_hdf5&#45;&gt;h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge53" class="edge">
<title>proc~i1save_to_hdf5&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M447.2731,-103.365C455.0585,-106.4475 462.4639,-110.8147 468,-117 518.9273,-173.8993 454.8628,-226.5479 504,-285 507.1247,-288.717 511.0056,-291.7828 515.2294,-294.31"/>
<polygon fill="#000000" stroke="#000000" points="513.7341,-297.4751 524.2487,-298.7771 516.841,-291.2024 513.7341,-297.4751"/>
</g>
<!-- proc~i1save_to_hdf5&#45;&gt;h5awrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge52" class="edge">
<title>proc~i1save_to_hdf5&#45;&gt;h5awrite_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-84.3007C468.4568,-78.3498 494.3411,-71.1501 515.5095,-65.2623"/>
<polygon fill="#000000" stroke="#000000" points="516.4791,-68.6255 525.1755,-62.5737 514.6033,-61.8815 516.4791,-68.6255"/>
</g>
<!-- proc~i1save_to_hdf5&#45;&gt;h5aclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge49" class="edge">
<title>proc~i1save_to_hdf5&#45;&gt;h5aclose_f</title>
<path fill="none" stroke="#000000" d="M447.1619,-85.4841C454.4395,-82.6983 461.6855,-79.2459 468,-75 488.4022,-61.2816 484.0333,-47.3449 504,-33 507.4692,-30.5076 511.2767,-28.2526 515.2046,-26.227"/>
<polygon fill="#000000" stroke="#000000" points="516.8929,-29.302 524.4857,-21.9128 513.9422,-22.9542 516.8929,-29.302"/>
</g>
<!-- proc~i1save_to_hdf5&#45;&gt;h5tset_size_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge47" class="edge">
<title>proc~i1save_to_hdf5&#45;&gt;h5tset_size_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-107.6993C466.3223,-113.0565 489.2208,-119.4257 509.0419,-124.9388"/>
<polygon fill="#000000" stroke="#000000" points="508.22,-128.343 518.7922,-127.6508 510.0959,-121.599 508.22,-128.343"/>
</g>
<!-- proc~i1save_to_hdf5&#45;&gt;h5acreate_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge54" class="edge">
<title>proc~i1save_to_hdf5&#45;&gt;h5acreate_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-96C467.126,-96 491.1384,-96 511.5069,-96"/>
<polygon fill="#000000" stroke="#000000" points="511.7859,-99.5001 521.7859,-96 511.7859,-92.5001 511.7859,-99.5001"/>
</g>
<!-- proc~i4save_to_hdf5&#45;&gt;h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge56" class="edge">
<title>proc~i4save_to_hdf5&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M447.2731,-61.365C455.0585,-64.4475 462.4639,-68.8147 468,-75 518.9273,-131.8993 454.8628,-184.5479 504,-243 507.1247,-246.717 511.0056,-249.7828 515.2294,-252.31"/>
<polygon fill="#000000" stroke="#000000" points="513.7341,-255.4751 524.2487,-256.7771 516.841,-249.2024 513.7341,-255.4751"/>
</g>
<!-- proc~i4save_to_hdf5&#45;&gt;h5tcopy_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge58" class="edge">
<title>proc~i4save_to_hdf5&#45;&gt;h5tcopy_f</title>
<path fill="none" stroke="#000000" d="M447.0396,-62.4942C454.6597,-65.4892 462.0611,-69.5355 468,-75 497.8897,-102.5025 474.9781,-130.5833 504,-159 507.9566,-162.8741 512.7218,-166.0633 517.741,-168.6808"/>
<polygon fill="#000000" stroke="#000000" points="516.3732,-171.9031 526.9301,-172.7991 519.2361,-165.5153 516.3732,-171.9031"/>
</g>
<!-- proc~i4save_to_hdf5&#45;&gt;h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge59" class="edge">
<title>proc~i4save_to_hdf5&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M447.281,-61.7869C454.9721,-64.8392 462.339,-69.0875 468,-75 508.2782,-117.0674 465.0465,-157.703 504,-201 504.8974,-201.9975 505.8489,-202.9484 506.8461,-203.855"/>
<polygon fill="#000000" stroke="#000000" points="505.1004,-206.9134 515.2447,-209.9701 509.2207,-201.2545 505.1004,-206.9134"/>
</g>
<!-- proc~i4save_to_hdf5&#45;&gt;h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge61" class="edge">
<title>proc~i4save_to_hdf5&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M447.1489,-61.0616C455.0393,-64.1627 462.5177,-68.6142 468,-75 529.6831,-146.8492 444.576,-211.2714 504,-285 507.0835,-288.8258 510.9722,-291.9593 515.2289,-294.5248"/>
<polygon fill="#000000" stroke="#000000" points="513.8275,-297.7363 524.3427,-299.0328 516.9311,-291.4619 513.8275,-297.7363"/>
</g>
<!-- proc~i4save_to_hdf5&#45;&gt;h5awrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge60" class="edge">
<title>proc~i4save_to_hdf5&#45;&gt;h5awrite_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-54C468.2632,-54 493.873,-54 514.9336,-54"/>
<polygon fill="#000000" stroke="#000000" points="515.1755,-57.5001 525.1755,-54 515.1754,-50.5001 515.1755,-57.5001"/>
</g>
<!-- proc~i4save_to_hdf5&#45;&gt;h5aclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge57" class="edge">
<title>proc~i4save_to_hdf5&#45;&gt;h5aclose_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-42.3007C468.0601,-36.4601 493.3826,-29.4168 514.3269,-23.5912"/>
<polygon fill="#000000" stroke="#000000" points="515.5225,-26.8916 524.2189,-20.8398 513.6467,-20.1476 515.5225,-26.8916"/>
</g>
<!-- proc~i4save_to_hdf5&#45;&gt;h5tset_size_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge55" class="edge">
<title>proc~i4save_to_hdf5&#45;&gt;h5tset_size_f</title>
<path fill="none" stroke="#000000" d="M447.1619,-64.5159C454.4395,-67.3017 461.6855,-70.7541 468,-75 488.4022,-88.7184 484.0333,-102.6551 504,-117 506.0756,-118.4912 508.2723,-119.8974 510.5434,-121.2203"/>
<polygon fill="#000000" stroke="#000000" points="509.0862,-124.4074 519.5734,-125.9139 512.3146,-118.1963 509.0862,-124.4074"/>
</g>
<!-- proc~i4save_to_hdf5&#45;&gt;h5acreate_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge62" class="edge">
<title>proc~i4save_to_hdf5&#45;&gt;h5acreate_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-65.6993C467.3101,-71.3313 491.5794,-78.0817 512.0666,-83.7801"/>
<polygon fill="#000000" stroke="#000000" points="511.2137,-87.1757 521.7859,-86.4835 513.0896,-80.4317 511.2137,-87.1757"/>
</g>
<!-- proc~i8save_to_hdf5&#45;&gt;h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge64" class="edge">
<title>proc~i8save_to_hdf5&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M447.1489,-19.0616C455.0393,-22.1627 462.5177,-26.6142 468,-33 529.6831,-104.8492 444.576,-169.2714 504,-243 507.0835,-246.8258 510.9722,-249.9593 515.2289,-252.5248"/>
<polygon fill="#000000" stroke="#000000" points="513.8275,-255.7363 524.3427,-257.0328 516.9311,-249.4619 513.8275,-255.7363"/>
</g>
<!-- proc~i8save_to_hdf5&#45;&gt;h5tcopy_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge66" class="edge">
<title>proc~i8save_to_hdf5&#45;&gt;h5tcopy_f</title>
<path fill="none" stroke="#000000" d="M447.281,-19.7869C454.9721,-22.8392 462.339,-27.0875 468,-33 508.2782,-75.0674 465.0465,-115.703 504,-159 507.785,-163.2071 512.532,-166.5863 517.6089,-169.2967"/>
<polygon fill="#000000" stroke="#000000" points="516.4101,-172.5948 526.9673,-173.4875 519.2711,-166.2061 516.4101,-172.5948"/>
</g>
<!-- proc~i8save_to_hdf5&#45;&gt;h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge67" class="edge">
<title>proc~i8save_to_hdf5&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M447.2731,-19.365C455.0585,-22.4475 462.4639,-26.8147 468,-33 518.9273,-89.8993 454.8628,-142.5479 504,-201 504.7205,-201.8571 505.4812,-202.6795 506.277,-203.4687"/>
<polygon fill="#000000" stroke="#000000" points="504.2196,-206.303 514.2513,-209.7111 508.5345,-200.791 504.2196,-206.303"/>
</g>
<!-- proc~i8save_to_hdf5&#45;&gt;h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge69" class="edge">
<title>proc~i8save_to_hdf5&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M447.2862,-18.9454C455.1673,-22.0543 462.6073,-26.5384 468,-33 540.4923,-119.8612 434.2378,-195.9313 504,-285 507.0655,-288.9139 510.977,-292.1019 515.2749,-294.698"/>
<polygon fill="#000000" stroke="#000000" points="513.9753,-297.9593 524.4927,-299.2381 517.0683,-291.6797 513.9753,-297.9593"/>
</g>
<!-- proc~i8save_to_hdf5&#45;&gt;h5awrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge68" class="edge">
<title>proc~i8save_to_hdf5&#45;&gt;h5awrite_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-23.6993C468.4568,-29.6502 494.3411,-36.8499 515.5095,-42.7377"/>
<polygon fill="#000000" stroke="#000000" points="514.6033,-46.1185 525.1755,-45.4263 516.4791,-39.3745 514.6033,-46.1185"/>
</g>
<!-- proc~i8save_to_hdf5&#45;&gt;h5aclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge65" class="edge">
<title>proc~i8save_to_hdf5&#45;&gt;h5aclose_f</title>
<path fill="none" stroke="#000000" d="M447.0619,-12C467.9646,-12 493.1525,-12 514.0411,-12"/>
<polygon fill="#000000" stroke="#000000" points="514.2189,-15.5001 524.2189,-12 514.2188,-8.5001 514.2189,-15.5001"/>
</g>
<!-- proc~i8save_to_hdf5&#45;&gt;h5tset_size_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge63" class="edge">
<title>proc~i8save_to_hdf5&#45;&gt;h5tset_size_f</title>
<path fill="none" stroke="#000000" d="M447.0396,-20.4942C454.6597,-23.4892 462.0611,-27.5355 468,-33 497.8897,-60.5025 474.9781,-88.5833 504,-117 505.8566,-118.8178 507.8912,-120.4849 510.0465,-122.0128"/>
<polygon fill="#000000" stroke="#000000" points="508.453,-125.1374 518.8369,-127.2413 512.0315,-119.1211 508.453,-125.1374"/>
</g>
<!-- proc~i8save_to_hdf5&#45;&gt;h5acreate_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge70" class="edge">
<title>proc~i8save_to_hdf5&#45;&gt;h5acreate_f</title>
<path fill="none" stroke="#000000" d="M447.1619,-22.5159C454.4395,-25.3017 461.6855,-28.7541 468,-33 488.4022,-46.7184 484.0333,-60.6551 504,-75 506.6884,-76.9315 509.5799,-78.7203 512.5732,-80.3703"/>
<polygon fill="#000000" stroke="#000000" points="511.2412,-83.616 521.757,-84.9078 514.3419,-77.3402 511.2412,-83.616"/>
</g>
<!-- proc~rsave_to_hdf5&#45;&gt;h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge72" class="edge">
<title>proc~rsave_to_hdf5&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M444.5158,-189.532C452.6692,-192.4764 460.9201,-196.2395 468,-201 488.4022,-214.7184 484.0333,-228.6551 504,-243 507.4692,-245.4924 511.2767,-247.7474 515.2046,-249.773"/>
<polygon fill="#000000" stroke="#000000" points="513.9422,-253.0458 524.4857,-254.0872 516.8929,-246.698 513.9422,-253.0458"/>
</g>
<!-- proc~rsave_to_hdf5&#45;&gt;h5tcopy_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge74" class="edge">
<title>proc~rsave_to_hdf5&#45;&gt;h5tcopy_f</title>
<path fill="none" stroke="#000000" d="M444.6735,-180C466.851,-180 494.3975,-180 516.5404,-180"/>
<polygon fill="#000000" stroke="#000000" points="516.6114,-183.5001 526.6114,-180 516.6113,-176.5001 516.6114,-183.5001"/>
</g>
<!-- proc~rsave_to_hdf5&#45;&gt;h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge75" class="edge">
<title>proc~rsave_to_hdf5&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M444.6735,-191.035C462.4574,-195.9815 483.6938,-201.8883 502.8277,-207.2104"/>
<polygon fill="#000000" stroke="#000000" points="502.0403,-210.6242 512.6125,-209.932 503.9162,-203.8802 502.0403,-210.6242"/>
</g>
<!-- proc~rsave_to_hdf5&#45;&gt;h5dwrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge77" class="edge">
<title>proc~rsave_to_hdf5&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M444.6709,-186.8C453.2903,-189.903 461.7011,-194.4213 468,-201 508.2782,-243.0674 465.0465,-283.703 504,-327 507.4523,-330.8373 511.7049,-333.9858 516.2782,-336.5664"/>
<polygon fill="#000000" stroke="#000000" points="514.8064,-339.742 525.342,-340.8605 517.8034,-333.416 514.8064,-339.742"/>
</g>
<!-- proc~rsave_to_hdf5&#45;&gt;h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge78" class="edge">
<title>proc~rsave_to_hdf5&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M444.7482,-187.6269C453.1648,-190.6941 461.4673,-194.989 468,-201 497.8897,-228.5025 474.9781,-256.5833 504,-285 507.2979,-288.2291 511.1576,-290.9824 515.2578,-293.3254"/>
<polygon fill="#000000" stroke="#000000" points="513.9709,-296.5916 524.4937,-297.8246 517.0365,-290.2986 513.9709,-296.5916"/>
</g>
<!-- proc~rsave_to_hdf5&#45;&gt;h5awrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge76" class="edge">
<title>proc~rsave_to_hdf5&#45;&gt;h5awrite_f</title>
<path fill="none" stroke="#000000" d="M444.7482,-172.3731C453.1648,-169.3059 461.4673,-165.011 468,-159 497.8897,-131.4975 474.9781,-103.4167 504,-75 507.5109,-71.5623 511.6586,-68.6638 516.0554,-66.2256"/>
<polygon fill="#000000" stroke="#000000" points="517.7683,-69.2871 525.3063,-61.842 514.7708,-62.9613 517.7683,-69.2871"/>
</g>
<!-- proc~rsave_to_hdf5&#45;&gt;h5aclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge73" class="edge">
<title>proc~rsave_to_hdf5&#45;&gt;h5aclose_f</title>
<path fill="none" stroke="#000000" d="M444.6709,-173.2C453.2903,-170.097 461.7011,-165.5787 468,-159 508.2782,-116.9326 465.0465,-76.297 504,-33 507.1247,-29.5269 510.9049,-26.618 514.9852,-24.1838"/>
<polygon fill="#000000" stroke="#000000" points="516.8592,-27.161 524.2588,-19.5784 513.7457,-20.8916 516.8592,-27.161"/>
</g>
<!-- proc~rsave_to_hdf5&#45;&gt;h5tset_size_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge71" class="edge">
<title>proc~rsave_to_hdf5&#45;&gt;h5tset_size_f</title>
<path fill="none" stroke="#000000" d="M444.6735,-168.965C464.4228,-163.4718 488.4297,-156.7944 509.0869,-151.0487"/>
<polygon fill="#000000" stroke="#000000" points="510.229,-154.364 518.9253,-148.3122 508.3531,-147.62 510.229,-154.364"/>
</g>
<!-- proc~rsave_to_hdf5&#45;&gt;h5acreate_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge79" class="edge">
<title>proc~rsave_to_hdf5&#45;&gt;h5acreate_f</title>
<path fill="none" stroke="#000000" d="M444.5158,-170.468C452.6692,-167.5236 460.9201,-163.7605 468,-159 488.4022,-145.2816 484.0333,-131.3449 504,-117 506.6884,-115.0685 509.5799,-113.2797 512.5732,-111.6297"/>
<polygon fill="#000000" stroke="#000000" points="514.3419,-114.6598 521.757,-107.0922 511.2412,-108.384 514.3419,-114.6598"/>
</g>
<!-- proc~rsave_1d_array_to_hdf5&#45;&gt;h5dclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge81" class="edge">
<title>proc~rsave_1d_array_to_hdf5&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M448.2705,-234.0355C469.0909,-239.8266 493.9369,-246.7374 514.5185,-252.4621"/>
<polygon fill="#000000" stroke="#000000" points="513.6711,-255.8592 524.2433,-255.167 515.547,-249.1152 513.6711,-255.8592"/>
</g>
<!-- proc~rsave_1d_array_to_hdf5&#45;&gt;h5tcopy_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge83" class="edge">
<title>proc~rsave_1d_array_to_hdf5&#45;&gt;h5tcopy_f</title>
<path fill="none" stroke="#000000" d="M448.2705,-209.9645C469.8399,-203.9651 495.7296,-196.7639 516.7226,-190.9248"/>
<polygon fill="#000000" stroke="#000000" points="517.8982,-194.2308 526.5945,-188.179 516.0223,-187.4868 517.8982,-194.2308"/>
</g>
<!-- proc~rsave_1d_array_to_hdf5&#45;&gt;h5screate_simple_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge84" class="edge">
<title>proc~rsave_1d_array_to_hdf5&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M468.1627,-222C476.5511,-222 485.1485,-222 493.5252,-222"/>
<polygon fill="#000000" stroke="#000000" points="493.6047,-225.5001 503.6047,-222 493.6047,-218.5001 493.6047,-225.5001"/>
</g>
<!-- proc~rsave_1d_array_to_hdf5&#45;&gt;h5dwrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge86" class="edge">
<title>proc~rsave_1d_array_to_hdf5&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M455.0637,-234.1221C459.7599,-236.5603 464.1822,-239.4871 468,-243 497.8897,-270.5025 474.9781,-298.5833 504,-327 507.5109,-330.4377 511.6586,-333.3362 516.0554,-335.7744"/>
<polygon fill="#000000" stroke="#000000" points="514.7708,-339.0387 525.3063,-340.158 517.7683,-332.7129 514.7708,-339.0387"/>
</g>
<!-- proc~rsave_1d_array_to_hdf5&#45;&gt;h5sclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge87" class="edge">
<title>proc~rsave_1d_array_to_hdf5&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M451.123,-234.1023C457.0436,-236.5834 462.8336,-239.5261 468,-243 488.4022,-256.7184 484.0333,-270.6551 504,-285 507.4692,-287.4924 511.2767,-289.7474 515.2046,-291.773"/>
<polygon fill="#000000" stroke="#000000" points="513.9422,-295.0458 524.4857,-296.0872 516.8929,-288.698 513.9422,-295.0458"/>
</g>
<!-- proc~rsave_1d_array_to_hdf5&#45;&gt;h5awrite_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge85" class="edge">
<title>proc~rsave_1d_array_to_hdf5&#45;&gt;h5awrite_f</title>
<path fill="none" stroke="#000000" d="M456.4489,-209.8424C460.7055,-207.4127 464.6512,-204.4976 468,-201 508.2782,-158.9326 465.0465,-118.297 504,-75 507.4523,-71.1627 511.7049,-68.0142 516.2782,-65.4336"/>
<polygon fill="#000000" stroke="#000000" points="517.8034,-68.584 525.342,-61.1395 514.8064,-62.258 517.8034,-68.584"/>
</g>
<!-- proc~rsave_1d_array_to_hdf5&#45;&gt;h5aclose_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge82" class="edge">
<title>proc~rsave_1d_array_to_hdf5&#45;&gt;h5aclose_f</title>
<path fill="none" stroke="#000000" d="M456.999,-209.8964C461.0888,-207.4548 464.8475,-204.5222 468,-201 518.9273,-144.1007 454.8628,-91.4521 504,-33 507.1247,-29.283 511.0056,-26.2172 515.2294,-23.69"/>
<polygon fill="#000000" stroke="#000000" points="516.841,-26.7976 524.2487,-19.2229 513.7341,-20.5249 516.841,-26.7976"/>
</g>
<!-- proc~rsave_1d_array_to_hdf5&#45;&gt;h5tset_size_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge80" class="edge">
<title>proc~rsave_1d_array_to_hdf5&#45;&gt;h5tset_size_f</title>
<path fill="none" stroke="#000000" d="M451.123,-209.8977C457.0436,-207.4166 462.8336,-204.4739 468,-201 488.4022,-187.2816 484.0333,-173.3449 504,-159 506.0756,-157.5088 508.2723,-156.1026 510.5434,-154.7797"/>
<polygon fill="#000000" stroke="#000000" points="512.3146,-157.8037 519.5734,-150.0861 509.0862,-151.5926 512.3146,-157.8037"/>
</g>
<!-- proc~rsave_1d_array_to_hdf5&#45;&gt;h5acreate_f -->
<g id="proc~~save_simulation_parameters~~CallsGraph_edge88" class="edge">
<title>proc~rsave_1d_array_to_hdf5&#45;&gt;h5acreate_f</title>
<path fill="none" stroke="#000000" d="M455.0637,-209.8779C459.7599,-207.4397 464.1822,-204.5129 468,-201 497.8897,-173.4975 474.9781,-145.4167 504,-117 506.6609,-114.3946 509.6876,-112.0989 512.9112,-110.0786"/>
<polygon fill="#000000" stroke="#000000" points="514.608,-113.1404 521.7888,-105.3502 511.3173,-106.9621 514.608,-113.1404"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~save_simulation_parameters~~CalledByGraph Pages: 1 -->
<svg id="procsave_simulation_parametersCalledByGraph" width="245pt" height="32pt"
 viewBox="0.00 0.00 245.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~save_simulation_parameters~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~save_simulation_parameters~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 241,-28 241,4 -4,4"/>
<!-- proc~save_simulation_parameters -->
<g id="proc~~save_simulation_parameters~~CalledByGraph_node1" class="node">
<title>proc~save_simulation_parameters</title>
<polygon fill="none" stroke="#000000" points="237,-24 90,-24 90,0 237,0 237,-24"/>
<text text-anchor="middle" x="163.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">save_simulation_parameters</text>
</g>
<!-- program~main -->
<g id="proc~~save_simulation_parameters~~CalledByGraph_node2" class="node">
<title>program~main</title>
<g id="a_proc~~save_simulation_parameters~~CalledByGraph_node2"><a xlink:href=".././program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~save_simulation_parameters -->
<g id="proc~~save_simulation_parameters~~CalledByGraph_edge1" class="edge">
<title>program~main&#45;&gt;proc~save_simulation_parameters</title>
<path fill="none" stroke="#000000" d="M54.2947,-12C61.9509,-12 70.6981,-12 79.8342,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.8673,-15.5001 89.8672,-12 79.8672,-8.5001 79.8673,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/save_simulation_parameters.html#src">save_simulation_parameters</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">save_simulation_parameters</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">spp</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
    <span class="c">!! @note Subroutine to save to a HDF5 file all the relevant simulation</span>
    <span class="c">!! parameters. @endnote</span>
    <span class="c">!! This subroutine saves to the HDF5 file &quot;&lt;a&gt;simulation_parameters.h5&lt;/a&gt;&quot;</span>
    <span class="c">!! all the relevant simulation parameters of KORC, most of them being part</span>
    <span class="c">!! of the input file, but also including some derived quantities from the</span>
    <span class="c">!! input parameters. This file is intended to facilitate the</span>
    <span class="c">!! post-processing of KORC data using any software that supports</span>
    <span class="c">!! the HDF5 software.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> 				<span class="kd">::</span> <span class="n">params</span>
    <span class="c">!!Core KORC simulation parameters.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">SPECIES</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">spp</span>
    <span class="c">!! An instance of KORC&#39;s derived type SPECIES containing all</span>
    <span class="c">!! the information of different electron species. See [[korc_types]].</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">FIELDS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> 					<span class="kd">::</span> <span class="n">F</span>
    <span class="c">!! An instance of KORC&#39;s derived type FIELDS containing all the information</span>
    <span class="c">!! about the fields used in the simulation. See [[korc_types]]</span>
    <span class="c">!! and [[korc_fields]].</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">PROFILES</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> 					<span class="kd">::</span> <span class="n">P</span>
    <span class="c">!! An instance of KORC&#39;s derived type PROFILES containing all the</span>
    <span class="c">!! information about the plasma profiles used in the simulation.</span>
    <span class="c">!! See [[korc_types]] and [[korc_profiles]].</span>
    <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">MAX_STRING_LENGTH</span><span class="p">)</span> 				<span class="kd">::</span> <span class="n">filename</span>
    <span class="c">!! String containing the name of the HDF5 file.</span>
    <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">MAX_STRING_LENGTH</span><span class="p">)</span> 				<span class="kd">::</span> <span class="n">gname</span>
    <span class="c">!! String containing the group name of a set of KORC parameters.</span>
    <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">MAX_STRING_LENGTH</span><span class="p">)</span> 				<span class="kd">::</span> <span class="n">dset</span>
    <span class="c">!! Name of data set to be saved to file.</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> 						<span class="kd">::</span> <span class="n">h5file_id</span>
    <span class="c">!!  HDF5 file identifier.</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> 						<span class="kd">::</span> <span class="n">group_id</span>
    <span class="c">!! HDF5 group identifier.</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HSIZE_T</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> 		<span class="kd">::</span> <span class="n">dims</span>
    <span class="c">!! Dimensions of data saved to HDF5 file.</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> 			<span class="kd">::</span> <span class="n">rdata</span>
    <span class="c">!! 1-D array of real data to be saved to HDF5 file.</span>
    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> 				<span class="kd">::</span> <span class="n">idata</span>
    <span class="c">!! 1-D array of integer data to be saved to HDF5 file.</span>
    <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">MAX_STRING_LENGTH</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">attr_array</span>
    <span class="c">!! An 1-D array with attributes of 1-D real or integer arrays that are</span>
    <span class="c">!! passed to KORC interfaces of HDF5 I/O subroutines.</span>
    <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">MAX_STRING_LENGTH</span><span class="p">)</span> 				<span class="kd">::</span> <span class="n">attr</span>
    <span class="c">!!  A single attributes of real or integer data that is passed to KORC</span>
    <span class="c">!! interfaces of HDF5 I/O subroutines.</span>
    <span class="kt">INTEGER</span> 							<span class="kd">::</span> <span class="n">h5error</span>
    <span class="c">!! HDF5 error status.</span>
    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> 						<span class="kd">::</span> <span class="n">tmp_str</span>
    <span class="c">!! Temporary string used to manipulate various strings.</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> 							<span class="kd">::</span> <span class="n">units</span>
    <span class="c">!! Temporary variable used to add physical units to KORC parameters.</span>

    <span class="c">! * * * Error handling * * * !</span>
    <span class="k">call </span><span class="n">h5eset_auto_f</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">HDF5_error_handling</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>
    <span class="c">! Turn off: 0_idef. Turn on: 1_idef</span>

    <span class="k">if</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">params</span><span class="p">%</span><span class="n">restart</span><span class="p">))</span> <span class="k">then</span>

<span class="k">    if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;Saving simulations parameters&quot;)&#39;</span><span class="p">)</span>
    <span class="k">end if</span>

<span class="k">       </span>
<span class="k">       if</span> <span class="p">(</span><span class="n">SIZE</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">outputs_list</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="mi">1_idef</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s1">&#39;(I18)&#39;</span><span class="p">)</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span>
          <span class="n">filename</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_outputs</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;file_&quot;</span>  <span class="p">&amp;</span>
               <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span> <span class="o">//</span> <span class="s2">&quot;.h5&quot;</span>
          <span class="k">call </span><span class="n">h5fcreate_f</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="n">H5F_ACC_TRUNC_F</span><span class="p">,</span> <span class="n">h5file_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>
          <span class="k">call </span><span class="n">h5fclose_f</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>
       <span class="k">end if</span>

<span class="k">       if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          </span><span class="n">filename</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_outputs</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;simulation_parameters.h5&quot;</span>

          <span class="k">call </span><span class="n">h5fcreate_f</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="n">H5F_ACC_TRUNC_F</span><span class="p">,</span> <span class="n">h5file_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>

          <span class="c">! Simulation parameters group</span>
          <span class="n">gname</span> <span class="o">=</span> <span class="s2">&quot;simulation&quot;</span>
          <span class="k">call </span><span class="n">h5gcreate_f</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">),</span> <span class="n">group_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>

          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">idata</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/field_model&quot;</span>
          <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,(</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="o">/</span><span class="p">))</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/profile_model&quot;</span>
          <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,(</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">profile_model</span><span class="o">/</span><span class="p">))</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/simulation_time&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Total aimed simulation time in seconds&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">simulation_time</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/snapshot_frequency&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Time between snapshots in seconds&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">snapshot_frequency</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dt&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Time step in secs&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/t_steps&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Number of time steps&quot;</span>
          <span class="n">idata</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">t_steps</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">idata</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/num_omp_threads&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Number of omp threads&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="n">params</span><span class="p">%</span><span class="n">num_omp_threads</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/output_cadence&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Cadence of output files&quot;</span>
          <span class="n">idata</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">output_cadence</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">idata</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/HDF5_error_handling&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Error handling option: 0=OFF, 1=ON&quot;</span>
          <span class="n">idata</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">HDF5_error_handling</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">idata</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/restart_output_cadence&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Cadence of output files&quot;</span>
          <span class="n">idata</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">restart_output_cadence</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">idata</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/num_snapshots&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Number of outputs for each variable&quot;</span>
          <span class="n">idata</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">num_snapshots</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">idata</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/num_species&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Number of particle species&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">num_species</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/nmpi&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Number of mpi processes&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/minimum_particle_energy&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Minimum energy of simulated particles in eV&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">minimum_particle_energy</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">energy</span><span class="o">/</span><span class="n">C_E</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/minimum_particle_g&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Minimum relativistic factor gamma of simulated particles&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">minimum_particle_g</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/radiation&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Radiation losses included in simulation&quot;</span>
          <span class="k">if</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">radiation</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="mi">0_idef</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
          <span class="k">end if</span>

<span class="k">          </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/collisions&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Collisions included in simulation&quot;</span>
          <span class="k">if</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">collisions</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="mi">0_idef</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
          <span class="k">end if</span>

<span class="k">          </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/outputs_list&quot;</span>
          <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">outputs_list</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/orbit_model&quot;</span>
          <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,(</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="o">/</span><span class="p">))</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/field_eval&quot;</span>
          <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,(</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="o">/</span><span class="p">))</span>

          <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span>
          <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="k">call </span><span class="n">h5gclose_f</span><span class="p">(</span><span class="n">group_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>


          <span class="c">! Plasma species group</span>
          <span class="n">gname</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span>
          <span class="k">call </span><span class="n">h5gcreate_f</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">),</span> <span class="n">group_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>

          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">num_species</span><span class="p">))</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/spatial_distribution&quot;</span>
          <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">spatial_distribution</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/energy_distribution&quot;</span>
          <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">energy_distribution</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/pitch_distribution&quot;</span>
          <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">pitch_distribution</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/ppp&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Particles per (mpi) process&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">ppp</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/q&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Electric charge&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">q</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">charge</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/m&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Species mass in kg&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">m</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">mass</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Eo&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Initial (average) energy in eV&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">Eo</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">energy</span><span class="o">/</span><span class="n">C_E</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/go&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Initial relativistic g factor.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">go</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/etao&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Initial pitch angle in degrees&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">etao</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/wc&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Average relativistic cyclotron frequency in Hz&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">wc_r</span><span class="o">/</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Ro&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Initial radial position of population&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">Ro</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/PHIo&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Azimuthal angle in degrees.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">PHIo</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="mi">18</span><span class="mf">0.0_rp</span><span class="o">/</span><span class="n">C_PI</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Zo&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Initial Z position of population&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">Zo</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/ri&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Inner radius of initial spatial distribution&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">r_inner</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/ro&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Outter radius of initial spatial distribution&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">r_outter</span><span class="o">*</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/falloff_rate&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Falloff of gaussian or exponential radial &amp;</span>
<span class="s2">               profile in m&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">falloff_rate</span><span class="o">/</span> <span class="p">&amp;</span>
               <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/shear_factor&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Shear factor (in case ELLIPTIC-TORUS  &amp;</span>
<span class="s2">               spatial distribution is used.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">shear_factor</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/sigmaR&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Variance of first dimension of 2D spatial &amp; </span>
<span class="s2">               distribution.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">spp</span><span class="p">%</span><span class="n">sigmaR</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/sigmaZ&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Variance of second dimension of 2D spatial &amp;</span>
<span class="s2">               distribution.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">spp</span><span class="p">%</span><span class="n">sigmaZ</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/theta_gauss&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Angle of rotation of 2D spatial distribution.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">theta_gauss</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/psi_max&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Indicator function level of the argument of &amp;</span>
<span class="s2">               the 2D gaussian exponential.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">psi_max</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dth&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Variance of sampling normal variate for pitch angle.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">dth</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dgam&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Variance of sampling normal variate for gamma.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">dgam</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dR&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Variance of sampling normal variate for R.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">dR</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">attr_array</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dZ&quot;</span>
          <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Variance of sampling normal variate for Z.&quot;</span>
          <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">spp</span><span class="p">%</span><span class="n">dZ</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">attr_array</span><span class="p">)</span>
          
          <span class="k">call </span><span class="n">h5gclose_f</span><span class="p">(</span><span class="n">group_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>

          <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">)</span>


          <span class="c">! Plasma profiles group</span>
<span class="c">!          if (params%collisions) then</span>
             <span class="n">gname</span> <span class="o">=</span> <span class="s2">&quot;profiles&quot;</span>
             <span class="k">call </span><span class="n">h5gcreate_f</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">),</span> <span class="n">group_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/density_profile&quot;</span>
             <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,(</span><span class="o">/</span><span class="n">P</span><span class="p">%</span><span class="n">ne_profile</span><span class="o">/</span><span class="p">))</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/temperature_profile&quot;</span>
             <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,(</span><span class="o">/</span><span class="n">P</span><span class="p">%</span><span class="n">Te_profile</span><span class="o">/</span><span class="p">))</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Zeff_profile&quot;</span>
             <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,(</span><span class="o">/</span><span class="n">P</span><span class="p">%</span><span class="n">Zeff_profile</span><span class="o">/</span><span class="p">))</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/neo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Density at the magnetic axis (m^-3)&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">neo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Teo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Temperature at the magnetic axis (eV)&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">Teo</span><span class="o">*</span> <span class="p">&amp;</span>
                  <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">temperature</span><span class="o">/</span><span class="n">C_E</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Zeffo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Zeff at the magnetic axis&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">Zeffo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="k">if</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">profile_model</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="s1">&#39;ANALYTICAL&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/n_ne&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Exponent of tanh(x)^n for density profile&quot;</span>
                <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">n_ne</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/a_ne&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Coefficients f=ao+a1*r+a2*r^2+a3*r^3.  &amp;</span>
<span class="s2">                     a_ne=[a0,a1,a2,a3]&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">a_ne</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/n_Te&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Exponent of tanh(x)^n for density profile&quot;</span>
                <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">n_Te</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/a_Te&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Coefficients f=ao+a1*r+a2*r^2+a3*r^3.  &amp;</span>
<span class="s2">                     a_Te=[a0,a1,a2,a3]&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">a_Te</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/n_Zeff&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Exponent of tanh(x)^n for Zeff profile&quot;</span>
                <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">n_Zeff</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/a_Zeff&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Coefficients f=ao+a1*r+a2*r^2+a3*r^3.  &amp;</span>
<span class="s2">                     a_Zeff=[a0,a1,a2,a3]&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">a_Zeff</span><span class="p">)</span>

                <span class="k">if</span>  <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">)</span> <span class="k">then</span>

<span class="k">                   ALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dims&quot;</span>
                   <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Mesh dimension of the profile (NR,NPHI,NZ)&quot;</span>
                   <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/R&quot;</span>
                   <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Radial position of the magnetic field grid nodes&quot;</span>
                   <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">R</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

                   <span class="k">if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                      </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/PHI&quot;</span>
                      <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Azimuthal angle of the magnetic &amp;</span>
<span class="s2">                           field grid nodes&quot;</span>
                      <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>
                   <span class="k">end if</span>
<span class="k">                   </span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Z&quot;</span>
                   <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Z position of the magnetic field grid nodes&quot;</span>
                   <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">Z</span><span class="o">*</span> <span class="p">&amp;</span>
                        <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/ne&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">ne_2D</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Te&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">temperature</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">Te_2D</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Zeff&quot;</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">P</span><span class="p">%</span><span class="n">Zeff_2D</span><span class="p">)</span>

                   <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">)</span>
                <span class="k">end if</span>
<span class="k">                </span>
<span class="k">             else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">profile_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="s1">&#39;EXTERNAL&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                ALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dims&quot;</span>
                <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Mesh dimension of the profiles (NR,NPHI,NZ)&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/R&quot;</span>
                <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Grid nodes of profiles along the &amp;</span>
<span class="s2">                     radial position&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">P</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">R</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/PHI&quot;</span>
                   <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Grid nodes of profiles along the &amp;</span>
<span class="s2">                        azimuthal position&quot;</span>
                   <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">P</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>
                <span class="k">end if</span>

<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Z&quot;</span>
                <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Grid nodes of profiles along the Z position&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">P</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">Z</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/ne&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">ne_2D</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Te&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">temperature</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">Te_2D</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Zeff&quot;</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">P</span><span class="p">%</span><span class="n">Zeff_2D</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">profile_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;H&#39;</span><span class="p">)</span> <span class="k">then</span>

<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/RHON&quot;</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">P</span><span class="p">%</span><span class="n">RHON</span><span class="p">)</span>
                   
                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/nRE&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">nRE_2D</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/nAr0&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">nAr0_2D</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/nAr1&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">nAr1_2D</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/nAr2&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">nAr2_2D</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/nAr3&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">nAr3_2D</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/nD&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">nD_2D</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/nD1&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">P</span><span class="p">%</span><span class="n">nD1_2D</span><span class="p">)</span>
                   
                <span class="n">endif</span>

                <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">)</span>
             <span class="k">else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">profile_model</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="s1">&#39;UNIFORM&#39;</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">! Something</span>
             <span class="k">end if</span>

<span class="k">             call </span><span class="n">h5gclose_f</span><span class="p">(</span><span class="n">group_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>
          <span class="c">!end if</span>


          <span class="c">! Electromagnetic fields group</span>

          <span class="n">gname</span> <span class="o">=</span> <span class="s2">&quot;fields&quot;</span>
          <span class="k">call </span><span class="n">h5gcreate_f</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">),</span> <span class="n">group_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>

          <span class="k">if</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">))</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="s1">&#39;ANALYTICAL&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Bo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Toroidal field at the magnetic axis in T&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Bo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/current_direction&quot;</span>
             <span class="k">call </span><span class="n">save_string_parameter</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="p">(</span><span class="o">/</span><span class="n">F</span><span class="p">%</span><span class="n">AB</span><span class="p">%</span><span class="n">current_direction</span><span class="o">/</span><span class="p">))</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/a&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Minor radius in m&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">AB</span><span class="p">%</span><span class="n">a</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Ro&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Magnetic axis radial position&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Ro</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Zo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Magnetic axis vertical position&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Zo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
             
             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/qa&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Safety factor at minor radius&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">AB</span><span class="p">%</span><span class="n">qa</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/qo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Safety factor at the magnetic axis&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">AB</span><span class="p">%</span><span class="n">qo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/lambda&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Parameter lamda in m&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">AB</span><span class="p">%</span><span class="n">lambda</span><span class="o">*</span> <span class="p">&amp;</span>
                  <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Bpo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Poloidal magnetic field in T&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">AB</span><span class="p">%</span><span class="n">Bpo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
             
             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Eo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Electric field at the magnetic axis in V/m&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Eo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">SC_E</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dt_E_SC&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Time step for self-consistent E calculation&quot;</span>
                <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">dt_E_SC</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Ip_exp&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Scaling for self-consistent current density&quot;</span>
                <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Ip_exp</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Ip0&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Total RE current normalization&quot;</span>
                <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Ip0</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
                
                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/r_1D&quot;</span>
                <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;1D minor radial mesh for &amp;</span>
<span class="s2">                     self-consistent fields&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">r_1D</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>
                <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">)</span>
             <span class="k">end if</span>
<span class="k">             </span>
<span class="k">             if</span>  <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_eval</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;interp&#39;</span><span class="p">)</span> <span class="k">then</span>

<span class="k">                ALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dims&quot;</span>
                <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Mesh dimension of the magnetic  &amp;</span>
<span class="s2">                     field (NR,NPHI,NZ)&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/R&quot;</span>
                <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Radial position of the magnetic field grid nodes&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">R</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/PHI&quot;</span>
                   <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Azimuthal angle of the magnetic &amp;</span>
<span class="s2">                        field grid nodes&quot;</span>
                   <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>
                <span class="k">end if</span>

<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Z&quot;</span>
                <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Z position of the magnetic field grid nodes&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">Z</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">PSIp</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/psi_p&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="o">**</span><span class="mi">2</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">PSIp</span><span class="p">)</span>
                <span class="k">end if</span>
<span class="k">                </span>
<span class="k">                if</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">12</span><span class="p">:</span><span class="mi">13</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                </span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BR&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_2D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BPHI&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BZ&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
                   
                   <span class="k">if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">FLAG2D</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                      </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Flag&quot;</span>
                      <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">F</span><span class="p">%</span><span class="n">FLAG2D</span><span class="p">)</span>
                   <span class="k">end if</span>
<span class="k">                </span>
<span class="k">                   if</span>  <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;pre&#39;</span><span class="p">)</span> <span class="k">then</span>

<span class="k">                      </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBR&quot;</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_2D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                      <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBPHI&quot;</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                      <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBZ&quot;</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>

                      <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbR&quot;</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_2D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                      <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbPHI&quot;</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                      <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbZ&quot;</span>
                      <span class="n">units</span> <span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>

                   <span class="k">end if</span>

<span class="k">                else if</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">12</span><span class="p">:</span><span class="mi">13</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;3D&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                </span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BR&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                   <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_3D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BPHI&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                   <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_3D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BZ&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                   <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_3D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
                   
                   <span class="k">if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">FLAG3D</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                      </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Flag&quot;</span>
                      <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">F</span><span class="p">%</span><span class="n">FLAG3D</span><span class="p">)</span>
                   <span class="k">end if</span>
<span class="k">                </span>
<span class="k">                   if</span>  <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;pre&#39;</span><span class="p">)</span> <span class="k">then</span>

<span class="k">                      </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBR&quot;</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_3D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                      <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBPHI&quot;</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_3D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                      <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBZ&quot;</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_3D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>

                      <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbR&quot;</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_3D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                      <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbPHI&quot;</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_3D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                      <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbZ&quot;</span>
                      <span class="n">units</span> <span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                      <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_3D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>

                   <span class="k">end if</span>
<span class="k">                end if</span>
<span class="k">                   </span>
<span class="k">                DEALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">          else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="s1">&#39;EXTERNAL&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             ALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
             
             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dims&quot;</span>
             <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Mesh dimension of the magnetic  &amp;</span>
<span class="s2">                  field (NR,NPHI,NZ)&quot;</span>
             <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/R&quot;</span>
             <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Radial position of the magnetic field grid nodes&quot;</span>
             <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">R</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

             <span class="k">if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                if</span> <span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">Dim2x1t</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/PHI&quot;</span>
                   <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Azimuthal angle of the magnetic &amp;</span>
<span class="s2">                        field grid nodes&quot;</span>
                   <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>
                <span class="k">else</span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/PHI&quot;</span>
                   <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Azimuthal angle of the magnetic &amp;</span>
<span class="s2">                        field grid nodes&quot;</span>
                   <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">PHI</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>
                <span class="k">end if</span>
<span class="k">             end if</span>

<span class="k">             </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Z&quot;</span>
             <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;Z position of the magnetic field grid nodes&quot;</span>
             <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">Z</span><span class="o">*</span> <span class="p">&amp;</span>
                  <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Bo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Toroidal field at the magnetic axis in T&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Bo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Eo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Electric field at the magnetic axis in V/m&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Eo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/E_dyn&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Magnitude of dynamic E&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">E_dyn</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
             
             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/E_pulse&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Magnitude of dynamic E&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">E_pulse</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/E_width&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Magnitude of dynamic E&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">E_width</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
             
             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Ro&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Radial position of magnetic axis&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Ro</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Zo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Radial position of magnetic axis&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Zo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/PSIP0&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Poloidal flux at magnetic axis&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">F</span><span class="p">%</span><span class="n">PSIP_min</span><span class="o">*</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/PSIPlim&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Poloidal flux at LCFS&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">F</span><span class="p">%</span><span class="n">PSIp_lim</span><span class="o">*</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/PSIP_conv&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Scaling factor fof poloidal flux function&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">F</span><span class="p">%</span><span class="n">psip_conv</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
             
             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Axisymmetric&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Radial position of magnetic axis&quot;</span>
             <span class="k">if</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
             <span class="k">else</span>
<span class="k">                call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="mi">0_idef</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">PSIp</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/psi_p&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="o">**</span><span class="mi">2</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">PSIp</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">E_3D</span><span class="p">%</span><span class="n">R</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/ER&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E_3D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>
             <span class="k">end if</span>
<span class="k">             </span>
<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">E_3D</span><span class="p">%</span><span class="n">PHI</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/EPHI&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E_3D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">E_3D</span><span class="p">%</span><span class="n">Z</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/EZ&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E_3D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
             <span class="k">end if</span>
<span class="k">             </span>
<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">PSIp3D</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/psi_p3D&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="o">**</span><span class="mi">2</span>
                <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">PSIp3D</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">FLAG2D</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Flag2D&quot;</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">F</span><span class="p">%</span><span class="n">FLAG2D</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">FLAG3D</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Flag3D&quot;</span>
                <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">F</span><span class="p">%</span><span class="n">FLAG3D</span><span class="p">)</span>
             <span class="k">end if</span>


<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2D</span><span class="p">%</span><span class="n">R</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BR1_Re&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BPHI1_Re&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BZ1_Re&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2D</span><span class="p">%</span><span class="n">R</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BR1_Im&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BPHI1_Im&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BZ1_Im&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2DX</span><span class="p">%</span><span class="n">X</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BX1_Re&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2DX</span><span class="p">%</span><span class="n">X</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2DX</span><span class="p">%</span><span class="n">Y</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BY1_Re&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2DX</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2DX</span><span class="p">%</span><span class="n">Z</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BZ1_Re&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Re_2DX</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
             <span class="n">endif</span>

             <span class="k">if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2DX</span><span class="p">%</span><span class="n">X</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BX1_Im&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2DX</span><span class="p">%</span><span class="n">X</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2DX</span><span class="p">%</span><span class="n">Y</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BY1_Im&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2DX</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2DX</span><span class="p">%</span><span class="n">Z</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BZ1_Im&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B1Im_2DX</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
             <span class="n">endif</span>
             
             <span class="k">if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">E1Re_2DX</span><span class="p">%</span><span class="n">X</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/EX1_Re&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E1Re_2DX</span><span class="p">%</span><span class="n">X</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">E1Re_2DX</span><span class="p">%</span><span class="n">Y</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/EY1_Re&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E1Re_2DX</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">E1Re_2DX</span><span class="p">%</span><span class="n">Z</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/EZ1_Re&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E1Re_2DX</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
             <span class="n">endif</span>

             <span class="k">if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">E1Im_2DX</span><span class="p">%</span><span class="n">X</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/EX1_Im&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E1Im_2DX</span><span class="p">%</span><span class="n">X</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">E1Im_2DX</span><span class="p">%</span><span class="n">Y</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/EY1_Im&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E1Im_2DX</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span>
             <span class="k">end if</span>

<span class="k">             if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">E1Im_2DX</span><span class="p">%</span><span class="n">Z</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/EZ1_Im&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E1Im_2DX</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
             <span class="n">endif</span>
             
             <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">SC_E</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/dt_E_SC&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Time step for self-consistent E calculation&quot;</span>
                <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">dt_E_SC</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Ip_exp&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Scaling for self-consistent current density&quot;</span>
                <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Ip_exp</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Ip0&quot;</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Total RE current normalization&quot;</span>
                <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Ip0</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
                
                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/PSIP_1D&quot;</span>
                <span class="n">attr_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;1D minor radial mesh for &amp;</span>
<span class="s2">                     self-consistent fields&quot;</span>
                <span class="k">call </span><span class="n">save_1d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">PSIP_1D</span><span class="p">,</span><span class="n">attr_array</span><span class="p">)</span>
             <span class="k">end if</span>
<span class="k">             </span>
<span class="k">             if</span>  <span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;PSI&#39;</span><span class="p">))</span> <span class="k">then</span>

<span class="k">                if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B_2D</span><span class="p">%</span><span class="n">R</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BR&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_2D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>
                <span class="k">end if</span>

<span class="k">                if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BPHI&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>
                <span class="k">end if</span>

<span class="k">                if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">B_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BZ&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
                <span class="k">end if</span>
<span class="k">                </span>
<span class="k">                if</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">E_2D</span><span class="p">%</span><span class="n">R</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/ER&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E_2D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/EPHI&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/EZ&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">E_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>
                <span class="n">endif</span>

                <span class="k">if</span>  <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;pre&#39;</span><span class="p">)</span> <span class="k">then</span>

<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBR&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_2D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBPHI&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBZ&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbR&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_2D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbPHI&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_2D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbZ&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_2d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_2D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>

                <span class="k">end if</span>
<span class="k">                </span>
<span class="k">             else if</span> <span class="p">((.</span><span class="nb">not</span><span class="p">.</span><span class="n">F</span><span class="p">%</span><span class="n">axisymmetric_fields</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="p">.</span><span class="nb">not</span><span class="p">.((</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;PSI&#39;</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;MARS&#39;</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">14</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;AORSA&#39;</span><span class="p">)))</span> <span class="k">then</span>

<span class="k">                </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BR&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_3D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BPHI&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_3D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/BZ&quot;</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span>
                <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">B_3D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>

                <span class="k">if</span>  <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;pre&#39;</span><span class="p">)</span> <span class="k">then</span>

<span class="k">                   </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBR&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_3D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBPHI&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_3D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/gradBZ&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">gradB_3D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbR&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_3D</span><span class="p">%</span><span class="n">R</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbPHI&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_3D</span><span class="p">%</span><span class="n">PHI</span><span class="p">)</span>

                   <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/curlbZ&quot;</span>
                   <span class="n">units</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span>
                   <span class="k">call </span><span class="n">rsave_3d_array_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">units</span><span class="o">*</span><span class="n">F</span><span class="p">%</span><span class="n">curlb_3D</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span>

                <span class="k">end if</span>
<span class="k">             end if</span>
<span class="k">             </span>
<span class="k">             DEALLOCATE</span><span class="p">(</span><span class="n">attr_array</span><span class="p">)</span>
          <span class="k">else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">field_model</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="s1">&#39;UNIFORM&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Bo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Magnetic field in T&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Bo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

             <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/Eo&quot;</span>
             <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Electric field in V/m&quot;</span>
             <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">F</span><span class="p">%</span><span class="n">Eo</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
          <span class="k">end if</span>

<span class="k">          call </span><span class="n">h5gclose_f</span><span class="p">(</span><span class="n">group_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>


          <span class="c">! Characteristic scales</span>
          <span class="n">gname</span> <span class="o">=</span> <span class="s2">&quot;scales&quot;</span>
          <span class="k">call </span><span class="n">h5gcreate_f</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">),</span> <span class="n">group_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/t&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic time in secs&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="nb">time</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/m&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic mass in kg&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">mass</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/q&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic charge in Coulombs&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">charge</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/l&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic length in m&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">length</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/v&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic velocity in m&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">velocity</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/K&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic kinetic energy in J&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/n&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic plasma density in m^-3&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">density</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/E&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic electric field in V/m&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Eo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/B&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic magnetic field in T&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">Bo</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/P&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic pressure in Pa&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">pressure</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="n">dset</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">gname</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;/T&quot;</span>
          <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;Characteristic plasma temperature in J&quot;</span>
          <span class="k">call </span><span class="n">save_to_hdf5</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">cpp</span><span class="p">%</span><span class="n">temperature</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>

          <span class="k">call </span><span class="n">h5gclose_f</span><span class="p">(</span><span class="n">group_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>

          <span class="k">call </span><span class="n">h5fclose_f</span><span class="p">(</span><span class="n">h5file_id</span><span class="p">,</span> <span class="n">h5error</span><span class="p">)</span>
       <span class="k">end if</span>

<span class="k">    end if</span>
<span class="k">  end subroutine </span><span class="n">save_simulation_parameters</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2022 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> KORC was developed by Matt Beidler</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>