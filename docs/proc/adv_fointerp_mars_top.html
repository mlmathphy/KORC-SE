<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Kinetic Orbit Runaway electrons Code (KORC)">
    
    <meta name="author" content="Matt Beidler" >
    <link rel="icon" href="../favicon.png">

    <title>adv_FOinterp_mars_top &ndash; KORC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">KORC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>README</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>adv_FOinterp_mars_top
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.4% of total for procedures.">109 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/korc_ppusher.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/korc_ppusher.f90.html'>korc_ppusher.f90</a></li>
    
     <li><a href='../module/korc_ppusher.html'>korc_ppusher</a></li>
    
  
     <li class="active">adv_FOinterp_mars_top</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/adv_fointerp_mars_top.html#src">adv_FOinterp_mars_top</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine adv_FOinterp_mars_top(params, F, P, spp)
    
    
   
</h2>
    
  


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-params~82"></span>type(KORC_PARAMS),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>params</strong></td><td><p>Core KORC simulation parameters.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f~32"></span>type(FIELDS),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>F</strong></td><td><p>An instance of the KORC derived type FIELDS.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-p~32"></span>type(PROFILES),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>P</strong></td><td><p>An instance of the KORC derived type PROFILES.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-spp~34"></span>type(SPECIES),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>spp</strong></td><td><p>An instance of the derived type SPECIES containing all the parameters
 and simulation variables of the different species in the simulation.</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~adv_fointerp_mars_top~~CallsGraph Pages: 1 -->
<svg id="procadv_fointerp_mars_topCallsGraph" width="641pt" height="465pt"
 viewBox="0.00 0.00 641.00 465.28" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~adv_fointerp_mars_top~~CallsGraph" class="graph" transform="scale(.6187 .6187) rotate(0) translate(4 748)">
<title>proc~~adv_fointerp_mars_top~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-748 1032,-748 1032,4 -4,4"/>
<!-- proc~adv_fointerp_mars_top -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node1" class="node">
<title>proc~adv_fointerp_mars_top</title>
<polygon fill="none" stroke="#000000" points="126,-511 0,-511 0,-487 126,-487 126,-511"/>
<text text-anchor="middle" x="63" y="-496.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">adv_FOinterp_mars_top</text>
</g>
<!-- proc~advance_fointerp_vars -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node2" class="node">
<title>proc~advance_fointerp_vars</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node2"><a xlink:href=".././proc/advance_fointerp_vars.html" xlink:title="advance_FOinterp_vars">
<polygon fill="#d9534f" stroke="#d9534f" points="287,-511 162,-511 162,-487 287,-487 287,-511"/>
<text text-anchor="middle" x="224.5" y="-496.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advance_FOinterp_vars</text>
</a>
</g>
</g>
<!-- proc~adv_fointerp_mars_top&#45;&gt;proc~advance_fointerp_vars -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge1" class="edge">
<title>proc~adv_fointerp_mars_top&#45;&gt;proc~advance_fointerp_vars</title>
<path fill="none" stroke="#000000" d="M126.3656,-499C134.6585,-499 143.2082,-499 151.642,-499"/>
<polygon fill="#000000" stroke="#000000" points="151.8468,-502.5001 161.8468,-499 151.8468,-495.5001 151.8468,-502.5001"/>
</g>
<!-- cart_to_cyl_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node3" class="node">
<title>cart_to_cyl_p</title>
<polygon fill="#777777" stroke="#777777" points="630,-731 555,-731 555,-707 630,-707 630,-731"/>
<text text-anchor="middle" x="592.5" y="-716.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cart_to_cyl_p</text>
</g>
<!-- proc~adv_fointerp_mars_top&#45;&gt;cart_to_cyl_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge2" class="edge">
<title>proc~adv_fointerp_mars_top&#45;&gt;cart_to_cyl_p</title>
<path fill="none" stroke="#000000" d="M89.2927,-511.0688C159.8739,-543.2773 359.6952,-633.2182 530,-698 534.8897,-699.86 540.0256,-701.7252 545.1638,-703.5344"/>
<polygon fill="#000000" stroke="#000000" points="544.389,-706.9697 554.9838,-706.9287 546.6758,-700.3538 544.389,-706.9697"/>
</g>
<!-- proc~interp_fofields_mars_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node4" class="node">
<title>proc~interp_fofields_mars_p</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node4"><a xlink:href=".././proc/interp_fofields_mars_p.html" xlink:title="interp_FOfields_mars_p">
<polygon fill="#d9534f" stroke="#d9534f" points="655,-77 530,-77 530,-53 655,-53 655,-77"/>
<text text-anchor="middle" x="592.5" y="-62.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_FOfields_mars_p</text>
</a>
</g>
</g>
<!-- proc~adv_fointerp_mars_top&#45;&gt;proc~interp_fofields_mars_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge3" class="edge">
<title>proc~adv_fointerp_mars_top&#45;&gt;proc~interp_fofields_mars_p</title>
<path fill="none" stroke="#000000" d="M76.3179,-486.9084C130.8501,-437.5964 343.0614,-247.6414 530,-107 541.1282,-98.6278 553.817,-89.951 564.8407,-82.6726"/>
<polygon fill="#000000" stroke="#000000" points="566.8072,-85.5687 573.263,-77.1679 562.9774,-79.7092 566.8072,-85.5687"/>
</g>
<!-- proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node7" class="node">
<title>proc~include_coulombcollisions_fo_p</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node7"><a xlink:href=".././proc/include_coulombcollisions_fo_p.html" xlink:title="include_CoulombCollisions_FO_p">
<polygon fill="#d9534f" stroke="#d9534f" points="494,-542 323,-542 323,-518 494,-518 494,-542"/>
<text text-anchor="middle" x="408.5" y="-527.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">include_CoulombCollisions_FO_p</text>
</a>
</g>
</g>
<!-- proc~advance_fointerp_vars&#45;&gt;proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge5" class="edge">
<title>proc~advance_fointerp_vars&#45;&gt;proc~include_coulombcollisions_fo_p</title>
<path fill="none" stroke="#000000" d="M287.0508,-509.5384C299.919,-511.7065 313.6466,-514.0193 327.07,-516.2808"/>
<polygon fill="#000000" stroke="#000000" points="326.8139,-519.7869 337.2564,-517.997 327.9769,-512.8842 326.8139,-519.7869"/>
</g>
<!-- proc~radiation_force_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node9" class="node">
<title>proc~radiation_force_p</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node9"><a xlink:href=".././proc/radiation_force_p.html" xlink:title="radiation_force_p">
<polygon fill="#d9534f" stroke="#d9534f" points="455.5,-500 361.5,-500 361.5,-476 455.5,-476 455.5,-500"/>
<text text-anchor="middle" x="408.5" y="-485.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">radiation_force_p</text>
</a>
</g>
</g>
<!-- proc~advance_fointerp_vars&#45;&gt;proc~radiation_force_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge4" class="edge">
<title>proc~advance_fointerp_vars&#45;&gt;proc~radiation_force_p</title>
<path fill="none" stroke="#000000" d="M287.0508,-495.2606C307.817,-494.0191 330.8211,-492.6438 351.1734,-491.4271"/>
<polygon fill="#000000" stroke="#000000" points="351.4649,-494.916 361.2382,-490.8254 351.0471,-487.9285 351.4649,-494.916"/>
</g>
<!-- ezspline_error -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node5" class="node">
<title>ezspline_error</title>
<polygon fill="#777777" stroke="#777777" points="809,-108 730,-108 730,-84 809,-84 809,-108"/>
<text text-anchor="middle" x="769.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_error</text>
</g>
<!-- proc~interp_fofields_mars_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge8" class="edge">
<title>proc~interp_fofields_mars_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M655.402,-76.0167C676.5558,-79.7216 699.8446,-83.8005 719.8356,-87.3017"/>
<polygon fill="#000000" stroke="#000000" points="719.5063,-90.7972 729.9602,-89.075 720.714,-83.9022 719.5063,-90.7972"/>
</g>
<!-- ezspline_interp -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node6" class="node">
<title>ezspline_interp</title>
<polygon fill="#777777" stroke="#777777" points="811,-66 728,-66 728,-42 811,-42 811,-66"/>
<text text-anchor="middle" x="769.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_interp</text>
</g>
<!-- proc~interp_fofields_mars_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge6" class="edge">
<title>proc~interp_fofields_mars_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M655.402,-61.0908C675.785,-59.8241 698.1502,-58.4342 717.6373,-57.2231"/>
<polygon fill="#000000" stroke="#000000" points="718.0735,-60.7028 727.8371,-56.5892 717.6392,-53.7163 718.0735,-60.7028"/>
</g>
<!-- proc~check_if_in_fields_domain_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node8" class="node">
<title>proc~check_if_in_fields_domain_p</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node8"><a xlink:href=".././proc/check_if_in_fields_domain_p.html" xlink:title="check_if_in_fields_domain_p">
<polygon fill="#d9534f" stroke="#d9534f" points="843,-24 696,-24 696,0 843,0 843,-24"/>
<text text-anchor="middle" x="769.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_if_in_fields_domain_p</text>
</a>
</g>
</g>
<!-- proc~interp_fofields_mars_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge7" class="edge">
<title>proc~interp_fofields_mars_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M627.921,-52.993C646.6093,-46.7849 669.9658,-39.2255 691,-33 698.1485,-30.8842 705.6907,-28.7472 713.1594,-26.6877"/>
<polygon fill="#000000" stroke="#000000" points="714.1688,-30.0403 722.8962,-24.0334 712.3277,-23.2868 714.1688,-30.0403"/>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;cart_to_cyl_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge18" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;cart_to_cyl_p</title>
<path fill="none" stroke="#000000" d="M420.5198,-542.2177C438.0036,-560.3741 470.8816,-596.0001 494,-630 513.228,-658.2784 503.9341,-675.8651 530,-698 534.5276,-701.8448 539.7876,-704.9937 545.2971,-707.5709"/>
<polygon fill="#000000" stroke="#000000" points="544.1371,-710.8773 554.7195,-711.3904 546.7668,-704.39 544.1371,-710.8773"/>
</g>
<!-- proc~unitvectors_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node10" class="node">
<title>proc~unitvectors_p</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node10"><a xlink:href=".././proc/unitvectors_p.html" xlink:title="unitVectors_p">
<polygon fill="#d9534f" stroke="#d9534f" points="631,-605 554,-605 554,-581 631,-581 631,-605"/>
<text text-anchor="middle" x="592.5" y="-590.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">unitVectors_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~unitvectors_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge9" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~unitvectors_p</title>
<path fill="none" stroke="#000000" d="M443.0378,-542.0282C467.3395,-550.4697 500.636,-561.9918 530,-572 535.4834,-573.8689 541.2414,-575.8196 546.9511,-577.7468"/>
<polygon fill="#000000" stroke="#000000" points="545.8635,-581.0736 556.4576,-580.9491 548.0982,-574.4398 545.8635,-581.0736"/>
</g>
<!-- proc~ca_sd -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node11" class="node">
<title>proc~ca_sd</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node11"><a xlink:href=".././proc/ca_sd.html" xlink:title="CA_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="619.5,-521 565.5,-521 565.5,-497 619.5,-497 619.5,-521"/>
<text text-anchor="middle" x="592.5" y="-506.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CA_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~ca_sd -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge10" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~ca_sd</title>
<path fill="none" stroke="#000000" d="M494.036,-520.2377C515.3308,-517.8074 537.0897,-515.324 554.719,-513.312"/>
<polygon fill="#000000" stroke="#000000" points="555.5824,-516.7362 565.121,-512.1248 554.7886,-509.7814 555.5824,-516.7362"/>
</g>
<!-- proc~dca_sd -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node12" class="node">
<title>proc~dca_sd</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node12"><a xlink:href=".././proc/dca_sd.html" xlink:title="dCA_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="619.5,-479 565.5,-479 565.5,-455 619.5,-455 619.5,-479"/>
<text text-anchor="middle" x="592.5" y="-464.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dCA_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~dca_sd -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge11" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~dca_sd</title>
<path fill="none" stroke="#000000" d="M467.1613,-517.9687C476.2854,-515.4205 485.4985,-512.4397 494,-509 511.1711,-502.0527 513.1331,-495.6563 530,-488 538.091,-484.3273 547.0218,-480.9511 555.5391,-478.0292"/>
<polygon fill="#000000" stroke="#000000" points="556.8731,-481.2747 565.2727,-474.8173 554.6796,-474.6272 556.8731,-481.2747"/>
</g>
<!-- proc~interp_focollision_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node13" class="node">
<title>proc~interp_focollision_p</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node13"><a xlink:href=".././proc/interp_focollision_p.html" xlink:title="interp_FOcollision_p">
<polygon fill="#d9534f" stroke="#d9534f" points="646.5,-140 538.5,-140 538.5,-116 646.5,-116 646.5,-140"/>
<text text-anchor="middle" x="592.5" y="-125.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_FOcollision_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~interp_focollision_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge12" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~interp_focollision_p</title>
<path fill="none" stroke="#000000" d="M483.1736,-517.9903C487.1569,-515.4831 490.8203,-512.513 494,-509 532.1089,-466.8972 513.338,-310.2892 530,-256 542.1705,-216.3452 565.224,-173.7042 579.6742,-149.0141"/>
<polygon fill="#000000" stroke="#000000" points="582.8249,-150.5637 584.9284,-140.1797 576.8085,-146.9855 582.8249,-150.5637"/>
</g>
<!-- proc~get_random -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node14" class="node">
<title>proc~get_random</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node14"><a xlink:href=".././proc/get_random.html" xlink:title="get_random">
<polygon fill="#d94e8f" stroke="#d94e8f" points="627,-689 558,-689 558,-665 627,-665 627,-689"/>
<text text-anchor="middle" x="592.5" y="-674.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_random</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~get_random -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge13" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~get_random</title>
<path fill="none" stroke="#000000" d="M417.0981,-542.2738C435.1815,-567.2194 479.6588,-624.167 530,-656 535.5237,-659.4929 541.6923,-662.4723 547.9434,-664.9936"/>
<polygon fill="#000000" stroke="#000000" points="547.1598,-668.4339 557.7535,-668.5863 549.5671,-661.8608 547.1598,-668.4339"/>
</g>
<!-- proc~cf_sd -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node15" class="node">
<title>proc~cf_sd</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node15"><a xlink:href=".././proc/cf_sd.html" xlink:title="CF_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="619.5,-424 565.5,-424 565.5,-400 619.5,-400 619.5,-424"/>
<text text-anchor="middle" x="592.5" y="-409.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CF_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cf_sd -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge14" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cf_sd</title>
<path fill="none" stroke="#000000" d="M478.8199,-517.86C484.2187,-515.4198 489.363,-512.4977 494,-509 519.746,-489.5798 506.9592,-468.5637 530,-446 537.5456,-438.6106 547.0226,-432.3645 556.2992,-427.3223"/>
<polygon fill="#000000" stroke="#000000" points="558.0998,-430.3334 565.43,-422.6837 554.9293,-424.0926 558.0998,-430.3334"/>
</g>
<!-- proc~cb_ei_sd -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node16" class="node">
<title>proc~cb_ei_sd</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node16"><a xlink:href=".././proc/cb_ei_sd.html" xlink:title="CB_ei_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="623.5,-289 561.5,-289 561.5,-265 623.5,-265 623.5,-289"/>
<text text-anchor="middle" x="592.5" y="-274.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ei_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ei_sd -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge15" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ei_sd</title>
<path fill="none" stroke="#000000" d="M481.7636,-517.8487C486.1961,-515.3887 490.3361,-512.4668 494,-509 533.8277,-471.3148 508.7082,-441.528 530,-391 544.2645,-357.1485 565.6524,-320.2635 579.3412,-297.8837"/>
<polygon fill="#000000" stroke="#000000" points="582.4091,-299.5773 584.6932,-289.2316 576.456,-295.8948 582.4091,-299.5773"/>
</g>
<!-- proc~cb_ee_sd -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node17" class="node">
<title>proc~cb_ee_sd</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node17"><a xlink:href=".././proc/cb_ee_sd.html" xlink:title="CB_ee_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="625,-563 560,-563 560,-539 625,-539 625,-563"/>
<text text-anchor="middle" x="592.5" y="-548.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ee_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ee_sd -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge16" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ee_sd</title>
<path fill="none" stroke="#000000" d="M494.036,-539.7623C513.4656,-541.9798 533.2815,-544.2414 549.9946,-546.1488"/>
<polygon fill="#000000" stroke="#000000" points="549.6362,-549.6306 559.9686,-547.2872 550.43,-542.6757 549.6362,-549.6306"/>
</g>
<!-- proc~analytical_profiles_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node18" class="node">
<title>proc~analytical_profiles_p</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node18"><a xlink:href=".././proc/analytical_profiles_p.html" xlink:title="analytical_profiles_p">
<polygon fill="#d9534f" stroke="#d9534f" points="646.5,-647 538.5,-647 538.5,-623 646.5,-623 646.5,-647"/>
<text text-anchor="middle" x="592.5" y="-632.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">analytical_profiles_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~analytical_profiles_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge17" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~analytical_profiles_p</title>
<path fill="none" stroke="#000000" d="M422.9896,-542.0505C444.9481,-559.8249 488.5027,-593.2058 530,-614 533.7418,-615.875 537.6896,-617.6428 541.7083,-619.2957"/>
<polygon fill="#000000" stroke="#000000" points="540.5608,-622.6044 551.1503,-622.9405 543.0817,-616.0741 540.5608,-622.6044"/>
</g>
<!-- proc~psi -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node19" class="node">
<title>proc~psi</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node19"><a xlink:href=".././proc/psi.html" xlink:title="psi">
<polygon fill="#d94e8f" stroke="#d94e8f" points="796.5,-546 742.5,-546 742.5,-522 796.5,-522 796.5,-546"/>
<text text-anchor="middle" x="769.5" y="-531.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psi</text>
</a>
</g>
</g>
<!-- proc~ca_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge21" class="edge">
<title>proc~ca_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M619.7683,-512.8515C649.9995,-517.1214 698.9279,-524.0322 732.5766,-528.7848"/>
<polygon fill="#000000" stroke="#000000" points="732.0999,-532.2522 742.4911,-530.1852 733.0789,-525.321 732.0999,-532.2522"/>
</g>
<!-- proc~vte -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node20" class="node">
<title>proc~vte</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node20"><a xlink:href=".././proc/vte.html" xlink:title="VTe">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1028,-445 974,-445 974,-421 1028,-421 1028,-445"/>
<text text-anchor="middle" x="1001" y="-430.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VTe</text>
</a>
</g>
</g>
<!-- proc~ca_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge20" class="edge">
<title>proc~ca_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M619.6285,-516.28C630.8654,-519.7601 643.8509,-524.3987 655,-530 672.4064,-538.745 672.4106,-549.1784 691,-555 757.5888,-575.8535 782.1373,-578.0444 848,-555 906.0803,-534.6786 958.5625,-482.0435 984.2952,-452.9911"/>
<polygon fill="#000000" stroke="#000000" points="987.2047,-454.9782 991.1133,-445.1307 981.9168,-450.3915 987.2047,-454.9782"/>
</g>
<!-- proc~gammacee -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node23" class="node">
<title>proc~gammacee</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node23"><a xlink:href=".././proc/gammacee.html" xlink:title="Gammacee">
<polygon fill="#d94e8f" stroke="#d94e8f" points="803,-466 736,-466 736,-442 803,-442 803,-466"/>
<text text-anchor="middle" x="769.5" y="-451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Gammacee</text>
</a>
</g>
</g>
<!-- proc~ca_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge19" class="edge">
<title>proc~ca_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M619.7683,-500.5268C648.0661,-491.7337 692.7461,-477.8501 725.9422,-467.5349"/>
<polygon fill="#000000" stroke="#000000" points="727.3339,-470.7676 735.8448,-464.4578 725.2566,-464.0829 727.3339,-470.7676"/>
</g>
<!-- proc~dca_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge24" class="edge">
<title>proc~dca_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M619.6742,-474.936C630.7991,-478.491 643.6899,-483.0085 655,-488 671.7451,-495.3902 674.239,-500.6459 691,-508 704.2002,-513.7917 719.1215,-519.0399 732.3832,-523.2799"/>
<polygon fill="#000000" stroke="#000000" points="731.5567,-526.6882 742.1451,-526.318 733.637,-520.0044 731.5567,-526.6882"/>
</g>
<!-- proc~dca_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge23" class="edge">
<title>proc~dca_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M619.6396,-469.7995C639.4024,-471.6927 666.8285,-474.02 691,-475 760.7205,-477.8266 778.8473,-484.3192 848,-475 888.4677,-469.5465 933.3725,-456.3253 964.0059,-446.1613"/>
<polygon fill="#000000" stroke="#000000" points="965.4658,-449.3625 973.8204,-442.8472 963.2262,-442.7304 965.4658,-449.3625"/>
</g>
<!-- proc~dca_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge22" class="edge">
<title>proc~dca_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M619.7683,-464.9972C647.9442,-462.9278 692.3613,-459.6656 725.5123,-457.2307"/>
<polygon fill="#000000" stroke="#000000" points="726.1281,-460.695 735.8448,-456.4718 725.6153,-453.7138 726.1281,-460.695"/>
</g>
<!-- proc~interp_focollision_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge27" class="edge">
<title>proc~interp_focollision_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M646.5676,-118.2251C669.8425,-114.0172 696.8818,-109.1287 719.6654,-105.0096"/>
<polygon fill="#000000" stroke="#000000" points="720.5875,-108.3998 729.8053,-103.1764 719.3421,-101.5114 720.5875,-108.3998"/>
</g>
<!-- proc~interp_focollision_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge25" class="edge">
<title>proc~interp_focollision_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M611.8459,-115.8408C631.2521,-104.0701 662.2979,-86.3814 691,-75 699.5714,-71.6011 708.883,-68.5689 717.998,-65.9377"/>
<polygon fill="#000000" stroke="#000000" points="719.0589,-69.2759 727.7674,-63.2416 717.1966,-62.5281 719.0589,-69.2759"/>
</g>
<!-- proc~check_if_in_profiles_domain_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node28" class="node">
<title>proc~check_if_in_profiles_domain_p</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node28"><a xlink:href=".././proc/check_if_in_profiles_domain_p.html" xlink:title="check_if_in_profiles_domain_p">
<polygon fill="#d9534f" stroke="#d9534f" points="848,-150 691,-150 691,-126 848,-126 848,-150"/>
<text text-anchor="middle" x="769.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_if_in_profiles_domain_p</text>
</a>
</g>
</g>
<!-- proc~interp_focollision_p&#45;&gt;proc~check_if_in_profiles_domain_p -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge26" class="edge">
<title>proc~interp_focollision_p&#45;&gt;proc~check_if_in_profiles_domain_p</title>
<path fill="none" stroke="#000000" d="M646.5676,-131.0547C657.3401,-131.6633 668.919,-132.3175 680.5091,-132.9723"/>
<polygon fill="#000000" stroke="#000000" points="680.4958,-136.477 690.6773,-133.5467 680.8907,-129.4881 680.4958,-136.477"/>
</g>
<!-- omp_get_thread_num -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node24" class="node">
<title>omp_get_thread_num</title>
<polygon fill="#777777" stroke="#777777" points="827,-702 712,-702 712,-678 827,-678 827,-702"/>
<text text-anchor="middle" x="769.5" y="-687.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">omp_get_thread_num</text>
</g>
<!-- proc~get_random&#45;&gt;omp_get_thread_num -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge28" class="edge">
<title>proc~get_random&#45;&gt;omp_get_thread_num</title>
<path fill="none" stroke="#000000" d="M627.0476,-679.5374C648.2746,-681.0964 676.1981,-683.1473 701.694,-685.0199"/>
<polygon fill="#000000" stroke="#000000" points="701.4681,-688.5126 711.6976,-685.7546 701.9809,-681.5314 701.4681,-688.5126"/>
</g>
<!-- interface~random_get_number -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node29" class="node">
<title>interface~random_get_number</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node29"><a xlink:href=".././interface/random_get_number.html" xlink:title="random_get_number">
<polygon fill="#a7506f" stroke="#a7506f" points="824.5,-744 714.5,-744 714.5,-720 824.5,-720 824.5,-744"/>
<text text-anchor="middle" x="769.5" y="-729.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">random_get_number</text>
</a>
</g>
</g>
<!-- proc~get_random&#45;&gt;interface~random_get_number -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge29" class="edge">
<title>proc~get_random&#45;&gt;interface~random_get_number</title>
<path fill="none" stroke="#000000" d="M627.2591,-688.5253C636.3044,-691.5666 646.0284,-694.8733 655,-698 671.0637,-703.5983 674.7686,-705.9084 691,-711 697.8483,-713.1482 705.0749,-715.272 712.259,-717.2961"/>
<polygon fill="#000000" stroke="#000000" points="711.4185,-720.695 721.9896,-719.9876 713.2846,-713.9483 711.4185,-720.695"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge30" class="edge">
<title>proc~cf_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M617.1342,-424.0939C628.8882,-430.1904 642.9764,-437.9813 655,-446 672.0931,-457.3996 674.7857,-462.3817 691,-475 708.9365,-488.9586 729.4799,-504.379 745.051,-515.9534"/>
<polygon fill="#000000" stroke="#000000" points="743.025,-518.8083 753.142,-521.9543 747.195,-513.1859 743.025,-518.8083"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge31" class="edge">
<title>proc~cf_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M619.8493,-404.5529C639.4795,-399.6062 666.6559,-393.5662 691,-391 760.3933,-383.6849 778.8473,-381.6808 848,-391 888.4677,-396.4535 933.3725,-409.6747 964.0059,-419.8387"/>
<polygon fill="#000000" stroke="#000000" points="963.2262,-423.2696 973.8204,-423.1528 965.4658,-416.6375 963.2262,-423.2696"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge33" class="edge">
<title>proc~cf_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M619.7683,-418.4705C648.0661,-425.1852 692.7461,-435.7872 725.9422,-443.6642"/>
<polygon fill="#000000" stroke="#000000" points="725.3069,-447.1106 735.8448,-446.014 726.9231,-440.2997 725.3069,-447.1106"/>
</g>
<!-- proc~clogee -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node25" class="node">
<title>proc~clogee</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node25"><a xlink:href=".././proc/clogee.html" xlink:title="CLogee">
<polygon fill="#d94e8f" stroke="#d94e8f" points="938,-344 884,-344 884,-320 938,-320 938,-344"/>
<text text-anchor="middle" x="911" y="-329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLogee</text>
</a>
</g>
</g>
<!-- proc~cf_sd&#45;&gt;proc~clogee -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge32" class="edge">
<title>proc~cf_sd&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M609.7176,-399.8653C628.6803,-387.1646 660.5371,-367.7432 691,-358 753.0615,-338.1503 829.332,-333.1861 873.824,-332.0988"/>
<polygon fill="#000000" stroke="#000000" points="873.957,-335.597 883.8882,-331.9064 873.8231,-328.5983 873.957,-335.597"/>
</g>
<!-- proc~h_j -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node26" class="node">
<title>proc~h_j</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node26"><a xlink:href=".././proc/h_j.html" xlink:title="h_j">
<polygon fill="#d94e8f" stroke="#d94e8f" points="796.5,-424 742.5,-424 742.5,-400 796.5,-400 796.5,-424"/>
<text text-anchor="middle" x="769.5" y="-409.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h_j</text>
</a>
</g>
</g>
<!-- proc~cf_sd&#45;&gt;proc~h_j -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge34" class="edge">
<title>proc~cf_sd&#45;&gt;proc~h_j</title>
<path fill="none" stroke="#000000" d="M619.7683,-412C649.8692,-412 698.5065,-412 732.1406,-412"/>
<polygon fill="#000000" stroke="#000000" points="732.4912,-415.5001 742.4911,-412 732.4911,-408.5001 732.4912,-415.5001"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge35" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M623.6669,-270.0567C689.4397,-257.3356 844.0834,-237.8583 938,-311 970.5424,-336.3438 987.875,-383.1628 995.6917,-410.8485"/>
<polygon fill="#000000" stroke="#000000" points="992.3744,-411.9946 998.3148,-420.7674 999.1417,-410.2048 992.3744,-411.9946"/>
</g>
<!-- proc~clogei -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node21" class="node">
<title>proc~clogei</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node21"><a xlink:href=".././proc/clogei.html" xlink:title="CLogei">
<polygon fill="#d94e8f" stroke="#d94e8f" points="938,-231 884,-231 884,-207 938,-207 938,-231"/>
<text text-anchor="middle" x="911" y="-216.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLogei</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~clogei -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge36" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~clogei</title>
<path fill="none" stroke="#000000" d="M623.0834,-264.9006C642.2967,-257.7663 667.7585,-249.1536 691,-244 754.2729,-229.9697 829.6267,-223.5763 873.7048,-220.8462"/>
<polygon fill="#000000" stroke="#000000" points="874.1687,-224.325 883.9457,-220.2433 873.7573,-217.3371 874.1687,-224.325"/>
</g>
<!-- proc~g_j -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node22" class="node">
<title>proc~g_j</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node22"><a xlink:href=".././proc/g_j.html" xlink:title="g_j">
<polygon fill="#d94e8f" stroke="#d94e8f" points="796.5,-192 742.5,-192 742.5,-168 796.5,-168 796.5,-192"/>
<text text-anchor="middle" x="769.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">g_j</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~g_j -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge37" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~g_j</title>
<path fill="none" stroke="#000000" d="M606.2896,-264.9481C624.569,-249.4881 658.3343,-222.6835 691,-206 703.9393,-199.3914 718.9163,-193.9446 732.2977,-189.7738"/>
<polygon fill="#000000" stroke="#000000" points="733.5754,-193.0452 742.1593,-186.8349 731.5762,-186.3367 733.5754,-193.0452"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge38" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M598.7606,-289.3139C615.9141,-322.6108 664.1719,-413.2538 691,-433 701.1192,-440.448 713.6987,-445.2554 725.8018,-448.3581"/>
<polygon fill="#000000" stroke="#000000" points="725.2701,-451.8254 735.7919,-450.5839 726.7924,-444.9929 725.2701,-451.8254"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~clogee -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge39" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M623.6083,-282.0143C671.7537,-289.8247 767.1983,-305.507 848,-320 856.3367,-321.4953 865.2817,-323.1616 873.7374,-324.7651"/>
<polygon fill="#000000" stroke="#000000" points="873.2559,-328.2363 883.7349,-326.6742 874.5689,-321.3606 873.2559,-328.2363"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge43" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M625.3775,-547.8423C655.6472,-544.935 700.5163,-540.6256 732.1327,-537.589"/>
<polygon fill="#000000" stroke="#000000" points="732.6869,-541.0519 742.3064,-536.6118 732.0176,-534.084 732.6869,-541.0519"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge42" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M625.3588,-561.9506C644.3092,-567.6882 668.725,-574.1097 691,-577 760.1977,-585.9789 780.0888,-593.0316 848,-577 891.525,-566.7251 904.7901,-561.9516 938,-532 962.5331,-509.8739 981.2646,-476.0545 991.7004,-454.2344"/>
<polygon fill="#000000" stroke="#000000" points="994.8859,-455.6845 995.9025,-445.1385 988.5313,-452.7487 994.8859,-455.6845"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge40" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M625.2617,-541.7799C635.0415,-538.5553 645.6435,-534.5783 655,-530 688.2981,-513.7066 723.3549,-489.1952 745.7696,-472.4434"/>
<polygon fill="#000000" stroke="#000000" points="748.1317,-475.0451 753.9939,-466.2198 743.9077,-469.4632 748.1317,-475.0451"/>
</g>
<!-- proc~delta -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node27" class="node">
<title>proc~delta</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node27"><a xlink:href=".././proc/delta.html" xlink:title="delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="938,-664 884,-664 884,-640 938,-640 938,-664"/>
<text text-anchor="middle" x="911" y="-649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">delta</text>
</a>
</g>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~delta -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge41" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~delta</title>
<path fill="none" stroke="#000000" d="M625,-557.5265C635.3047,-560.696 646.275,-565.3193 655,-572 677.9018,-589.5358 666.4127,-610.9181 691,-626 747.4195,-660.6078 827.4045,-660.4355 873.7747,-656.6049"/>
<polygon fill="#000000" stroke="#000000" points="874.3383,-660.0677 883.9717,-655.6578 873.6909,-653.0977 874.3383,-660.0677"/>
</g>
<!-- proc~clogei&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge45" class="edge">
<title>proc~clogei&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M926.106,-231.1095C930.4136,-235.1586 934.8006,-239.9397 938,-245 972.1758,-299.0532 989.9274,-373.6633 997.0944,-410.5265"/>
<polygon fill="#000000" stroke="#000000" points="993.7152,-411.4992 998.9852,-420.6904 1000.5971,-410.2189 993.7152,-411.4992"/>
</g>
<!-- proc~clog0 -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_node30" class="node">
<title>proc~clog0</title>
<g id="a_proc~~adv_fointerp_mars_top~~CallsGraph_node30"><a xlink:href=".././proc/clog0.html" xlink:title="CLog0">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1028,-286 974,-286 974,-262 1028,-262 1028,-286"/>
<text text-anchor="middle" x="1001" y="-271.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLog0</text>
</a>
</g>
</g>
<!-- proc~clogei&#45;&gt;proc~clog0 -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge44" class="edge">
<title>proc~clogei&#45;&gt;proc~clog0</title>
<path fill="none" stroke="#000000" d="M930.9739,-231.2063C943.092,-238.6118 958.7603,-248.1868 972.2024,-256.4015"/>
<polygon fill="#000000" stroke="#000000" points="970.724,-259.5998 981.0819,-261.8278 974.3742,-253.6268 970.724,-259.5998"/>
</g>
<!-- proc~gammacee&#45;&gt;proc~clogee -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge46" class="edge">
<title>proc~gammacee&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M803.2323,-450.6167C818.093,-447.7799 835.0736,-442.5689 848,-433 875.3681,-412.7404 893.6043,-376.7212 903.1265,-353.6211"/>
<polygon fill="#000000" stroke="#000000" points="906.4992,-354.6072 906.8899,-344.0196 899.9819,-352.0527 906.4992,-354.6072"/>
</g>
<!-- proc~clogee&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge48" class="edge">
<title>proc~clogee&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M924.1837,-344.1615C928.669,-348.4378 933.6461,-353.3401 938,-358 954.8482,-376.0324 972.8404,-397.7226 985.265,-413.1283"/>
<polygon fill="#000000" stroke="#000000" points="982.5687,-415.3606 991.5522,-420.9774 988.0321,-410.9844 982.5687,-415.3606"/>
</g>
<!-- proc~clogee&#45;&gt;proc~clog0 -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge47" class="edge">
<title>proc~clogee&#45;&gt;proc~clog0</title>
<path fill="none" stroke="#000000" d="M929.6481,-319.9824C942.4395,-311.739 959.617,-300.6691 973.9124,-291.4565"/>
<polygon fill="#000000" stroke="#000000" points="975.8661,-294.3613 982.3758,-286.0022 972.0741,-288.4773 975.8661,-294.3613"/>
</g>
<!-- proc~delta&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_mars_top~~CallsGraph_edge49" class="edge">
<title>proc~delta&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M926.1304,-639.9059C930.439,-635.8574 934.8204,-631.0728 938,-626 973.0975,-570.0052 990.5778,-492.506 997.4201,-455.0371"/>
<polygon fill="#000000" stroke="#000000" points="1000.8706,-455.6234 999.1421,-445.1705 993.9748,-454.4198 1000.8706,-455.6234"/>
</g>
</g>
</svg>
</div><script>var panprocadv_fointerp_mars_topCallsGraph = svgPanZoom('#procadv_fointerp_mars_topCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~adv_fointerp_mars_top~~CalledByGraph Pages: 1 -->
<svg id="procadv_fointerp_mars_topCalledByGraph" width="224pt" height="32pt"
 viewBox="0.00 0.00 224.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~adv_fointerp_mars_top~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~adv_fointerp_mars_top~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 220,-28 220,4 -4,4"/>
<!-- proc~adv_fointerp_mars_top -->
<g id="proc~~adv_fointerp_mars_top~~CalledByGraph_node1" class="node">
<title>proc~adv_fointerp_mars_top</title>
<polygon fill="none" stroke="#000000" points="216,-24 90,-24 90,0 216,0 216,-24"/>
<text text-anchor="middle" x="153" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">adv_FOinterp_mars_top</text>
</g>
<!-- program~main -->
<g id="proc~~adv_fointerp_mars_top~~CalledByGraph_node2" class="node">
<title>program~main</title>
<g id="a_proc~~adv_fointerp_mars_top~~CalledByGraph_node2"><a xlink:href=".././program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~adv_fointerp_mars_top -->
<g id="proc~~adv_fointerp_mars_top~~CalledByGraph_edge1" class="edge">
<title>program~main&#45;&gt;proc~adv_fointerp_mars_top</title>
<path fill="none" stroke="#000000" d="M54.0302,-12C61.7007,-12 70.4411,-12 79.4788,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.7679,-15.5001 89.7678,-12 79.7678,-8.5001 79.7679,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/adv_fointerp_mars_top.html#src">adv_FOinterp_mars_top</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">adv_FOinterp_mars_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>  
    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">params</span>
    <span class="c">!! Core KORC simulation parameters.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">FIELDS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                                   <span class="kd">::</span> <span class="n">F</span>
    <span class="c">!! An instance of the KORC derived type FIELDS.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">PROFILES</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                                 <span class="kd">::</span> <span class="n">P</span>
    <span class="c">!! An instance of the KORC derived type PROFILES.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">SPECIES</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">spp</span>
    <span class="c">!! An instance of the derived type SPECIES containing all the parameters</span>
    <span class="c">!! and simulation variables of the different species in the simulation.</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Bmag</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">b_unit_X</span><span class="p">,</span><span class="n">b_unit_Y</span><span class="p">,</span><span class="n">b_unit_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v</span><span class="p">,</span><span class="n">vpar</span><span class="p">,</span><span class="n">vperp</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmp</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cross_X</span><span class="p">,</span><span class="n">cross_Y</span><span class="p">,</span><span class="n">cross_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec_X</span><span class="p">,</span><span class="n">vec_Y</span><span class="p">,</span><span class="n">vec_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PSIp</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">q_cache</span>    
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">ii</span>
    <span class="c">!! Species iterator.</span>
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">pp</span><span class="p">,</span><span class="n">pchunk</span>
    <span class="c">!! Particles iterator.</span>
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">cc</span>
    <span class="c">!! Chunk iterator.</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>                                                    <span class="kd">::</span> <span class="n">tt</span>
    <span class="c">!! time iterator.     </span>

    <span class="k">do </span><span class="n">ii</span> <span class="o">=</span> <span class="mi">1_idef</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">num_species</span>      

       <span class="n">pchunk</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span>
       <span class="n">m_cache</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">m</span>
       <span class="n">q_cache</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">q</span>
       <span class="n">a</span> <span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span>


       <span class="c">!$OMP PARALLEL DO default(none) &amp;</span>
       <span class="c">!$OMP&amp; FIRSTPRIVATE(a,m_cache,q_cache,pchunk,E0) &amp;</span>
       <span class="c">!$OMP&amp; shared(params,ii,spp,P,F) &amp;</span>
       <span class="c">!$OMP&amp; PRIVATE(pp,tt,Bmag,cc,X_X,X_Y,X_Z,V_X,V_Y,V_Z,B_X,B_Y,B_Z, &amp;</span>
       <span class="c">!$OMP&amp; E_X,E_Y,E_Z,b_unit_X,b_unit_Y,b_unit_Z,v,vpar,vperp,tmp, &amp;</span>
       <span class="c">!$OMP&amp; cross_X,cross_Y,cross_Z,vec_X,vec_Y,vec_Z,g, &amp;</span>
       <span class="c">!$OMP&amp; Y_R,Y_PHI,Y_Z,flagCon,flagCol,PSIp)</span>
       <span class="k">do </span><span class="n">pp</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">ppp</span><span class="p">,</span><span class="n">pchunk</span>

          <span class="c">!$OMP SIMD</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
             <span class="n">X_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">X_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">X_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">Y_R</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mf">0._rp</span>
             <span class="n">Y_PHI</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mf">0._rp</span>
             <span class="n">Y_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="mf">0._rp</span>
             
             <span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
             
             <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">PSIp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">PSI_P</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCon</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">end do</span>
          <span class="c">!$OMP END SIMD</span>


          <span class="k">do </span><span class="n">tt</span><span class="o">=</span><span class="mi">1_ip</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>

             <span class="k">call </span><span class="n">cart_to_cyl_p</span><span class="p">(</span><span class="n">pchunk</span><span class="p">,</span><span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">)</span>

             <span class="k">call </span><span class="n">interp_FOfields_mars_p</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">pchunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span><span class="n">PSIp</span><span class="p">,</span><span class="n">flagCon</span><span class="p">)</span>



             <span class="c">!               write(output_unit_write,&#39;(&quot;B_X: &quot;,E17.10)&#39;) B_X(1)</span>
             <span class="c">!               write(output_unit_write,&#39;(&quot;B_Y: &quot;,E17.10)&#39;) B_Y(1)</span>
             <span class="c">!               write(output_unit_write,&#39;(&quot;B_Z: &quot;,E17.10)&#39;) B_Z(1)</span>

             <span class="k">call </span><span class="n">advance_FOinterp_vars</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">q_cache</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">params</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span><span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">g</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>
          <span class="k">end do</span> <span class="c">!timestep iterator</span>

          <span class="c">!$OMP SIMD</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">X_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">X_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">X_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCon</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">PSI_P</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">PSIp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">end do</span>
          <span class="c">!$OMP END SIMD</span>


          <span class="c">!$OMP SIMD</span>
          <span class="c">!          !$OMP&amp; aligned(Bmag,B_X,B_Y,B_Z, &amp;</span>
          <span class="c">!          !$OMP&amp; b_unit_X,b_unit_Y,b_unit_Z,v,V_X,V_Y,V_Z,vpar, &amp;</span>
          <span class="c">!          !$OMP&amp; vperp,tmp,cross_X,cross_Y,cross_Z, &amp;</span>
          <span class="c">!          !$OMP&amp; vec_X,vec_Y,vec_Z,E_X,E_Y,E_Z)</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
             <span class="c">!Derived output data</span>
             <span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

             <span class="c">! Parallel unit vector</span>
             <span class="n">b_unit_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">b_unit_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">b_unit_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
             <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">korc_zero</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">! Parallel and perpendicular components of velocity</span>
                <span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

                <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span>  <span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">korc_zero</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span> <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">else</span>
<span class="k">                   </span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="k">end if</span>

                <span class="c">! Pitch angle</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">eta</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mi">18</span><span class="mf">0.0_rp</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="nb">MODULO</span><span class="p">(</span><span class="n">ATAN2</span><span class="p">(</span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)),</span><span class="mf">2.0_rp</span><span class="o">*</span><span class="n">C_PI</span><span class="p">)</span><span class="o">/</span><span class="n">C_PI</span>

                <span class="c">! Magnetic moment</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">mu</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="n">m_cache</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="c">! See Northrop&#39;s book (The adiabatic motion of charged</span>
                <span class="c">! particles)</span>


                
                <span class="c">! Radiated power</span>
                <span class="n">tmp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mf">6.0_rp</span><span class="o">*</span><span class="n">C_PI</span><span class="o">*</span><span class="n">E0</span><span class="o">*</span><span class="n">m_cache</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Prad</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">(</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">((</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
                     <span class="o">-</span> <span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span> <span class="p">)</span>

                <span class="c">! Input power due to electric field</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Pin</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">*</span><span class="p">(</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
             <span class="k">else</span>
<span class="k">                </span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">eta</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">mu</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Prad</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Pin</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
             <span class="k">end if</span>

<span class="k">          end do</span>
          <span class="c">!$OMP END SIMD</span>


       <span class="k">end do</span> <span class="c">!particle chunk iterator</span>
       <span class="c">!$OMP END PARALLEL DO</span>

    <span class="k">end do</span> <span class="c">!species iterator</span>

  <span class="k">end subroutine </span><span class="n">adv_FOinterp_mars_top</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2022 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> KORC was developed by Matt Beidler</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>